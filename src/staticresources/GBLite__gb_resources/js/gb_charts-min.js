var GBCharts=function(ac,i,o){var I,C,v,t=["#FFC72A","#0684FF","#2B905E","#EA4134","#95e4ff","#ffec4a","#ABEC51","#F28020","#00B4FF","#F45B5B","#50E3C2","#D85584","#6B72F4","#f7aec8"],D,l,F,e="donut",k="tile",N="-",g="RECORD_COUNT",R,ae,W,X,Y,n=[],E,G=[],T=false,ai,af=[];var al={xs:{width:214,height:170,fullName:"Extra Small"},s:{width:320,height:256,fullName:"Small"},m:{width:480,height:384,fullName:"Medium"},l:{width:640,height:512,fullName:"Large"}};function ah(at){I=at;if(I.def.length==0){return}GBMixpanelForChart.init(I);l=(I.formatting.LOCALE_DIGIT_SEPARATOR||",");D=(I.formatting.LOCALE_DECIMAL_SEPARATOR||".");F=(I.formatting.DEFAULT_DECIMAL_SEPARATOR||".");o.datepicker.setDefaults(o.datepicker.regional[I.formatting.currentLocale]);R=A(I.def);W=al[R].width;X=al[R].height;ae=p(I.def);ai=z();if(I.standalone==true){var aA,ao=I.chartName;for(var aw=0;aw<I.def.length;aw++){if(I.def[aw].title==ao){aA=I.def[aw];break}}if(!aA||aA==undefined){aA=I.def[0]}af.push(aA);Y=(I.size&&I.size!="")?I.size:aA.size;var ax=al[Y].width,au=al[Y].height;v=o("div#chart-"+I.gridNameForAttributes);var ap='<a title="Click the chart to go to the Grid page" class="standaloneAnchor" href="'+I.gridURL+'" target="_blank"></a>';v.empty().append('<div class="chartHeader" title="Click to expand and collapse this chart">'+r(aA.title)+'<span class="chartExpandOrCollapse">&#8211;</span></div><div class="chartWithAxis"><canvas class="chartCanvas" width="'+ax+'" height="'+au+'"></canvas></div><div class="nodataMessage">No chart data to display due to grid filters or chart configuration.</div>').find(".chartCanvas, .nodataMessage").wrap(ap);v.addClass("size-"+Y);if(aA.type==e||aA.group_by){v.css("width",ax+260+30)}if(aA.type==k){v.find(".chartHeader").addClass("tileHeader")}d();ab(v);GBMixpanelForChart.track("Embedded Chart View",{Type:aA.type,Size:aA.size,Color:aA.color,"X-field":aA.x_wedge,"Y-field":aA.y_value,"Summary Type":aA.summary_type})}else{var av=o(".gridBtns.top"),ar=GBHelpers.isGridInIframe(),ay=w(),aq=o("#AppBodyHeader").length===1,az=o(".chartIcon"),aC,aB=Z(I.def);av.append(ay);aC=av.find(".chartOverlay");v=o("#gridChart");v.empty().append('<div class="chartHeader">Charts</div><div class="chartBody">'+aB+"</div>");o(ac).on("scroll",function(){if((aq&&!ar)||o(".msgBox.infoMsg, #pageWarnings").is(":visible")){var aD=(az.offset().top+az.outerHeight()-o(ac).scrollTop());GBHelpers.debounce(function(){aC.css("top",aD)})()}});o(".chartBody").css("margin-top",25);o(".chartBody").css("overflow","auto");Q(v);v.addClass("size-"+R);o(ac).resize(function(){ag(X)})}}function w(ao){return'<div class="chartOverlay"><div id="gridChart" class="chartContainer chartHidden none"/></div>'}function Z(ao){var au="";for(var ar=0;ar<ao.length;ar++){var aq=ao[ar].size,at=al[aq].width,ap=al[aq].height;au+='<div class="singleChartHeader"><h1>'+r(ao[ar].title)+'</h1></div><div class="chartBody-'+ao[ar].id+" size-"+aq+'" ><div class="chartWithAxis" id="chart-'+ao[ar].id+'"><canvas class="chartCanvas" width="'+at+'" height="'+ap+'"></canvas></div><div class="nodataMessage">No chart data to display due to grid filters or chart configuration.</div></div>'}return au}function A(ao){var ar="xs",aq=al[ar].width;for(var ap=0;ap<ao.length;ap++){if(al[ao[ap].size].width>aq){ar=ao[ap].size;aq=al[ar].width;if(ar=="l"){return ar}}}return ar}function p(ao){var ar="xs",aq=al[ar].width;for(var ap=0;ap<ao.length;ap++){if(u(ao[ap],ao[ap].type)||ao[ap].type=="donut"){if(al[ao[ap].size].width>aq){ar=ao[ap].size;aq=al[ar].width}}}return ar}function ag(ap){var aq=x(),ao=(ap+140<aq)?ap+140:aq;o(".chartBody").css("max-height",ao)}function x(){var au=o("#AppBodyHeader"),aB=au.length===1?au.outerHeight(true):0,az=o("#globalHeaderBar"),aC=az.length===1?az.outerHeight(true):0,ax=o(".gridBtns.top").outerHeight(true),av=GBHelpers.getInfoMsgHeight(),at=GBHelpers.isGridInIframe(),ar=GBHelpers.getPageWarningsHeight(),ap=o("#gridFooter"),aq=ap.length===1?ap.outerHeight(true):0,aA=o(".chartHeader"),aw=aA.length===1?aA.height():0,ao=o(ac).height(),ay=(aB+aC+av+ar+ax+aw+aq);return ao-ay}function m(){M("Loading...");v.removeClass("none")}function ab(ao){var ap=ao.find(".chartHeader");ap.click(function(){if(ao.find(".chartMessage").length>0){return}if(ao.find(".nodataMessage").is(":visible")==true||ao.find("div.msgDetail").length>0){return}var ar=ao.find(".chartCanvas"),aq=ao.find(".chart-legend-container, .xAxisLabel, .yAxisLabel");if(ao.hasClass("chartHidden")){if(ar.length>0){ar.slideDown(200,function(){aq.fadeIn()})}else{ao.find(".chartTile").slideDown()}if(G.length>0){am(G)}ao.removeClass("chartHidden");ap.find(".chartExpandOrCollapse").html("&#8211;")}else{ap.width(ap.width());if(ar.length>0){ar.slideUp()}else{ao.find(".chartTile").slideUp()}ao.addClass("chartHidden");ap.find(".chartExpandOrCollapse").text("+");aq.hide();G=[]}})}function Q(ao){o(".chartIcon").click(function(){var aq=o(this),au=ao.find(".chartCanvas"),ap=o(".chart-legend-container"),aw=ao.find(".chartCanvas, .tileChart, .xAxisLabel, .yAxisLabel, .singleChartHeader"),at=W+65;if(ao.hasClass("chartHidden")){GBMixpanelForChart.track("Change Grid Display",{"Display Control":"Chart",Option:"",State:"Expand",Type:ai.chartsTypes,Size:ai.chartsSizes,Color:ai.chartsColors,"X-field":ai.chartsXAxis,"Y-field":ai.chartsYAxis,"Summary Type":ai.chartsSummary});if(!o(".gridBtns").hasClass("fixed")){var ar=(aq.offset().top+aq.outerHeight()-o(ac).scrollTop()),av=o(".gridBtns .chartOverlay");av.css("top",ar+"px")}aq.addClass("on");if((ao.find("div.msgDetail").length>0)||(ao.find(".chartMessage").length>0)){ao.animate({width:at+"px"},300).removeClass("chartHidden");return}if(!o(".metadataPanel").hasClass("metadataPanelHidden")){o(".metadataPanelIcon").click()}ag(X);if(ap.length>0){s();return}ao.animate({width:at+"px"},300,function(){aw.fadeIn().css("display","block");o(this).removeClass("chartHidden");if(G.length>0){am(G)}})}else{GBMixpanelForChart.track("Change Grid Display",{"Display Control":"Chart",Option:"",State:"Collapse"});if(ap.length>0){ap.fadeOut()}if(aw.length>0){aw.fadeOut(function(){ao.animate({width:0},300).addClass("chartHidden")})}else{ao.animate({width:0},300).addClass("chartHidden")}aq.removeClass("on");G=[]}})}function s(){var ao=al[ae].width,ap=W>ao+260?W:ao+260;v.animate({width:ap+65+"px"},300,function(){o(this).removeClass("chartHidden").find(".chartCanvas, .xAxisLabel, .yAxisLabel, .chart-legend-container, .singleChartHeader, .tileChart").fadeIn();o(this).find(".xAxisLabel, .yAxisLabel").css("display","block");if(T&&G.length>0){am(G)}})}function an(ao){C=ao;if(ao){if(ao.status&&ao.status=="error"){P(ao.messages)}else{if(ao.formatting&&ao.formatting.isMultiCurrencyOrg){I.formatting.isMultiCurrencyOrg=ao.formatting.isMultiCurrencyOrg}if(ao.meta){ao.meta.forEach(function(ap){var ar;if(ap.fields){for(var aq=0;aq<ap.fields.length;aq++){ar=ap.fields[aq];ar.isTypeDate=function(){return this.dataType=="DATE"};ar.isTypeDateTime=function(){return this.dataType=="DATETIME"};ar.isNumeric=function(){return this.dataType=="CURRENCY"||this.dataType=="PERCENT"||this.dataType=="DOUBLE"||this.dataType=="INTEGER"};ar.isTypeCurrency=function(){return this.dataType=="CURRENCY"};ar.gridId=ap.gridId}}});I.meta=ao.meta}b();ak(ao)}}else{}b()}function P(ap){if(ap&&ap.length>0){var ao=o("div#chartMsg-"+I.gridNameForAttributes);ao.find("div.msgDetail").html(ap.join("<br/>"));if(v.find(".chartHeader").length>0){v.find(".chartHeader").after(ao.removeClass("none"))}else{v.append(ao.removeClass("none"))}v.find(".chartCanvas").hide();v.find(".chartHeader .chartExpandOrCollapse").hide();if(!I.standalone){ao.width(ao.width(W+30))}}}function B(ap){var ar,ao,aq;if(ap.attributes){ar=ap.attributes["type"];ao=I.formatting.object_Name_to_Name_Field[ar]}else{ao="Name"}if(ao!==undefined&&ao.length>0){aq=ao}else{aq="Name"}return aq}function j(ap,ar){var aq,ao;if(ar.dataType=="REFERENCE"){ao=ap[ar.fieldRelName];if(ao!=null){aq=ao[B(ao)]}else{aq=null}}else{aq=ap[ar.name]}return aq}function u(ao,ap){return ao.group_by!==undefined&&ap!==e&&ao.group_by!=0}function ak(aU){var aY=[],a2;if(I.standalone==true){a2=af}else{a2=I.def}for(var br=0;br<a2.length;br++){var ao=a2[br],aK={},aR={},ay=[],ar=[],az=[],a4=undefined,aF=undefined,a1=undefined,bs=undefined,aq=undefined,aZ=undefined,aQ=undefined,bd=undefined,bp=undefined,aH=undefined,aL=undefined,a8=undefined,aB=undefined,aJ=undefined,aw=undefined,aA=undefined,aD=undefined,ax=undefined,av=true,a0=false,aN=undefined,bt=undefined,aI=undefined,a6=undefined,aM=undefined,aC=undefined,ap=Object.keys(aU),aP=undefined,bq=0,at=undefined,aE=0,aG=0,bf=0,aT=0,aO=undefined,aV=undefined,a3=[],bk=["-","true","false"],aS=undefined;E=(I.type&&I.type!="")?I.type:ao.type;if(ao.x_wedge){a4=ao.x_wedge.split(":");aF=a4[0];a1=a4[1];if(a4[2]){bs=a4[0]+":"+a4[2]}else{bs=a4[0]}}if(ao.y_value){aq=ao.y_value.split(":");aZ=aq[0];aQ=aq[1];a0=(aQ==g);if(aq[2]){bd=aq[0]+":"+aq[2]}else{bd=aq[0]}}if(u(ao,E)){bp=ao.group_by.split(":");aH=bp[0];aL=bp[1];if(bp[2]){a8=bp[0]+":"+bp[2]}else{a8=bp[0]}}if(aF==aZ&&(aF==aH||aH==undefined)){av=false}for(var bo=0;ap.length>bo;bo++){if(a(ap[bo])==aF){aI=ap[bo]}if(a(ap[bo])==aZ){a6=ap[bo]}if(a(ap[bo])==aH){aM=ap[bo]}}for(var bb=0;I.meta.length>bb;bb++){if(I.meta[bb].fullyQualifiedObjectName==bs){for(var ba=0;I.meta[bb].fields.length>ba;ba++){if(I.meta[bb].fields[ba].name==a1){aA=I.meta[bb].fields[ba];aB=I.meta[bb].label+" - "+aA.label}}}if(I.meta[bb].fullyQualifiedObjectName==bd){for(var a7=0;I.meta[bb].fields.length>a7;a7++){if(I.meta[bb].fields[a7].name==aQ){aD=I.meta[bb].fields[a7];aJ=I.meta[bb].label+" - "+aD.label}else{if(aQ==g){aJ=I.meta[bb].label+" Record Count"}}}}if(a8&&I.meta[bb].fullyQualifiedObjectName==a8){for(var a9=0;I.meta[bb].fields.length>a9;a9++){if(I.meta[bb].fields[a9].name==aL){ax=I.meta[bb].fields[a9];aw=I.meta[bb].label+" - "+ax.label}}}}if(ao.type==k){if(ao.y_value.indexOf(g)!=-1){aS=aU[a6].length-c(aU,a6)}else{var bi=aa(aU,a6);if(bi!=undefined){var aX=bi.afValue?bi.afValue:0;if(!isNaN(aX)){aX=aX.toString();aS=H(aD,y(aX,aX.indexOf(K()),aD.scale))}else{aS="NaN"}}}aY.push({chartDrawingData:{chartDefinition:ao},chartData:aS});continue}if(aU[aI].length==0){aY.push({chartDrawingData:{chartDefinition:ao,error:"nodata"},chartData:[]});continue}for(var bn=0;aU[aI].length>bn;bn++){xItem=aU[aI][bn];if(xItem.afValue!=undefined){continue}aK[xItem.Id]={};aK[xItem.Id][a1]=j(xItem,aA);if(u(ao,E)&&aI==aM){aK[xItem.Id][aL]=j(xItem,ax)}if(!av){aK[xItem.Id][aQ]=xItem[aQ]}if(aD&&aD.isTypeCurrency()&&!aD.isoCurrencyCode){aD.CurrencyIsoCode=xItem.CurrencyIsoCode||I.formatting.defaultIsoCode}}if(av){var au=aq[2];for(var bm=0;aU[a6].length>bm;bm++){yItem=aU[a6][bm];if(!aK[yItem[au]][aZ]){aK[yItem[au]][aZ]={}}aK[yItem[au]][aZ][yItem.Id]={};aK[yItem[au]][aZ][yItem.Id][aQ]=yItem[aQ];if(u(ao,E)&&aI!=aM){aK[yItem[au]][aZ][yItem.Id][aL]=j(yItem,ax)}}}for(var bl in aK){aP=H(aA,aK[bl][a1]);bq=0,aG=0;if(av){if(aK[bl][aZ]){for(var bj in aK[bl][aZ]){if(a0){aE=1}else{if(!isNaN(aK[bl][aZ][bj][aQ])){aE=aK[bl][aZ][bj][aQ];aE=aE.toFixed(aD.scale)}else{aE=0}}aT=L(aE);if(aT>aG){aG=aT}bq=f(bq,aE,aG);if(u(ao,E)&&aI!=aM){at=H(ax,aK[bl][aZ][bj][aL]);if(aR[at]===undefined){aR[at]={};aR[at][aP]=aE}else{if(aR[at][aP]===undefined){aR[at][aP]=aE}else{aR[at][aP]=f(aR[at][aP],aE,aG)}}}}}}else{if(a0){bq=1}else{if(!isNaN(aK[bl][aQ])){aE=aK[bl][aQ]}else{aE=0}bq=aE.toFixed(aD.scale)}}aT=L(bq);if(aT>bf){bf=aT}if(u(ao,E)&&aI==aM){at=H(ax,aK[bl][aL]);if(aR[at]===undefined){aR[at]={};aR[at][aP]=bq}else{if(aR[at][aP]===undefined){aR[at][aP]=bq}else{aR[at][aP]=f(aR[at][aP],bq,bf)}}}else{if(u(ao,E)==false){if(aR[aP]===undefined){aR[aP]=bq}else{aR[aP]=f(aR[aP],bq,bf)}}}if(ay.indexOf(aP)==-1&&ay.length<=250){ay.push(aP)}}if(aR[""]||aR[""]==0){aR[N]=aR[""];delete aR[""]}if(u(ao,E)){for(var bc in aR){if(aR[bc][""]||aR[bc][""]==0){aR[bc][N]=aR[bc][""];delete aR[bc][""]}}}ay[ay.indexOf("")]=N;if(aA.isTypeDate()||aA.isTypeDateTime()){ay.sort(function(bu,bx){var bw=ad(bu,I.formatting.dateFormat);var bv=ad(bx,I.formatting.dateFormat);if(bw>bv||isNaN(bw.getTime())){return 1}else{return -1}})}else{if(aA.dataType=="PICKLIST"){if(typeof gridInfoMap!="undefined"){aO=gridInfoMap[aA.gridId].metaColumns;for(var ba=0;ba<aO.length;ba++){if(aO[ba].fieldName==aA.name){aV=aO[ba].getOrderedPicklistOptions()}}for(var a9=0;a9<aV.length;a9++){a3.push(aV[a9].v)}ay.sort(function(bu,bv){if(a3.indexOf(bu)>a3.indexOf(bv)){return 1}else{return -1}})}}else{if(aA.dataType=="BOOLEAN"){ay.sort(function(bu,bv){if(bk.indexOf(bu)>bk.indexOf(bv)){return 1}else{return -1}})}else{ay.sort(function(bu,bv){return(bu.toLowerCase()>bv.toLowerCase())?1:-1})}}}for(var bh=0;bh<ay.length;bh++){if(E==e){ar.push({label:ay[bh],color:t[bh%t.length],highlight:aj(t[bh%t.length],0.15),value:aR[ay[bh]]})}else{ar.push(aR[ay[bh]])}}if(u(ao,E)){var aW=0;for(var bg in aR){bt=(E=="line")?"transparent":t[aW%t.length];ar=[];for(var be=0;be<ay.length;be++){ar.push(aR[bg][ay[be]]||0)}az.push({label:bg,fillColor:bt,strokeColor:t[aW%t.length],pointColor:t[aW%t.length],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:t[aW%t.length],data:ar});aW++;if(aW>=250){break}}if(ax.isTypeDate()||ax.isTypeDateTime()){az.sort(function(bv,bu){var bx=ad(bv.label,I.formatting.dateFormat);var bw=ad(bu.label,I.formatting.dateFormat);if(bx>bw||isNaN(bx.getTime())){return 1}else{return -1}})}else{if(ax.dataType=="PICKLIST"){if(typeof gridInfoMap!="undefined"){aO=gridInfoMap[ax.gridId].metaColumns;for(var a7=0;a7<aO.length;a7++){if(aO[a7].fieldName==ax.name){aV=aO[a7].getOrderedPicklistOptions()}}}else{aV=ax.picklistValues}for(var a5=0;a5<aV.length;a5++){a3.push(r(aV[a5].v))}az.sort(function(bv,bu){if(a3.indexOf(bv.label)>a3.indexOf(bu.label)){return 1}else{return -1}})}else{if(ax.dataType=="BOOLEAN"){az.sort(function(bv,bu){if(bk.indexOf(bv.label)>bk.indexOf(bu.label)){return 1}else{return -1}})}else{az.sort(function(bv,bu){return(bv.label.toLowerCase()>bu.label.toLowerCase())?1:-1})}}}}else{bt=(E=="line")?"transparent":t[0];az=[{label:"",fillColor:bt,strokeColor:t[0],pointColor:t[0],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:t[0],data:ar}]}if(E==e){aN=ar}else{aN={labels:ay,datasets:az}}aY.push({chartDrawingData:{xAxisLabel:aB,yAxisLabel:aJ,groupByLabel:aw,y_valueMetaCol:aD,chartDefinition:ao},chartData:aN})}if(T&&v.hasClass("chartHidden")){G=aY}else{am(aY)}}function aa(at,aq){var ar=at[aq],ao;for(var ap=0;ap<ar.length;ap++){if(ar[ap].attributes&&ar[ap].attributes.type&&ar[ap].attributes.type=="AggregateResult"){ao=ar[ap];ar.splice(ap,1);break}}return ao}function c(at,aq){var ao=0,ar=at[aq];for(var ap=0;ap<ar.length;ap++){if(ar[ap].attributes.type&&ar[ap].attributes.type=="AggregateResult"){ao+=1}else{break}}return ao}function am(ap){if(n.length>0){for(var ao=0;ao<n.length;ao++){n[ao].destroy()}n=[]}for(var ao=0;ao<ap.length;ao++){S(ap[ao].chartData,ap[ao].chartDrawingData)}T=true}function S(aI,au){var at,aq,ar,aH,ao=au.chartDefinition,ay=(ao.data_labels)?true:false,aw=ao.type,aB=ao.id,aA=I.standalone,aF=aA?al[Y].width:al[ao.size].width,aD=aA?al[Y].height:al[ao.size].height,aC=aA?v:o("div.chartBody-"+aB),av=au.xAxisLabel,aE=au.yAxisLabel,az=au.groupByLabel,ax=au.y_valueMetaCol;if(au.error&&au.error=="nodata"){aC.find(".chartWithAxis").hide();aC.find(".nodataMessage").show();return}if(aw==k){aC.find(".chartCanvas").after('<div class="chartTile"><span class="tileValue">'+aI+'</span><div class="tileDescription">'+r(ao.description)+"</div></div>").remove();var ap=aC.find(".tileValue").css("font-size").replace("px","")*1;var aG=(aC.find(".chartTile").width()-20)/aC.find(".tileValue").width();if(!isNaN(ap)&&aG<1){aC.find(".tileValue").css("font-size",ap*aG)}aC.addClass("color-"+ao.color).addClass("tileChart");if(I.def.length==1&&!I.standalone){aC.closest(".chartBody").css("height",aC.find("div.chartTile").height()+70)}return}if(aw==e){aH={animateRotate:false,tooltipTemplate:function(aJ){return aJ.label+": "+H(ax,aJ.value)},scaleLabel:function(aJ){return H(ax,aJ.value)},responsive:false,showInlineValues:true,centeredInllineValues:true,pointHitDetectionRadius:1,legendTemplate:function(aK){var aM='<div class="chart-legend-container"><h3>'+av+'</h3><ul class="chart-legend">';var aL=[];for(var aJ=0;aJ<aK.segments.length;aJ++){aL.push('<li><span style="background-color:'+aK.segments[aJ].fillColor+'"></span>'+r(aK.segments[aJ].label)+": "+r(H(ax,aK.segments[aJ].value))+"</li>")}aM+=aL.join("")+"</ul></div>";return aM}};if(!I.standalone){aH.scaleFontColor="#fff";aH.tooltipFillColor="#fff";aH.tooltipTitleFontColor="#000";aH.tooltipFontColor="#000"}}else{ar={animation:false,tooltipTemplate:function(aJ){return aJ.label+": "+H(ax,aJ.value)},multiTooltipTemplate:function(aJ){return aJ.datasetLabel+": "+H(ax,aJ.value)},scaleLabel:function(aJ){return H(ax,aJ.value)},responsive:false,showInlineValues:true,centeredInllineValues:true,pointHitDetectionRadius:1,legendTemplate:function(aK){var aM='<div class="chart-legend-container"><h3>'+az+'</h3><ul class="chart-legend">';var aL=[];for(var aJ=0;aJ<aK.datasets.length;aJ++){aL.push('<li><span style="background-color:'+aK.datasets[aJ].strokeColor+'"></span>'+r(aK.datasets[aJ].label)+"</li>")}aM+=aL.join("")+"</ul></div>";return aM},metaCol:ax};if(!I.standalone){ar.scaleFontColor="#fff";ar.tooltipFillColor="#fff";ar.tooltipTitleFontColor="#000";ar.tooltipFontColor="#000"}if(ay){ar.showTooltips=false;ar.tooltipCaretSize=0;ar.onAnimationComplete=function(){if(this.name=="Bar"){this.eachBars(function(aJ){U(this,aJ)})}else{if(this.name=="Line"){this.eachPoints(function(aJ){U(this,aJ)})}}}}}aq=aC.find(".chartCanvas").get(0).getContext("2d");if(aw=="bar"){at=new Chart(aq).Bar(aI,ar)}else{if(aw=="line"){at=new Chart(aq).Line(aI,ar)}else{if(aw==e){at=new Chart(aq).Doughnut(aI,aH)}}}if(at){n.push(at)}if(u(ao,aw)||aw==e){aC.find(".chart-legend-container").remove();aC.find(".chartWithAxis").after(at.generateLegend())}if(aC.find(".xAxisLabel").length==0){if(aw!=e){aC.find(".chartCanvas").before('<h3 class="yAxisLabel">'+aE+"</h3>");aC.find(".chartCanvas").after('<h3 class="xAxisLabel">'+av+"</h3>");aC.find(".yAxisLabel").css({top:aD,width:aD});aC.find(".xAxisLabel").css({width:aF})}else{aC.find(".chartCanvas").after('<h3 class="xAxisLabel">'+aE+"</h3>");aC.find(".xAxisLabel").css({width:aF})}if(!I.standalone&&(v.width()>0)){aC.find(".xAxisLabel").fadeIn().css("display","block")}}if(!I.standalone&&(v.width()>10)&&(o(".chart-legend-container").length>0)){if(!T){s()}else{aC.find(".chart-legend-container").fadeIn()}}}function U(ao,ap){var aq=ap.tooltipPosition();new Chart.Tooltip({x:Math.round(aq.x),y:ao.options.centeredInllineValues?Math.round(ap.y+((ao.options.tooltipFontSize)/2)):Math.round(aq.y),xPadding:ao.options.tooltipXPadding,yPadding:ao.options.tooltipYPadding,fillColor:"transparent",textColor:"#1976D2",fontFamily:ao.options.tooltipFontFamily,fontStyle:ao.options.tooltipFontStyle,fontSize:ao.options.tooltipFontSize,caretHeight:ao.options.tooltipCaretSize,cornerRadius:ao.options.tooltipCornerRadius,text:H(ao.options.metaCol,ap.value),chart:ao.chart}).draw()}function V(ao,ar){if(typeof C==="undefined"){return}var ap={},aq={},au=[];C.meta.forEach(function(aw){var ax=getGridInfoByApiName(aw.fullyQualifiedObjectName.split(":")[0]);if(ax){var ay=aw.gridId+"_"+aw.fullyQualifiedObjectName;au.push(ay);aq[aw.fullyQualifiedObjectName]=ay;var av=(ap[aw.fullyQualifiedObjectName]={});aw.fields.forEach(function(az){var aA=getMetaColByFieldName(ax,az.name);if(aA){av[aA.fieldId]=az}})}});var at=false;au.forEach(function(aw){var av=C[aw];if(av){av.forEach(function(ax){var ay=ao[ax.Id];if(ay){Object.keys(ay).forEach(function(aA){var az=ap[ay.nm][aA];if(az){var aB=az.name;if(ax[aB]!==ay[aA]){at=true}ax[aB]=h(ay[aA],az.dataType)}})}});while(av.length>0&&av[0].Id!=undefined&&av[0].Id[0]==="-"){av.splice(0,1);at=true}}});Object.keys(ar).forEach(function(ay){var aA=ar[ay].nm,ax=ap[aA],av=C[aq[aA]];if(ax){var az=null,aw=ar[ay];Object.keys(aw).forEach(function(aE){var aD=ax[aE],aC,aB;if(aD){if(!az){az={Id:ay};if(aw.pId){az[aA.split(":")[1]]=aw.pId}av.splice(0,0,az)}if(aD.dataType=="REFERENCE"){if(av[av.length-1][aD.fieldRelName]){aC=av[av.length-1][aD.fieldRelName].attributes;aB=I.formatting.object_Name_to_Name_Field[aC.type]||"Name"}else{aC=undefined;aB="Name"}az[aD.fieldRelName]={};az[aD.fieldRelName][aB]=aw[aE];az[aD.fieldRelName].attributes=aC}else{az[aD.name]=h(aw[aE],aD.dataType)}at=true}})}});if(at){ak(C)}}function z(){var ao=I.def,at=[],av=[],ar=[],aw=[],aq=[],ap=[];if(ao.length>0){for(var au=0;au<ao.length;au++){at.push(ao[au].type);av.push(al[ao[au].size].fullName);ar.push(ao[au].color);aw.push(ao[au].x_wedge);aq.push(ao[au].y_value);ap.push(ao[au].summary_type)}}return{chartsTypes:at.join(","),chartsSizes:av.join(","),chartsColors:ar.join(","),chartsXAxis:aw.join(","),chartsYAxis:aq.join(","),chartsSummary:ap.join(",")}}function h(ar,ap){var ao,aq;if(ap==="CURRENCY"){var at=(localeDigitSep||","),au=(localeDecimalSep||".");ar=ar.split(at).join("");ar=ar.replace(au,".");return(isNaN(ar))?0:ar*1}else{if("DOUBLE|INTEGER|PERCENT".indexOf(ap)>-1){return +ar}else{if(ap==="DATE"){ar=ad(ar,I.formatting.dateFormat);ao=("0"+ar.getDate()).slice(-2);aq=("0"+(ar.getMonth()+1)).slice(-2);ar=ar.getFullYear()+"-"+aq+"-"+ao}}}return ar}function aj(ao,at){var au=parseInt(ao.slice(1),16),ap=at<0?0:255,av=at<0?at*-1:at,ar=au>>16,aq=au>>8&255,aw=au&255;return"#"+(16777216+(Math.round((ap-ar)*av)+ar)*65536+(Math.round((ap-aq)*av)+aq)*256+(Math.round((ap-aw)*av)+aw)).toString(16).slice(1)}function a(ap){var ao="";if(ap.indexOf(":")==-1){ao=ap.substring(ap.indexOf("_")+1,ap.length)}else{ao=ap.substring(ap.indexOf("_")+1,ap.indexOf(":"))}return ao}function H(aB,ar){if(!aB){return(ar)?ar:0}if(!ar){return(aB.isNumeric())?0:""}if(aB.isTypeDate()||aB.isTypeDateTime()){var au=o.browser.msie==true&&parseInt(o.browser.version,10);ar=ar.replace("+0000","Z");if(au==7||au==8){ar=ar.split(/\D/);ar=Date.UTC(ar[0],--ar[1]||"",ar[2]||"",ar[3]||"",ar[4]||"",ar[5]||"",ar[6]||"")}var aC=new Date(ar);var ax=aC.getTime()+(aC.getTimezoneOffset()*60000)+(aB.isTypeDateTime()?I.formatting.apexTZOffset:0);var az=new Date(ax);ar=o.datepicker.formatDate(I.formatting.dateFormat,az)}else{if(aB.isNumeric()){var aw=function(aD){return aD.split("").reverse().join("")};var ao=function(aD){var aF=aw(aD);var aE=aF.match(/.{1,3}/g).join(l);return aw(aE)};var av=ar.toString(),ay=av.indexOf("."),aq="",ap=av;if(ay>-1){aq=av.substring(ay,av.length);aq=aq.replace(F,D);ap=av.substring(0,ay)}av=ao(ap);ar=av+aq;if(aB.isTypeCurrency()){var at;var aA=aB.CurrencyIsoCode||I.formatting.defaultIsoCode;at=(I.formatting.isMultiCurrencyOrg?(aA.length>0?(aA+" "):""):J(aA));ar=at+ar}}}return ar}function J(ap){ap=ap||I.formatting.defaultIsoCode;var ao=I.currencySymbolMap[ap]?I.currencySymbolMap[ap]:"";return ao}function K(){return"."}function y(aq,ap,ar){var ao=aq;if(ap>-1&&(aq.length-ap-1>ar)){ao=ao*1;ao=ao.toFixed(ar)}return ao}function M(ap){var ao=o("#chartMessage-"+I.gridNameForAttributes);ao.find(".msgText").text(ap);v.find(".chartHeader").after(ao.show().css({top:(X/2)-24}))}function b(){var ao=o("#chartMessage-"+I.gridNameForAttributes);ao.remove()}function L(ap){var ao=ap+"",aq=ao.indexOf(D)+1;return !aq?0:ao.length-aq}function f(ar,ap,aq){var ao=Math.pow(10,aq||2);return(Math.round(ar*ao)+Math.round(ap*ao))/ao}function r(ap){if(ap){ap=ap+"";var ao=ap.replace(/&/g,"&amp;");ao=ao.replace(/'/g,"&#39;");ao=ao.replace(/"/g,"&#34;");ao=ao.replace(/</g,"&lt;");ao=ao.replace(/>/g,"&gt;");return ao}return ap}function ad(ar,aw){var av="yy",ax="mm",aq="dd",au=new Date();aw=aw.toLowerCase();var ap=aw.indexOf(av);var at=aw.indexOf(ax);var ao=aw.indexOf(aq);au.setYear(ar.substr(ap,4));au.setMonth(ar.substr(at,2)*1-1);au.setDate(ar.substr(ao,2));return au}function d(){var ap=o(".chartContainer");if(q()){var ao=O();ap.addClass("ie");if(ao==8){ap.addClass("ie8")}else{if(ao==9){ap.addClass("ie9")}else{if(ao==10){ap.addClass("ie10")}}}}else{if(o.browser.mozilla==true){ap.addClass("moz")}else{if(o.browser.webkit==true){ap.addClass("webkit")}}}}function q(){return o.browser.msie==true||(/Trident\/7\./).test(navigator.userAgent)}function O(){if(q()){return parseInt(o.browser.version,10)}else{return null}}return{init:ah,showLoaderAndChart:m,updateChart:V,setChartData:an}};var GBMixpanelForChart=(function(c,a,f){function e(g){this.settings=g;if(g.isTrackingDisabled||(typeof mixpanel=="undefined")){return}mixpanel.init(g.mpToken)}function b(g,h){if(this.settings.isTrackingDisabled||(typeof mixpanel=="undefined")){return}if(!h){h={}}var i=f.extend({},h,{"Org ID":this.settings.orgId,"Grid Name":this.settings.gridName,"GridBuddy Edition":this.settings.gbEdition,"GridBuddy Version":this.settings.gridBuddyVersion,"User ID":this.settings.userId,"User Type":this.settings.abbreviatedUserType,"UI Theme":this.settings.uiTheme,"User Language":this.settings.userLanguage,"OS Version":d()});mixpanel.track(g,i);mixpanel.people.set({"User ID":this.settings.userId,"User Type":this.settings.uiTheme,"UI Theme":this.settings.abbreviatedUserType,"User Language":this.settings.userLanguage});mixpanel.identify(this.settings.userId)}return{init:e,track:b};function d(){var i="Unknown OS";var h=navigator.userAgent;if(h&&(h.indexOf("Firefox")==-1)){var g=navigator.appVersion;if(g.indexOf("Mac")!=-1){i=g.match(/([Mac]+.+)/)[1]}else{if(g.indexOf("Windows")){i=g.match(/([Windows]+.+)/)[1]}}}else{if(h.indexOf("Firefox")!=-1){i=navigator.oscpu}}return i}})(window,document,jq);
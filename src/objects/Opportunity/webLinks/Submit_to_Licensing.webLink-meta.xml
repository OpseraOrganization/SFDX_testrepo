<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Submit_to_Licensing</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Submit to Licensing</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/29.0/connection.js&quot;)} 
var pathname = (window.location.pathname).replace(&apos;/&apos;,&apos;&apos;);
try 
{ 
	var Opportunity= new sforce.SObject(&quot;Opportunity&quot;); 
	Opportunity.Id = pathname;
	if(({!Opportunity.Submit_to_Licensing__c}== false) || ({!Opportunity.Corp_HIPI_Opportunity_Number__c = &apos;&apos;})) 
	{
		if({!ISPICKVAL(Opportunity.StageName, &apos;Phase 2: Detailed Negotiation&apos;)}) 
	    {
			Opportunity.Submit_to_Licensing__c= true;	
			Opportunity.SFDC_Entry_Initiated__c = new Date(); 
			result = sforce.connection.update([Opportunity]);
                        console.log(result);
			if(result[0].success==&apos;true&apos;){ 
			var btnService = document.getElementsByName(&quot;submit_to_licensing&quot;); /*tm is button name*/
btnService[0].value=&apos;Please wait...&apos;; //Change the text

btnService[0].style.visibility = &apos;hidden&apos;;

			} 
			else
			{ 
			    alert(&apos;The Update Failed due to Error(s): &apos; + result[0].errors.message); 
			}
        }
        else
		{
		    alert(&quot;Stage is not Phase 2: Detailed Negotiation&quot;);
		}		
	} 
	else 
	{ 
	alert(&quot;License submitted already for this opportunity. Please find the License Number in Corp HIPI Opportunity Number field&quot;); 
	} 
} 
catch(e){ 
alert(&apos;Error: &apos; + e); 
}</url>
</WebLink>

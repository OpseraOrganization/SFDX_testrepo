<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Close_All_Tasks</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Close All Tasks</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/13.0/connection.js&quot;)} 

var caseId=&apos;{!Case.Id}&apos;; 
var resultTask=sforce.connection.query(&quot;Select Id,status, whatid from Task where whatid=&apos;&quot;+ caseId+&quot;&apos; and (status!=&apos;Completed&apos; and Status!=&apos;Cancelled&apos;)&quot;); 
var recordsTasks = resultTask.getArray(&apos;records&apos;); 
var reclnth=recordsTasks.length; 
var i; 
if(reclnth !=0) 
{ 
for( i=0; i&lt;reclnth; i++) 
{ 
var TaskRec= new sforce.SObject(&quot;Task&quot;); 
recordsTasks[i].Status =&apos;Completed&apos;; 
resultTask= sforce.connection.update([recordsTasks[i]]); 
} 
navigateToUrl(window.location.href); 
} 
else 
{ 
window.alert(&quot;No Open Task to Close&quot;); 
}</url>
</WebLink>

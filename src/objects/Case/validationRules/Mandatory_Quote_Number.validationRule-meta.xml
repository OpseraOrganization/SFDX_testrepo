<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Mandatory_Quote_Number</fullName>
    <active>true</active>
    <description>Give error message if there is no quote number before you close the case</description>
    <errorConditionFormula>AND( $RecordType.Name = &apos;Quotes&apos; , 
ISPICKVAL( Type , &apos;Quotes/Availability&apos;) , 
ISBLANK( Quote_Number__c ) , 
OR( ISPICKVAL( Status , &apos;Cancelled&apos;) , ISPICKVAL( Status , &apos;Closed as Duplicate&apos; ) , ISPICKVAL( Status , &apos;Discard&apos;) ,  ISPICKVAL( Status , &apos;Done&apos;) ),
$Profile.Name!=&apos;DeniedPartyScreeningAPIUser&apos;, 
NOT(CONTAINS($Profile.Name, &apos;Portal API User - RFQ&apos;)),
 AND( $Profile.Name !=&apos;API DATA LOAD&apos;, 
$Profile.Name != &apos;System Administrator&apos;, $Profile.Name != &apos;Honeywell System Administrator&apos;) 
)</errorConditionFormula>
    <errorDisplayField>Quote_Number__c</errorDisplayField>
    <errorMessage>Please enter quote number before you close the case.</errorMessage>
</ValidationRule>

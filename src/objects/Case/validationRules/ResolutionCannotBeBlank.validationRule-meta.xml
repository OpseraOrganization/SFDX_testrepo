<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>ResolutionCannotBeBlank</fullName>
    <active>true</active>
    <description>For cases with Classification equal to &quot;CSO Spares&quot; and &quot;CSO Special Programs&quot; the Resolution Field cannot be blank when selecting &quot;Done&quot; as the status.</description>
    <errorConditionFormula>OR( 
(AND( 
ISPICKVAL( Status,&apos;Done&apos;) , 
OR( Case_Record_Type__c = &apos;CSO Spares&apos;, Case_Record_Type__c =&apos;General&apos;, Case_Record_Type__c = &apos;Orders&apos;, Case_Record_Type__c =&apos;Quotes&apos;) , 
OR( ISPICKVAL( Classification__c , &apos;CSO Spares&apos;), ISPICKVAL( Classification__c , &apos;CSO Special Programs&apos;) ) , 
ISBLANK( Resolution__c ), $Profile.Name !=&apos;Portal API User - RFQ (US)&apos; 
)), 
(OR(ISPICKVAL( Status,&apos;Done&apos;),ISPICKVAL( Status , &apos;Propose to Close&apos;)) &amp;&amp; $RecordType.Name = &apos;Flight Technical Services&apos; &amp;&amp; ISBLANK( Resolution__c ) &amp;&amp; $User.Id !=&apos;005300000042rPL&apos; ) 
)
&amp;&amp;($Profile.Name != &apos;System Administrator&apos;)
&amp;&amp; ($Profile.Name != &apos;Honeywell System Administrator (Non US)&apos;) 
&amp;&amp; $Profile.Name != &apos;API DATA LOAD&apos;</errorConditionFormula>
    <errorDisplayField>Resolution__c</errorDisplayField>
    <errorMessage>Please enter Resolution before closing case</errorMessage>
</ValidationRule>

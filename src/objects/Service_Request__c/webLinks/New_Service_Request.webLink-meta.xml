<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>New_Service_Request</fullName>
    <availability>online</availability>
    <description>New Service Request link used in Field Event Page</description>
    <displayType>massActionButton</displayType>
    <linkType>javascript</linkType>
    <masterLabel>New Service Request</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <requireRowSelection>true</requireRowSelection>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/19.0/connection.js&quot;)}
var fevent=&apos;{!Field_Event__c.Id}&apos;;
var result=sforce.connection.query(&quot;Select Id,Name,Account_Name__c,Account_Name_Formula__c,Contact__c,Contact_Name__c,Aircraft_Type__c,Aircraft_Tail_Number__c,Product_Type__c,Catalog_Product_Group__c,Supported_Product__c,Problem_Description__c from Field_Event__c where Id=&apos;&quot;+ fevent+&quot;&apos;&quot;);
var records1 = result.getArray(&apos;records&apos;);
var AccountName = escape(records1[0].Account_Name_Formula__c);
if(AccountName==null)
{
AccountName = &apos;&apos;;
}
var ContactName = records1[0].Contact__c;
var AirCraftType = records1[0].Aircraft_Type__c;
var TailNumber = records1[0].Aircraft_Tail_Number__c;
if(TailNumber==null)
{
TailNumber=&apos;&apos;;
}
var ProductType =escape(records1[0].Product_Type__c);
var CatalogProductGroup = escape(records1[0].Catalog_Product_Group__c);
var SupportedProduct= escape(records1[0].Supported_Product__c);
var Description = escape(records1[0].Problem_Description__c); 
var fno = records1[0].Name; 
if(AirCraftType!=null)
{
AirCraftType=AirCraftType.substring(0,15);
var airr=sforce.connection.query(&quot;Select Id,Name from Platform__c where Id =&apos;&quot;+ AirCraftType+&quot;&apos;&quot;);
var records2 = airr.getArray(&apos;records&apos;);
var AirCraftName =escape(records2[0].Name);
}

if(ContactName!=null)
{
ContactName=ContactName.substring(0,15);
var con=sforce.connection.query(&quot;Select Id,Name from Contact where Id =&apos;&quot;+ ContactName+&quot;&apos;&quot;);
var records3= con.getArray(&apos;records&apos;);
var ConName =escape(records3[0].Name);
}

var RecordtypeName=&apos;Service Request&apos;;
var result=sforce.connection.query(&quot;Select Id,Name from RecordType where name =&apos;&quot;+ RecordtypeName+&quot;&apos;&quot;);
var records1 = result.getArray(&apos;records&apos;);
rec = records1[0];
var recordType=rec.Id;
var recName = rec.Name; 

if(AirCraftType!=null &amp;&amp; ContactName!=null)
{

parent.window.location.replace (&apos;/a1V/e?CF00N30000004rd0p=&apos;+AccountName+&apos;&amp;CF00N30000004rd1J=&apos;+ConName+ &apos;&amp;CF00N30000004rd0r=&apos;+AirCraftName+&apos;&amp;00N30000004rd0q=&apos;+TailNumber+&apos;&amp;00N30000004rd1z=&apos;+ProductType+&apos;&amp;00N30000004rd12=&apos;+CatalogProductGroup +&apos;&amp;00N30000004rd2P=&apos;+SupportedProduct+&apos;&amp;00N30000004rd1t=&apos;+Description+&apos;&amp;RecordType=&apos;+recordType+&apos;&amp;CF00N30000004rd1d=&apos;+fno+&apos;&amp;retURL=/&apos;+fevent+&apos;&amp;nooverride=1&apos;);
}
else if(ContactName!=null)
{
parent.window.location.replace (&apos;/a1V/e?CF00N30000004rd0p=&apos;+AccountName+&apos;&amp;CF00N30000004rd1J=&apos;+ConName+ &apos;&amp;00N30000004rd0q=&apos;+TailNumber+&apos;&amp;00N30000004rd1z=&apos;+ProductType+&apos;&amp;00N30000004rd12=&apos;+CatalogProductGroup +&apos;&amp;00N30000004rd2P=&apos;+SupportedProduct+&apos;&amp;00N30000004rd1t=&apos;+Description+&apos;&amp;RecordType=&apos;+recordType+&apos;&amp;CF00N30000004rd1d=&apos;+fno+&apos;&amp;retURL=/&apos;+fevent+&apos;&amp;nooverride=1&apos;);
}
else if(AirCraftType!=null)
{
parent.window.location.replace (&apos;/a1V/e?CF00N30000004rd0p=&apos;+AccountName+&apos;&amp;CF00N30000004rd0r=&apos;+AirCraftName+&apos;&amp;00N30000004rd0q=&apos;+TailNumber+&apos;&amp;00N30000004rd1z=&apos;+ProductType+&apos;&amp;00N30000004rd12=&apos;+CatalogProductGroup +&apos;&amp;00N30000004rd2P=&apos;+SupportedProduct+&apos;&amp;00N30000004rd1t=&apos;+Description+&apos;&amp;RecordType=&apos;+recordType+&apos;&amp;CF00N30000004rd1d=&apos;+fno+&apos;&amp;retURL=/&apos;+fevent+&apos;&amp;nooverride=1&apos;);

}</url>
</WebLink>

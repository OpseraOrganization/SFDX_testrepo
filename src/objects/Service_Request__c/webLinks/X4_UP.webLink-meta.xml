<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>X4_UP</fullName>
    <availability>online</availability>
    <displayType>massActionButton</displayType>
    <linkType>javascript</linkType>
    <masterLabel>4-UP</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <requireRowSelection>true</requireRowSelection>
    <url>{!REQUIRESCRIPT (&quot;/soap/ajax/13.0/connection.js&quot;)}
var records = {!GETRECORDIDS($ObjectType.Service_Request__c)};
function getInternetExplorerVersion()
// Returns the version of Windows Internet Explorer or a -1
// (indicating the use of another browser).
{
   var rv = -1; // Return value assumes failure.
   if (navigator.appName == &apos;Microsoft Internet Explorer&apos;)
   {
      var ua = navigator.userAgent;
      var re  = new RegExp(&quot;MSIE ([0-9]{1,}[\.0-9]{0,})&quot;);
      if (re.exec(ua) != null)
         rv = parseFloat( RegExp.$1 );
   }
   return rv;
}
  
   var ver = getInternetExplorerVersion();
   if ( ver!= -1 &amp;&amp; records[18]!=null)
   {
	alert(&quot;Invalid Selection - You can select up to 18 records if you are using Internet Explorer; Firefox does not have this limitation. &quot;) 
   }
   else
   {

var records2=records.join(&quot;|&quot;);

	if (records[0] == null)
	{
	alert(&quot;Please select at least one record&quot;)
	}
	else
	{

	window.open(&apos;https://www.appextremes.com/apps/Conga/PointMerge.aspx?SessionId={!API.Session_ID}&amp;ServerUrl={!API.Partner_Server_URL_80}&amp;Id={!User.Id}&amp;ReportId=00O300000067CXi?pv1=&apos;+records2+&apos;,00O300000067CXx?pv1=&apos;+records2+&apos;,00O300000067CY2?pv1=&apos;+records2+&apos;,00O300000067CYC?pv1=&apos;+records2+&apos;,00O300000067CXj?pv1=&apos;+records2+&apos;,00O13000007xzpp?pv1=&apos;+records2+&apos;&amp;TemplateId=a0w30000000TAmJ&amp;DS7=3&amp;OCNR=1&amp;SCHP=1&apos;,&apos;mywindow&apos;,&apos;width=300,height=150&apos;)


	}
}</url>
</WebLink>

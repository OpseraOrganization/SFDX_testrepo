<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>New_GDC</fullName>
    <availability>online</availability>
    <displayType>massActionButton</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Create a Service Request</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <requireRowSelection>true</requireRowSelection>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/19.0/connection.js&quot;)}

var CaseNumber=&apos;{!Case.CaseNumber}&apos;;
var rec1, csoId,gtoId;
var strURL;

var result=sforce.connection.query(&quot;Select Id,IsClosed,Description,CaseNumber,Subject,Product_Type__c,Catalog_Product_Group__c,Supported_Product__c,Account_Name__c,Contact_Name__c,Aircraft_Type__c,Aircraft_Tail_Number__c,Primary_Work_Number__c,Primary_Work_Number_Extension__c,Primary_Cell_Number__c,Primary_Email_Address__c from Case where CaseNumber=&apos;&quot;+ CaseNumber+&quot;&apos;&quot;);
var records1 = result.getArray(&apos;records&apos;);
var CaseId = records1[0].Id;
var AccountName = records1[0].Account_Name__c;
if(AccountName == null)
AccountName = &apos;&apos;;
var ContactName = records1[0].Contact_Name__c;
if(ContactName == null)
ContactName = &apos;&apos;;

var AirCraftType = records1[0].Aircraft_Type__c;
var Description = records1[0].Description;
if(Description ==null)
Description =&apos; &apos;;
var Subject= records1[0].Subject;

if(AirCraftType!=null)
{
AirCraftType=AirCraftType.substring(0,15);
var airr=sforce.connection.query(&quot;Select Id,Name from Platform__c where Id =&apos;&quot;+ AirCraftType+&quot;&apos;&quot;);
var records2 = airr.getArray(&apos;records&apos;);
var AirCraftName =records2[0].Name;
}

var RecordtypeName=&apos;GDC&apos;;
var result=sforce.connection.query(&quot;Select Id,Name from RecordType where name =&apos;&quot;+ RecordtypeName+&quot;&apos;&quot;);
var records1 = result.getArray(&apos;records&apos;);
rec = records1[0];
var recordType=rec.Id;
var recName = rec.Name; 
var ProductType =escape(records1[0].Product_Type__c);
var CatalogProductGroup = escape(records1[0].Catalog_Product_Group__c);
var SupportedProduct= escape(records1[0].Supported_Product__c);
var Description = escape(records1[0].Problem_Description__c);
var fno = records1[0].Name; 
var TailNumber = records1[0].Aircraft_Tail_Number__c;
if(TailNumber==null)
{
TailNumber=&apos;&apos;;
}


parent.window.location.replace (&apos;/a1V/e?CF00N30000004rd0p=&apos;+AccountName+&apos;&amp;RecordType=&apos;+recordType+&apos;&amp;00N30000004rd2O=&apos;+Subject+&apos;&amp;00N30000004rd12=&apos;+CatalogProductGroup +&apos;&amp;00N30000004rd1z=&apos;+ProductType+&apos;&amp;00N30000004rd2P=&apos;+SupportedProduct
+&apos;&amp;CF00N30000004rd1J=&apos;+ContactName+&apos;&amp;CF00N30000004rd0r=&apos;+AirCraftName+&apos;&amp;CF00N30000004rd11=&apos;+CaseNumber+&apos;&amp;00N30000004rd1t=&apos;+Description+&apos;&amp;00N30000004rd0q=&apos;+TailNumber +&apos;&amp;retURL=/&apos;+CaseId+&apos;&amp;nooverride=1&apos;);</url>
</WebLink>

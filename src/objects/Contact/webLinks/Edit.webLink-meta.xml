<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Edit</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Edit</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/19.0/connection.js&quot;)}
var user = sforce.connection.getUserInfo();
var queryy;
var conid= &apos;{!Contact.Id}&apos;; 
var sysid=&apos;{!$Label.Sys_Admin_Profile_Id}&apos;;
var blnflag=true;
if(user.profileId != &apos;{!$Label.Sys_Admin_Profile_Id}&apos; &amp;&amp;
user.profileId != &apos;{!$Label.Honeywell_System_Administrator}&apos; &amp;&amp; 
user.profileId != &apos;{!$Label.Honeywell_System_Administrator_Non_US_PFID}&apos;&amp;&amp;
user.profileId != &apos;{!$Label.Honeywell_System_Administrator_US}&apos; &amp;&amp; 
user.profileId != &apos;{!$Label.Web_Support_CSR}&apos; &amp;&amp;
user.profileId == &apos;00e30000001WUxC&apos;) 
{ 	
var queryy= sforce.connection.query(&apos;Select Id, ContactId from User where ContactId =\&apos;&apos;+ conid+&apos;\&apos;&apos;); 
if(queryy.size&gt;0)
{
	alert(&apos;You are not authorized to edit the data&apos;); 
	blnflag=false;
}
else
{
	blnflag=true;
}
}
if(blnflag)
{
var NewURL = &quot;{!URLFOR($Action.Contact.Edit, Contact.Id , [retURL= Contact.Id] , True)}&quot;; 
window.parent.location.replace(NewURL); 
}</url>
</WebLink>

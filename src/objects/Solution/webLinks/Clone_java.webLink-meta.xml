<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Clone_java</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Clone</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/19.0/connection.js&quot;)}

var SlnId=&apos;{!Solution.Id}&apos;;
var rec1, csoId,gtoId;
var strURL; 
var Rec=&apos;{!Solution.RecordType}&apos;;

var result=sforce.connection.query(&quot;Select Id, RecordType.name,Approver__c,SolutionName,Categorization__c,FAQ__c,SBL_Solution_Legacy_Number__c,Reason_for_Update__c,Content_Review_Approval_Date__c,Audit_Date_CSO__c,Secure_Notes__c,Audit_Frequency__c,   Publish_Internal__c,Publish_External__c,Export_Review_Complete_NLR__c,Legacy_Created_by__c,Legacy_Last_Modified_by__c,Legacy_Approved_By__c,Expiration_Date__c,Intellectual_Property_Review_By__c,Export_Review_By__c,  Content_Review_Approved_By__c,Content_Review_Audit_Approved_By__c,Final_Review_Approved_By__c,Legacy_Created_Date__c,Legacy_Solution_Approval_Date__c,Legacy_Last_Modifed_Date__c,Export_Review_Date__c,Intellectual_Property_Review_Date__c,Current_Approver__c,Product_Support_Engineer_Email__c,Product_Type__c,Catalog_Product_Group__c,Primary__c,Secondary__c,Product_Line_COE__c,Product_Description__c,Product_Number__c,Aircraft_Type__c,Supported_Product__c,Standards_Review_Approved_By__c,Technical_Review_Approved_By__c,Technical_Review_Audit_Approved_By__c,IsAttachment__c from solution where id=&apos;&quot;+ SlnId+&quot;&apos;&quot;); 

var records1 = result.getArray(&apos;records&apos;);
var RecType= records1[0].RecordType.name; 
var Apprid =records1[0].Approver__c;
var Slntitle=records1[0].SolutionName;
var Catgry=records1[0].Categorization__c;
var FAQ1=records1[0].FAQ__c;
if(records1[0].SBL_Solution_Legacy_Number__c==null)
var LegcyNum=&quot;&quot;;
else
var LegcyNum=records1[0].SBL_Solution_Legacy_Number__c;
if(records1[0].Reason_for_Update__c==null)
var RsnFrUpdte=&quot;&quot;;
else
var RsnFrUpdte=records1[0].Reason_for_Update__c;
var Audtdte=records1[0].Audit_Date_CSO__c;
if(records1[0].Secure_Notes__c==null)
var SecurNot=&quot;&quot;;
else
var SecurNot=records1[0].Secure_Notes__c;
var AuditFre=records1[0].Audit_Frequency__c;
var CurApp=records1[0].Current_Approver__c;
if(CurApp==null)
CurApp=&quot;&quot;;
var ProSupEngEmail=records1[0].Product_Support_Engineer_Email__c;
if(ProSupEngEmail==null)
ProSupEngEmail=&quot;&quot;;
var ProTyp=records1[0].Product_Type__c;
var PubInt=records1[0].Publish_Internal__c;
var IsAttach=records1[0].IsAttachment__c;
if(IsAttach==&quot;true&quot;)
IsAttach=1;
else
IsAttach=0;
var prim=records1[0].Primary__c;
if(prim==null)
prim=&quot;&quot;;
var sec =records1[0].Secondary__c;
if(sec==null)
sec=&quot;&quot;;
var CatProGrp=records1[0].Catalog_Product_Group__c;
var ProLnCOE=records1[0].Product_Line_COE__c;
var ProDesc=records1[0].Product_Description__c;

if(PubInt==&quot;true&quot;)
PubInt=1;
else
PubInt=0;
var PubExt=records1[0].Publish_External__c;
if(PubExt==&quot;true&quot;)
PubExt=1;
else
PubExt=0;
var ExReComNLR=records1[0].Export_Review_Complete_NLR__c;
if(ExReComNLR==&quot;true&quot;)
ExReComNLR=1;
else
ExReComNLR=0;
if(records1[0].Legacy_Created_by__c==null)
var LegCreBy=&quot;&quot;;
else
var LegCreBy=records1[0].Legacy_Created_by__c;
if(records1[0].Legacy_Last_Modified_by__c==null)
var LegModBy=&quot;&quot;;
else
var LegModBy=records1[0].Legacy_Last_Modified_by__c;
if(records1[0].Legacy_Last_Modified_by__c==null)
var LegAppBy=&quot;&quot;;
else
var LegAppBy=records1[0].Legacy_Approved_By__c;
var AuditDte=records1[0].Audit_Date_CSO__c;
var IntProRevBy=records1[0].Intellectual_Property_Review_By__c;
var ExpRevByid=records1[0].Export_Review_By__c;
var ConRevAppByid=records1[0].Content_Review_Approved_By__c;
var ConRevAuditAppByid=records1[0].Content_Review_Audit_Approved_By__c;
var FinRevAppBy=records1[0].Final_Review_Approved_By__c;
var ProNumid=records1[0].Product_Number__c;
var SupPro=records1[0].Supported_Product__c;
var AirTypid=records1[0].Aircraft_Type__c;
var StanRevAppByid=records1[0].Standards_Review_Approved_By__c;
var TechRevAppByid=records1[0].Technical_Review_Approved_By__c;
var TechRevAudAppByid=records1[0].Technical_Review_Audit_Approved_By__c;
var user = sforce.connection.getUserInfo(); //assign all of the getUserInfo information to a variable
var offset=user.userTimeZone; //specific value of time zone
//returns the offset for a passed timezone
var gmt=getOffset(offset)
function getOffset(usersTimeZone) {
	var returnVal = &quot;&quot;; //variable for holding the offset after we find it
	var oTable = sforce.connection.describeSObjects([&quot;User&quot;]); 
	var oFields = oTable[0].fields; //get all fields from that table
	for (var a=0; a&lt;oFields.length; a++) { 
		if (oFields[a].name==&quot;TimeZoneSidKey&quot;) { 
			var oPicklistVals = oFields[a].picklistValues; 
			for (var b=0; b&lt;oPicklistVals.length; b++) { 
				if (oPicklistVals[b].value == usersTimeZone) { 
					returnVal = oPicklistVals[b].label.substring(oPicklistVals[b].label.indexOf(&quot;GMT&quot;)+3,oPicklistVals[b].label.indexOf(&quot;)&quot;)); //get the offset from the label
					break; 
				}
			}
		}
	}
	return returnVal; //pass back the offset (it will look something like -05:00)
}

var gmtsplited= gmt.split(&quot;:&quot;);
for(i = 0; i &lt; gmtsplited.length; i++){
var gmthour=gmtsplited[0];
var gmtmin=gmtsplited[1];
}
if((gmtmin.indexOf(&apos;0&apos;))==0)
gmtminnum=0;
else if((gmtmin.indexOf(&apos;4&apos;))==0)
gmtminnum=45;
else if((gmtmin.indexOf(&apos;3&apos;))==0)
gmtminnum=30;

if((gmthour.indexOf(&apos;-&apos;))==0)
var boolean=true;
else
var boolean=false;

var gmthournum=parseInt(gmthour.substring(1),10);

if(AuditDte !=null)
{
var AuditDteRsult= AuditDte.split(&quot;-&quot;);

for(i = 0; i &lt; AuditDteRsult.length; i++){
var AuditYr=AuditDteRsult[0];
var AuditMnt=AuditDteRsult[1];
var AuditDte=AuditDteRsult[2];
}
var d1 = AuditMnt+&quot;/&quot; +AuditDte+&quot;/&quot; +AuditYr;
var Audtdte=d1;
}
else
{
var Audtdte=&quot;&quot;;
}
var Exprewdte=records1[0].Export_Review_Date__c;
if(Exprewdte!=null)
{
var ExprewdteRsult= Exprewdte.split(&quot;-&quot;);

for(i = 0; i &lt; ExprewdteRsult.length; i++){
var ExprewYr=ExprewdteRsult[0];
var ExprewMnt=ExprewdteRsult[1];
var ExprewDte=ExprewdteRsult[2];
}
var d1 = ExprewMnt+&quot;/&quot; +ExprewDte+&quot;/&quot; +ExprewYr;
var Exprewdtef=d1;
}
else
{
var Exprewdtef=&quot;&quot;;
}

var ExpDte=records1[0].Expiration_Date__c;
if(ExpDte!=null)
{
var ExpDteRsult= ExpDte.split(&quot;-&quot;);

for(i = 0; i &lt; ExpDteRsult.length; i++){
var ExpYr=ExpDteRsult[0];
var ExpMnt=ExpDteRsult[1];
var ExpDte=ExpDteRsult[2];
}
var Expd2=ExpMnt+&quot;/&quot; +ExpDte+&quot;/&quot; + ExpYr;
var ExpDtef=Expd2;
}
else
{
var ExpDtef=&quot;&quot;;
}
var SlnDte=records1[0].Content_Review_Approval_Date__c;

if(SlnDte != null)
{
var SlnDteRsult= SlnDte.split(&quot;-&quot;);

for(i = 0; i &lt; SlnDteRsult.length; i++){
var SlnYr=SlnDteRsult[0];
var SlnMnt=SlnDteRsult[1];
var SlnDte=SlnDteRsult[2];
}
var d2 = SlnMnt+&quot;/&quot; +SlnDte+&quot;/&quot; +SlnYr;
var SlnApprldte=d2;
}

else
{
var SlnApprldte=&quot;&quot;;
}


var IntProRewDte=records1[0].Intellectual_Property_Review_Date__c;
if(IntProRewDte!=null)
{
var IntProRewDteRsult= IntProRewDte.split(&quot;-&quot;);

for(i = 0; i &lt; IntProRewDteRsult.length; i++){
var IntProRewYr=IntProRewDteRsult[0];
var IntProRewMnt=IntProRewDteRsult[1];
var IntProRewDte=IntProRewDteRsult[2];
}
var IntProRewDtetime=IntProRewDte.split(&quot;T&quot;);
for(i = 0; i &lt; IntProRewDtetime.length; i++)
{
var IntProRewDteonly=IntProRewDtetime[0];
var IntProRewtime=IntProRewDtetime[1];
}

var IntProRewDtetimeresult=IntProRewtime.split(&quot;:&quot;);
for(i = 0; i &lt; IntProRewDtetimeresult.length; i++)
{
var IntProRewDtetimeresulthoustr=IntProRewDtetimeresult[0];
var IntProRewDtetimeresultmin=IntProRewDtetimeresult[1];
}
var IntProRewDtetimeresulthou= parseInt(IntProRewDtetimeresulthoustr,10);
IntProRewDtetimeresultmin=parseInt(IntProRewDtetimeresultmin,10);
if(boolean){
IntProRewDtetimeresulthou=IntProRewDtetimeresulthou-gmthournum;
IntProRewDtetimeresultmin=IntProRewDtetimeresultmin-gmtminnum;
if(IntProRewDtetimeresultmin&lt;0){
IntProRewDtetimeresultmin=60+IntProRewDtetimeresultmin;
IntProRewDtetimeresulthou=IntProRewDtetimeresulthou-1;
}
}
else{
IntProRewDtetimeresulthou=IntProRewDtetimeresulthou+gmthournum;
IntProRewDtetimeresultmin=IntProRewDtetimeresultmin+gmtminnum;
if(IntProRewDtetimeresultmin&gt;60){
IntProRewDtetimeresultmin=IntProRewDtetimeresultmin-60;
IntProRewDtetimeresulthou=IntProRewDtetimeresulthou+1;
}
}

if(IntProRewDtetimeresulthou&lt;=0){
IntProRewDtetimeresulthou=24+IntProRewDtetimeresulthou;
IntProRewDteonly=(parseInt(IntProRewDteonly,10))-1;
}
else if(IntProRewDtetimeresulthou&gt;=24){
IntProRewDtetimeresulthou=IntProRewDtetimeresulthou-24;
IntProRewDteonly=(parseInt(IntProRewDteonly,10))+1;
}

IntProRewMnt=parseInt(IntProRewMnt,10);
IntProRewYr=parseInt(IntProRewYr,10);
var Intproreturned=Monthyear(IntProRewDteonly,IntProRewMnt,IntProRewYr);
IntProRewDteonly=Intproreturned[0];
IntProRewMnt=Intproreturned[1];
IntProRewYr=Intproreturned[2];

if(IntProRewDtetimeresulthou&gt;12)
{
var IntProRewDtetimehour=IntProRewDtetimeresulthou-12;
var IntProRewDtetimesession=&quot;PM&quot;;
}
else if(LegLastModDtetimeresulthou&lt;12)
{
var IntProRewDtetimehour=IntProRewDtetimeresulthou;
var IntProRewDtetimesession=&quot;AM&quot;;
}
else
{
var IntProRewDtetimehour=IntProRewDtetimeresulthou;
var IntProRewDtetimesession=&quot;PM&quot;;
}
var IntProRewDted2 = IntProRewMnt+&quot;/&quot; +IntProRewDteonly+&quot;/&quot; +IntProRewYr+&quot; &quot;+IntProRewDtetimehour+&quot;:&quot;+IntProRewDtetimeresultmin+&quot; &quot;+IntProRewDtetimesession;
var IntProRewDtef =IntProRewDted2 ;
}

else
{
var IntProRewDtef =&quot;&quot;;
}



var LegLastModDte= records1[0].Legacy_Last_Modifed_Date__c;

if(LegLastModDte!=null)
{
var LegLastModDteRsult= LegLastModDte.split(&quot;-&quot;);

for(i = 0; i &lt; LegLastModDteRsult.length; i++){
var LegLastModYr=LegLastModDteRsult[0];
var LegLastModMnt=LegLastModDteRsult[1];
var LegLastModDte=LegLastModDteRsult[2];
}

var LegLastModDtetime=LegLastModDte.split(&quot;T&quot;);
for(i = 0; i &lt; LegLastModDtetime.length; i++)
{
var LegLastModDteonly=LegLastModDtetime[0];
var LegLastModtime=LegLastModDtetime[1];
}

var LegLastModDtetimeresult=LegLastModtime.split(&quot;:&quot;);
for(i = 0; i &lt; LegLastModDtetimeresult.length; i++)
{
var LegLastModDtetimeresulthoustr=LegLastModDtetimeresult[0];
var LegLastModDtetimeresultmin=LegLastModDtetimeresult[1];
}

var LegLastModDtetimeresulthou= parseInt(LegLastModDtetimeresulthoustr,10);
LegLastModDtetimeresultmin= parseInt(LegLastModDtetimeresultmin,10);

if(boolean){
LegLastModDtetimeresulthou=LegLastModDtetimeresulthou-gmthournum;
LegLastModDtetimeresultmin=LegLastModDtetimeresultmin-gmtminnum;
if(LegLastModDtetimeresultmin&lt;0){
LegLastModDtetimeresultmin=60+LegLastModDtetimeresultmin;
LegLastModDtetimeresulthou=LegLastModDtetimeresulthou-1;
}
}
else
{
LegLastModDtetimeresulthou=LegLastModDtetimeresulthou+gmthournum;
LegLastModDtetimeresultmin=LegLastModDtetimeresultmin+gmtminnum;
if(LegLastModDtetimeresultmin&gt;60){
LegLastModDtetimeresultmin=LegLastModDtetimeresultmin-60;
LegLastModDtetimeresulthou=LegLastModDtetimeresulthou+1;
}
}

if(LegLastModDtetimeresulthou&lt;=0){
LegLastModDtetimeresulthou=24+LegLastModDtetimeresulthou;
LegLastModDteonly=(parseInt(LegLastModDteonly,10))-1;
}
else if(LegLastModDtetimeresulthou&gt;=24){
LegLastModDtetimeresulthou=LegLastModDtetimeresulthou-24;
LegLastModDteonly=(parseInt(LegLastModDteonly,10))+1;
}

LegLastModMnt=parseInt(LegLastModMnt,10);
LegLastModYr=parseInt(LegLastModYr,10);
var Intproreturned1=Monthyear(LegLastModDteonly,LegLastModMnt,LegLastModYr);
LegLastModDteonly=Intproreturned1[0];
LegLastModMnt=Intproreturned1[1];
LegLastModYr=Intproreturned1[2];

if(LegLastModDtetimeresulthou&gt;12)
{
var LegLastModDtetimehour=LegLastModDtetimeresulthou-12;
var LegLastModDtetimesession=&quot;PM&quot;;
}
else if(LegLastModDtetimeresulthou&lt;12)
{
var LegLastModDtetimehour=LegLastModDtetimeresulthou;
var LegLastModDtetimesession=&quot;AM&quot;;
}
else
{
var LegLastModDtetimehour=LegLastModDtetimeresulthou;
var LegLastModDtetimesession=&quot;PM&quot;;
}
var LegLastModDted2 = LegLastModMnt+&quot;/&quot; +LegLastModDteonly+&quot;/&quot; +LegLastModYr+&quot; &quot;+LegLastModDtetimehour+&quot;:&quot;+LegLastModDtetimeresultmin+&quot; &quot;+LegLastModDtetimesession;
var LegLastModDtef =LegLastModDted2 ;
}

else
{
var LegLastModDtef=&quot;&quot;;
}


var legSolAppDte=records1[0].Legacy_Solution_Approval_Date__c;



if(legSolAppDte!=null)
{
var legSolAppDteRsult= legSolAppDte.split(&quot;-&quot;);

for(i = 0; i &lt; legSolAppDteRsult.length; i++){
var legSolAppYr=legSolAppDteRsult[0];
var legSolAppMnt=legSolAppDteRsult[1];
var legSolAppDte=legSolAppDteRsult[2];
}

var legSolAppDtetime=legSolAppDte.split(&quot;T&quot;);
for(i = 0; i &lt; legSolAppDtetime.length; i++)
{
var legSolAppDteonly=legSolAppDtetime[0];
var legSolApptime=legSolAppDtetime[1];
}

var legSolApptimeresult=legSolApptime.split(&quot;:&quot;);
for(i = 0; i &lt; legSolApptimeresult.length; i++)
{
var legSolApptimeresulthoustr=legSolApptimeresult[0];
var legSolApptimeresultmin=legSolApptimeresult[1];
}

var legSolApptimeresulthou= parseInt(legSolApptimeresulthoustr,10);
legSolApptimeresultmin= parseInt(legSolApptimeresultmin,10);
if(boolean){
legSolApptimeresulthou=legSolApptimeresulthou-gmthournum;
legSolApptimeresultmin=legSolApptimeresultmin-gmtminnum;
if(legSolApptimeresultmin&lt;0){
legSolApptimeresultmin=60+legSolApptimeresultmin;
legSolApptimeresulthou=legSolApptimeresulthou-1;
}
}
else{
legSolApptimeresulthou=legSolApptimeresulthou+gmthournum;
legSolApptimeresultmin=legSolApptimeresultmin+gmtminnum;
if(legSolApptimeresultmin&gt;60){
legSolApptimeresultmin=legSolApptimeresultmin-60;
legSolApptimeresulthou=legSolApptimeresulthou+1;
}
}

if(legSolApptimeresulthou&lt;=0){
legSolApptimeresulthou=24+legSolApptimeresulthou;
legSolAppDteonly=(parseInt(legSolAppDteonly,10))-1;
}
else if(legSolApptimeresulthou&gt;=24){
legSolApptimeresulthou=legSolApptimeresulthou-24;
legSolAppDteonly=(parseInt(legSolAppDteonly,10))+1;
}

legSolAppMnt=parseInt(legSolAppMnt,10);
legSolAppYr=parseInt(legSolAppYr,10);
var Intproreturned2=Monthyear(legSolAppDteonly,legSolAppMnt,legSolAppYr);
legSolAppDteonly=Intproreturned2[0];
legSolAppMnt=Intproreturned2[1];
legSolAppYr=Intproreturned2[2];

if(legSolApptimeresulthou&gt;12)
{
var legSolApptimehour=legSolApptimeresulthou-12;
var legSolApptimesession=&quot;PM&quot;;
}
else if(legSolApptimeresulthou&lt;12)
{
var legSolApptimehour=legSolApptimeresulthou;
var legSolApptimesession=&quot;AM&quot;;
}
else
{
var legSolApptimehour=legSolApptimeresulthou;
var legSolApptimesession=&quot;PM&quot;;
}
var legSolAppDted2 = legSolAppMnt+&quot;/&quot; +legSolAppDteonly+&quot;/&quot; +legSolAppYr+&quot; &quot;+legSolApptimehour+&quot;:&quot;+legSolApptimeresultmin+&quot; &quot;+legSolApptimesession;
var legSolAppDtef=legSolAppDted2 ;
}

else
{
var legSolAppDtef=&quot;&quot;;
}

var LegCreDte=records1[0].Legacy_Created_Date__c;
if(LegCreDte!=null)
{
var LegCreDteRsult=LegCreDte.split(&quot;-&quot;);

for(i = 0; i &lt; LegCreDteRsult.length; i++){
var LegCreYr=LegCreDteRsult[0];
var LegCreMnt=LegCreDteRsult[1];
var LegCreDte=LegCreDteRsult[2];
}


var LegCreDtetime=LegCreDte.split(&quot;T&quot;);
for(i = 0; i &lt; LegCreDtetime.length; i++)
{
var LegCreDteonly=LegCreDtetime[0];
var LegCretime=LegCreDtetime[1];
}

var LegCreDtetimeresult=LegCretime.split(&quot;:&quot;);
for(i = 0; i &lt; LegCreDtetimeresult.length; i++)
{
var LegCreDtetimeresultthoustr=LegCreDtetimeresult[0];
var LegCreDtetimeresultmin=LegCreDtetimeresult[1];
}

var LegCreDtetimeresultthou= parseInt(LegCreDtetimeresultthoustr,10);
LegCreDtetimeresultmin= parseInt(LegCreDtetimeresultmin,10);
if(boolean){
LegCreDtetimeresultthou=LegCreDtetimeresultthou-gmthournum;
LegCreDtetimeresultmin=LegCreDtetimeresultmin-gmtminnum;
if(LegCreDtetimeresultmin&lt;0){
LegCreDtetimeresultmin=60+LegCreDtetimeresultmin;
LegCreDtetimeresultthou=LegCreDtetimeresultthou-1;
}
}
else{
LegCreDtetimeresultthou=LegCreDtetimeresultthou+gmthournum;
LegCreDtetimeresultmin=LegCreDtetimeresultmin+gmtminnum;
if(LegCreDtetimeresultmin&gt;60){
LegCreDtetimeresultmin=LegCreDtetimeresultmin-60;
LegCreDtetimeresultthou=LegCreDtetimeresultthou+1;
}
}

if(LegCreDtetimeresultthou&lt;=0){
LegCreDtetimeresultthou=24+LegCreDtetimeresultthou;
LegCreDteonly=(parseInt(LegCreDteonly,10))-1;
}
else if(LegCreDtetimeresultthou&gt;=24){
LegCreDtetimeresultthou=LegCreDtetimeresultthou-24;
LegCreDteonly=(parseInt(LegCreDteonly,10))+1;
}
LegCreMnt=parseInt(LegCreMnt,10);
LegCreYr=parseInt(LegCreYr,10);
var Intproreturned3=Monthyear(LegCreDteonly,LegCreMnt,LegCreYr);
LegCreDteonly=Intproreturned3[0];
LegCreMnt=Intproreturned3[1];
LegCreYr=Intproreturned3[2];

if(LegCreDtetimeresultthou&gt;12)
{
var LegCreDtetimehour=LegCreDtetimeresultthou-12;
var LegCreDtetimesession=&quot;PM&quot;;
}
else if(LegCreDtetimeresultthou&lt;12)
{
var LegCreDtetimehour=LegCreDtetimeresultthou;
var LegCreDtetimesession=&quot;AM&quot;;
}
else
{
var LegCreDtetimehour=LegCreDtetimeresultthou;
var LegCreDtetimesession=&quot;PM&quot;;
}

var LegCreDted2 = LegCreMnt+&quot;/&quot; +LegCreDteonly+&quot;/&quot; +LegCreYr+&quot; &quot;+LegCreDtetimehour+&quot;:&quot;+LegCreDtetimeresultmin+&quot; &quot;+LegCreDtetimesession;
var LegCreDtef=LegCreDted2 ;
}

else
{
var LegCreDtef=&quot;&quot;;
}

if(Apprid != null)

{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ Apprid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var Appr = recordsUsrs[0].Name;
}
else
Appr=&quot;&quot;;

if(IntProRevBy!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ IntProRevBy+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var IntProRev = recordsUsrs[0].Name;
}
else
IntProRev=&quot;&quot;;

if(ExpRevByid!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ ExpRevByid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var ExpRevBy= recordsUsrs[0].Name;
}
else
ExpRevBy=&quot;&quot;;

if(ConRevAppByid!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ConRevAppByid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var ConRevAppBy = recordsUsrs[0].Name;
}
else
ConRevAppBy =&quot;&quot;;

if(ConRevAuditAppByid!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ConRevAuditAppByid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var ConRevAuditAppBy= recordsUsrs[0].Name;
}
else
ConRevAuditAppBy=&quot;&quot;;

if(FinRevAppBy!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ FinRevAppBy+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var FinRevApp= recordsUsrs[0].Name;
}
else
FinRevApp=&quot;&quot;;

if(ProNumid!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from Product2 where id=&apos;&quot;+ ProNumid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var ProNum= recordsUsrs[0].Name;
}
else
ProNum=&quot;&quot;;

if(AirTypid!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from Platform__c where id=&apos;&quot;+ AirTypid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var AirTyp= recordsUsrs[0].Name;
}
else
AirTyp=&quot;&quot;;

if(StanRevAppByid!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ StanRevAppByid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var StanRevAppBy= recordsUsrs[0].Name;
}
else
StanRevAppBy=&quot;&quot;;

if(TechRevAppByid!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ TechRevAppByid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var TechRevAppBy= recordsUsrs[0].Name;
}
else
TechRevAppBy=&quot;&quot;;

if(TechRevAudAppByid!=null)
{
var resultUsr=sforce.connection.query(&quot;Select Id, name from user where id=&apos;&quot;+ TechRevAudAppByid+&quot;&apos;&quot;); 
var recordsUsrs = resultUsr.getArray(&apos;records&apos;);
var TechRevAudAppBy= recordsUsrs[0].Name;
}
else
TechRevAudAppBy=&quot;&quot;;

function Monthyear(IntProRewDteonlypass,IntProRewMntpass,IntProRewYrpass){
var IntProRewDteonlyret=IntProRewDteonlypass;
var IntProRewMntret=IntProRewMntpass;
var IntProRewYrret=IntProRewYrpass;
if(IntProRewMntpass==5||IntProRewMntpass==7||IntProRewMntpass==10){
if(IntProRewDteonlypass&gt;31){
IntProRewDteonlyret=1;
if(IntProRewMntpass==12){
IntProRewMntret=1;
IntProRewYrret=IntProRewYrpass+1;
}
else
IntProRewMntret=IntProRewMntpass+1;
}else if(IntProRewDteonlypass&lt;=0){
IntProRewDteonlyret=30;
if(IntProRewMntpass==1){
IntProRewMntret=12;
IntProRewYrret=IntProRewYrpass-1;
}
else
IntProRewMntret=IntProRewMntpass-1;
}
}else if(IntProRewMntpass==4||IntProRewMntpass==6||IntProRewMntpass==9||IntProRewMntpass==11){
if(IntProRewDteonlypass&gt;30){
IntProRewDteonlyret=1;
if(IntProRewMntpass==12){
IntProRewMntret=1;
IntProRewYrret=IntProRewYrpass+1;
}
else
IntProRewMntret=IntProRewMntpass+1;
}else if(IntProRewDteonlypass&lt;=0){
IntProRewDteonlyret=31;
if(IntProRewMntpass==1){
IntProRewMntret=12;
IntProRewYrret=IntProRewYrpass-1;
}
else
IntProRewMntret=IntProRewMntpass-1;
}
}else if(IntProRewMntpass==1||IntProRewMntpass==8||IntProRewMntpass==12){
if(IntProRewDteonlypass&gt;31){
IntProRewDteonlyret=1;
if(IntProRewMntpass==12){
IntProRewMntret=1;
IntProRewYrret=IntProRewYrpass+1;
}
else
IntProRewMntret=IntProRewMntpass+1;
}else if(IntProRewDteonlypass&lt;=0){
IntProRewDteonlyret=31;
if(IntProRewMntpass==1){
IntProRewMntret=12;
IntProRewYrret=IntProRewYrpass-1;
}
else
IntProRewMntret=IntProRewMntpass-1;
}
}else if(IntProRewMntpass==3){
if(IntProRewDteonlypass&gt;31){
IntProRewDteonlyret=1;
if(IntProRewMntpass==12){
IntProRewMntret=1;
IntProRewYrret=IntProRewYrpass+1;
}
else
IntProRewMntret=IntProRewMntpass+1;
}else if(IntProRewDteonlypass&lt;=0){
IntProRewDteonlyret=28;
if(IntProRewMntpass==1){
IntProRewMntret=12;
IntProRewYrret=IntProRewYrpass-1;
}
else
IntProRewMntret=IntProRewMntpass-1;
}
}else if(IntProRewMntpass==2){
if(IntProRewDteonlypass&gt;28){
IntProRewDteonlyret=1;
if(IntProRewMntpass==12){
IntProRewMntret=1;
IntProRewYrret=IntProRewYrpass+1;
}
else
IntProRewMntret=IntProRewMntpass+1;
}else if(IntProRewDteonlypass&lt;=0){
IntProRewDteonlyret=31;
if(IntProRewMntpass==1){
IntProRewMntret=12;
IntProRewYrret=IntProRewYrpass-1;
}
else
IntProRewMntret=IntProRewMntpass-1;
}
}

return [IntProRewDteonlyret,IntProRewMntret,IntProRewYrret];
}

if(Rec ==&apos;Solution CSO Non-Technical&apos; || Rec ==&apos;Solution CSO Non-Technical (ReadOnly)&apos; || Rec ==&apos;Solution GTO Technical&apos; || Rec ==&apos;Solution GTO Technical (Read Only)&apos;) 
{
if(Rec==&apos;Solution CSO Non-Technical (ReadOnly)&apos; )
Rec=&quot;Solution CSO Non-Technical&quot;;
if(Rec ==&apos;Solution GTO Technical (Read Only)&apos;)
Rec=&quot;Solution GTO Technical&quot;;
var resultRec=sforce.connection.query(&quot;Select Id,Name from RecordType where name =&apos;&quot;+ Rec +&quot;&apos;&quot;);
var recordsRec = resultRec.getArray(&apos;records&apos;);
var recType = recordsRec[0];
var recordType=recType.Id;
var recName = recType.Name; 

parent.window.location.replace (&apos;/501/e?CF00N30000006EUz6=&apos;+Appr +&apos;&amp;SolutionName=&apos;+Slntitle+&apos;&amp;00N30000004rd3X=&apos;+Catgry+&apos;&amp;00N30000004rd43=&apos;+LegcyNum+&apos;&amp;00N30000004rd3z=&apos;+RsnFrUpdte+&apos;&amp;00N30000004rd45=&apos;+SecurNot+&apos;&amp;00N30000004rd3T=&apos;+AuditFre+&apos;&amp;00N30000004rd3y=&apos;+PubInt+&apos;&amp;00N30000004rd3x=&apos;+PubExt+&apos;&amp;00N30000004rd3k=&apos;+ExReComNLR+&apos;&amp;00N30000006DsVH=&apos;+LegCreBy+&apos;&amp;00N30000006FjMh=&apos;+LegAppBy+&apos;&amp;00N30000006DsVg=&apos;+LegModBy+&apos;&amp;00N30000004rd3S=&apos;+Audtdte+&apos;&amp;00N30000004rd3Z=&apos;+SlnApprldte+&apos;&amp;00N30000004rd3h=&apos;+ExpDtef+&apos;&amp;CF00N30000004rd3p=&apos;+IntProRev+&apos;&amp;CF00N30000004rd3j=&apos;+ExpRevBy+&apos;&amp;CF00N30000004rd3a=&apos;+ConRevAppBy+&apos;&amp;CF00N30000004rd3b=&apos;+ConRevAuditAppBy+&apos;&amp;CF00N30000004rd3n=&apos;+FinRevApp+&apos;&amp;00N30000006DsVR=&apos;+LegCreDtef+&apos;&amp;00N30000006DsVq=&apos;+legSolAppDtef+&apos;&amp;00N30000006DsVW=&apos;+LegLastModDtef+&apos;&amp;00N30000004rd3l=&apos;+Exprewdtef+&apos;&amp;00N30000004rd3q=&apos;+IntProRewDtef +&apos;&amp;00N30000004rd3g=&apos;+CurApp+&apos;&amp;00N30000004rd3w=&apos;+ProTyp+&apos;&amp;00N30000004rd3v=&apos;+ProSupEngEmail+&apos;&amp;00N30000004rd3W=&apos;+CatProGrp+&apos;&amp;00N30000004rd3t=&apos;+ProLnCOE+&apos;&amp;00N30000004rd44=&apos;+sec+&apos;&amp;00N30000004rd3r=&apos;+prim+&apos;&amp;00N30000004rd3s=&apos;+ProDesc+&apos;&amp;CF00N30000004rd4D=&apos;+TechRevAudAppBy+&apos;&amp;CF00N30000004rd4C=&apos;+TechRevAppBy+&apos;&amp;CF00N30000004rd3Q=&apos;+AirTyp+&apos;&amp;CF00N30000004rd3u=&apos;+ProNum+&apos;&amp;00N30000004rd4B=&apos;+SupPro+&apos;&amp;00N30000006H85W=&apos;+IsAttach+&apos;&amp;CF00N30000004rd48=&apos;+StanRevAppBy+&apos;&amp;00N30000004rd3m=&apos;+FAQ1+&apos;&amp;RecordType=&apos;+recordType+&apos;&amp;retURL=/&apos;+SlnId+&apos;&amp;nooverride=1&apos;);
}

else
{

alert(&apos;Not Authorized to clone the record&apos;);

}</url>
</WebLink>

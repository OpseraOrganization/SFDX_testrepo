<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Create_New_Contact</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Create New Contact</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/40.0/connection.js&quot;)} 

var isValidRec = true; 
var alertMessageArray =new Array(); 

if(&apos;{!Lead.Account__c}&apos;==&apos;&apos;){ 
alertMessageArray[alertMessageArray.length]=&quot;In the “Existing Account or Contact Information” section, the following fields are required to continue: Account&quot;;
isValidRec = false; 
}
if(&apos;{!Lead.FirstName}&apos;==&apos;&apos;){ 
alertMessageArray[alertMessageArray.length]=&quot;In the “New Account or Contact Information” section, the following fields are required to continue: Name(must complete First and Last Name)&quot;; 
isValidRec = false; 
}

if(isValidRec){
 var urlString = &quot;/003/e?name_firstcon2={!Lead.FirstName}&amp;name_lastcon2={!Lead.LastName}&amp;con4={!Lead.Account__c}+&amp;00N30000004q5Qi={!Lead.Account_SBU__c}&amp;00N30000004q5Ps={!Lead.Account_CBT__c}&amp;00N30000004q5Pr={!Lead.Account_CBT_Team__c}&amp;00Nc0000002VLLd={!Lead.Id}&amp;RecordType=&quot;;

 if(&apos;{!Lead.Account_SBU__c}&apos; ==&apos;ATR&apos;){
 urlString = urlString+&apos;{!JSENCODE($Label.Lead_ATR_Contacts)}&apos;;
}
if(&apos;{!Lead.Account_SBU__c}&apos; ==&apos;BGA&apos;){
 urlString = urlString+&apos;{!JSENCODE($Label.Lead_BGA_Contacts)}&apos;;
}

if(&apos;{!Lead.Account_SBU__c}&apos; ==&apos;D&amp;S&apos;){
 urlString = urlString+&apos;{!JSENCODE($Label.Lead_D_S_Contacts)}&apos;;
}
 window.open(urlString, &quot;_blank&quot;);
}else{
  alert(alertMessageArray.join(&quot;\n&quot;)); 
}</url>
</WebLink>

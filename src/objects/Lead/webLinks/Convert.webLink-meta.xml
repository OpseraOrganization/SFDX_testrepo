<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Convert</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Convert</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/40.0/connection.js&quot;)} 

var isValidRec = true; 
var alertMessageArray =new Array(); 


var query = &quot;select Id,Account__c,Contact__c,Opportunity_Search_Confirmation__c,Opportunity_Name__c from Lead where Id=&apos;{!Lead.Id}&apos; limit 1&quot;; 

var leadResult = sforce.connection.query(query); 
var records = leadResult.getArray(&quot;records&quot;); 
var myObj = records[0]; 

if(myObj.Account__c == null || myObj.Account__c ==&apos;&apos;){ 
alertMessageArray[alertMessageArray.length]=&quot;Account is mandatory&quot;; 
isValidRec = false; 
} 
if(myObj.Contact__c == null || myObj.Contact__c ==&apos;&apos;){ 
alertMessageArray[alertMessageArray.length]=&quot;Contact is mandatory&quot;; 
isValidRec = false; 
}
if(!myObj.Opportunity_Name__c &amp;&amp; myObj.Opportunity_Search_Confirmation__c==&apos;false&apos;){ 
alertMessageArray[alertMessageArray.length]=&quot;User must select only one field: Opportunity Name  OR  Opportunity Search Confirmation.(refer to field help hover for more detail)&quot;; 
isValidRec = false; 
} 
if(myObj.Opportunity_Name__c &amp;&amp; myObj.Opportunity_Search_Confirmation__c == &apos;true&apos;){ 
alertMessageArray[alertMessageArray.length]=&quot;User must select only one field: Opportunity Name  OR  Opportunity Search Confirmation.(refer to field help hover for more detail)&quot;; 
isValidRec = false; 
}
if(isValidRec){
window.open(&apos;/apex/LeadCustomConvert?id=&apos;+myObj.Id,&quot;_self&quot;);
}else{
  alert(alertMessageArray.join(&quot;\n&quot;)); 
}</url>
</WebLink>

<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>New</fullName>
    <availability>online</availability>
    <displayType>massActionButton</displayType>
    <linkType>javascript</linkType>
    <masterLabel>New</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <requireRowSelection>true</requireRowSelection>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/19.0/connection.js&quot;)}
var CaseNumber=&apos;{!Case.CaseNumber}&apos;;
var URL=&apos;{!$Request.retURL}&apos;;
var CaseRec=&apos;{!Case.Id}&apos;;
var CaseId= URL.substring(1,16);
var CancelURL=&apos;/&apos;+CaseId;

var accountId=&apos;{!Case.AccountId}&apos;;
var accountName=&apos;{!Case.Account}&apos;;


var contactId=&apos;{!Case.ContactId}&apos;;
var contactName=&apos;{!Case.Contact}&apos;;

//getting case data
var LeadRecordType = &apos;Lead Create Layout&apos;;
var result=sforce.connection.query(&quot;Select Id from RecordType where SobjectType = &apos;Lead&apos; and name =&apos;&quot;+ LeadRecordType +&quot;&apos;&quot;);
var records1 = result.getArray(&apos;records&apos;);
var rec = records1[0];
var RecordTypeName = rec.Id;
RecordTypeName=RecordTypeName.substring(0,15);

//getting record type
parent.window.location.replace (&apos;/00Q/e?CF00N30000004rdCh_lkid=&apos;+CaseId+&apos;&amp;CF00N30000004rdCh=&apos;+CaseNumber+&apos;&amp;CF00N30000004q67y_lkid=&apos;+accountId+&apos;&amp;CF00N30000004q67y=&apos;+accountName+&apos;&amp;CF00N30000004rdCr_lkid=&apos;+contactId+&apos;&amp;CF00N30000004rdCr=&apos;+contactName+&apos;&amp;RecordType=&apos;+RecordTypeName+&apos;&amp;retURL=/&apos;+CaseRec+&apos;&amp;nooverride=1&apos;);</url>
</WebLink>

<apex:page showheader="false" standardcontroller="case">
<apex:includeScript value="{!$Resource.Cookies}"/>
<apex:includeScript value="{!$Resource.jquery}"/>
    <!-- This script takes the endpoint URL parameter passed from the deployment page and makes
    it the action for the form -->
    <script type="text/javascript">
    function mandatorycheck()
    {
        if(document.getElementById('prechat_field').value=='')
        {
          document.getElementById('prechat_field-err').innerHTML='Please type your Honeywell Employee ID here';
          return false;
        }
        if(document.getElementById('reason').value=='')
        {
          document.getElementById('reason-err').innerHTML='Please type your request here';
          return false;
        } 
    }
    
    function test()
    {
        var txtVal1 = document.getElementById("reason").value;
        Set_Cookie( 'Reason',txtVal1 , '', '/', '', '' ); 
    }
      (function() {
        function handlePageLoad() {
            var endpointMatcher = new RegExp("[\\?\\&]endpoint=([^&#]*)");
            document.getElementById('prechatForm').setAttribute('action',
            decodeURIComponent(endpointMatcher.exec(document.location.search)[1]));
            } if (window.addEventListener) {
                window.addEventListener('load', handlePageLoad, false);
            } else { window.attachEvent('onload', handlePageLoad, false);
            }})();
            
    // Java script for getting Site pick list
    /* var controlingId = "ctrl"
    window.onload = setupPage;
    var ctrlFieldDesc;
    function setupPage() {
        //load page with selectlist component
        ctrlFieldDesc = document.querySelectorAll('[id$="hiddenSite"]')[0].value;
        buildControlling();
    }
    
    function buildControlling() 
    {
        var list = JSON.parse(ctrlFieldDesc);
        var myDiv = document.getElementById("controllingOption");
        appendSelectOption(myDiv, list, controlingId,'', 'liveagent.prechat:Site');
    }*/
    
    
//for displaying Plant as lookup field
    var newWin=null;
    function openLookupPopup(name, id)
    {
        var url="https://hon-aero--csorapd.my.salesforce.com/_ui/common/data/LookupPage?lkfm=editPage&lknm=CF00Na000000B68Vb&lktp=a0I";
        newWin=window.open(url, 'Popup','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
        if (window.focus) 
        {
            newWin.focus();
        }
            
        return false;
    }  
                  
  
    

    /* var newWin=null;
    function openLookupPopup(name, id)
    {
        var url="https://hon-aero--csorapd.my.salesforce.com/apex/LookupProductPopup?namefield=" + name + "&idfield=" + id;
        newWin=window.open(url, 'Popup','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
        if (window.focus) 
        {
            newWin.focus();
        }
        
        return false;
    }*/
    
    function closeLookupPopup()
    {
        if (null!=newWin)
        {
            newWin.close();
        }  
    }
    function getParam(){
        // alert('namePlantID--' +namePlantID);
        document.getElementById("pID").value=document.getElementById("j_id0:j_id4:j_id5:j_id9:j_id20:casePlantID_lkid").value;      
    }
 
    //create every selectoption component
    function appendSelectOption(myDiv, list, cId, ajax, name) 
    {
        selectList = document.createElement("select");
        selectList.id = cId;
        selectList.name = name;
        myDiv.appendChild(selectList);
        var option = document.createElement("option");
        option.text = "--None--";
        selectList.appendChild(option);
        for (var item in list) 
        {
            if (list[item]["active"]) 
            {
                var option = document.createElement("option");
                option.value = list[item]["label"];
                option.text = list[item]["label"];
                if (list[item]["defaultValue"]) 
                {
                    option.selected="selected";
                }
                selectList.appendChild(option);
            }
        }
    }       
    </script>
    
    <style>
    .claserror
    {
     color:#FF0000;
     font-size:100%;
    }
    </style>
    <style>
    .image
    {
     width: 100px;
     height: 30px;
    }
    </style>
    <div Style="align:center">
    <form method='post' id='prechatForm' onsubmit="return mandatorycheck()" >
    <apex:form >
    <apex:pageBlock >
    <center>
    <apex:image value="{!$Resource.HWLogo}" style="" width="180" height="50"/> </center><br/><br/>
    
    <h1>Welcome to Virtual CSR Support</h1><br/><br/>
        <apex:pageBlockSection columns="2">
            <apex:pageBlockSectionItem >
            <div style="text-align:right">
            Honeywell EID: <span class="claserror">*</span></div>
            <!--<input type='text' name='liveagent.prechat:Email' id='prechat_field' />-->
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem >
            <input type='text' name='liveagent.prechat:HoneywellID' id='prechat_field' />
            <span class="claserror" id="prechat_field-err"></span>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem >
            <div style="text-align:right">Sales Order Number: <span class="claserror">*</span></div>
            </apex:pageBlockSectionItem> 
            <apex:pageBlockSectionItem >
            <input type='text' name='liveagent.prechat:SalesOrderNumber'  />
            </apex:pageBlockSectionItem> 
            <apex:pageBlockSectionItem >              
            <div style="text-align:right">Plant: </div>




            </apex:pageBlockSectionItem> 
  

           <apex:pageBlockSectionItem >
                 <apex:inputField value="{!Case.Plant__c}"  onchange="getParam()" id="casePlantID"/>
               
                
              <!--  <apex:outputPanel >
                    <apex:inputHidden value="{!plantId}" id="inputid" />
                    <apex:inputText size="40" value="{!plantName}" id="inputname"  /> 
                    <a href="#" onclick="openLookupPopup('{!$Component.inputname}', '{!$Component.inputid}'); return false">Lookup</a>
                </apex:outputPanel>

                
            <input type='text' name='liveagent.prechat:Plant'  />
            <img src="/s.gif" onclick="openLookupPopup('{!$Component.targetName}', '{!$Component.targetId}'); return false" class="lookupIcon" onmouseout="this.className='lookupIcon';" alt="Account Name Lookup (New Window)" onmouseover="this.className='lookupIconOn';"/>-->
           
            </apex:pageBlockSectionItem>
            
            <apex:pageBlockSectionItem >
            <div style="text-align:right">
            Subject: </div>
            </apex:pageBlockSectionItem>        
            <apex:pageBlockSectionItem >
            <input type='text' name='liveagent.prechat:Subject'/>
            </apex:pageBlockSectionItem>  
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1">      
            <apex:pageBlockSectionItem >
            How can we help you today? <span class="claserror">*</span><br/>
            <textarea id="reason" name='liveagent.prechat:Reason' onblur="test();" style="width: 400px;height: 60px;"/>
            <span class="claserror" id="reason-err"></span>
            </apex:pageBlockSectionItem>
            <!--<input type="hidden" name="liveagent.prechat.save:Email" value="Email__c" /> -->
            <input type="hidden" name="liveagent.prechat.save:HoneywellID" value="Honeywell_ID__c" />
            <input type="hidden" name="liveagent.prechat.query:Subject"/>
            <input type="hidden" name="liveagent.prechat.save:Subject" value="Chat_Subject__c"/>
            <input type="hidden" name="liveagent.prechat:Plant" value="Plant__c" ID ="pID" />
            <input type="hidden" name="liveagent.prechat.query:Plant"/>
            <input type="hidden" name="liveagent.prechat.save:Plant" value="Plant__c" ID ="PlantID"/>
            <!--<input type="hidden" name="liveagent.prechat.query:Site"/>
            <input type="hidden" name="liveagent.prechat.save:Site" value="Site__c"/>-->
            <input type="hidden" name="liveagent.prechat.query:SalesOrderNumber"/>
            <input type="hidden" name="liveagent.prechat.save:SalesOrderNumber" value="Sales_Order_Number__c"/>
            <input type="hidden" name="liveagent.prechat.query:Reason"/>
            <input type="hidden" name="liveagent.prechat.save:Reason" value="Reason__c"/>
            <input type="hidden" name="liveagent.prechat:CaseStatus" value="Open" /><br />
            <input type="hidden" name="liveagent.prechat:CaseOrigin" value="Web Chat" /><br />
            <input type="hidden" name="liveagent.prechat:CaseRecordType" value="01213000000AWsm" />
           <!--<input type="hidden" name="liveagent.prechat:CaseOwner" value="00G13000004J9kT" />
            <input type="hidden" name="liveagent.prechat.findorcreate.map:Contact" value="Email,Email" />
            <input type="hidden" name="liveagent.prechat.findorcreate.map.doFind:Contact" value="Email,true;" />
            <input type="hidden" name="liveagent.prechat.findorcreate.map.isExactMatch:Contact" value="Email,true;" />-->
            <input type="hidden" name="liveagent.prechat.findorcreate.map:Contact" value="Employee_Number__c,HoneywellID" />
            <input type="hidden" name="liveagent.prechat.findorcreate.map.doFind:Contact" value="Employee_Number__c,true;" />
            <input type="hidden" name="liveagent.prechat.findorcreate.map.isExactMatch:Contact" value="Employee_Number__c,true;" />
               <!-- Mapping the Plant_Code_Master__c fields-->
            <input type="hidden" name="liveagent.prechat.findorcreate.map:Plant_Code_Master__c" value="Id,Plant" ID ="pCode1"/>
            <input type="hidden" name="liveagent.prechat.findorcreate.map.doFind:Plant_Code_Master__c" value="Id,true;" ID ="pCode2" />
            <input type="hidden" name="liveagent.prechat.findorcreate.map.isExactMatch:Plant_Code_Master__c" value="Id,true;" ID ="pCode3" />
                
            <input type="hidden" name="liveagent.prechat.findorcreate.showOnCreate:Contact" value="false" />
            <input type="hidden" name="liveagent.prechat.findorcreate.linkToEntity:Contact" value="Case,ContactId" />
                <input type="hidden" name="liveagent.prechat.findorcreate.showOnCreate:Plant_Code_Master__c" value="false" />
            <input type="hidden" name="liveagent.prechat.findorcreate.linkToEntity:Plant_Code_Master__c" value="Case,Plant__c" />
            <input type="hidden" name="liveagent.prechat.findorcreate.map:Case" value="Subject,Subject;Description,Reason;Status,CaseStatus;Sales_Order_Number__c,SalesOrderNumber;Origin,CaseOrigin;RecordTypeId,CaseRecordType;CSM_Site_Name__c,Site;OwnerId,CaseOwner"/>
            <input type="hidden" name="liveagent.prechat.findorcreate.map.doCreate:Case" value="Subject,true;Status,true;Origin,True;Sales_Order_Number__c,true;Description,true;RecordTypeId,true;CSM_Site_Name__c,true;OwnerId,True" />
                <input type="hidden" name="liveagent.prechat.findorcreate.saveToTranscript:Contact" value="ContactId" />
            <input type="hidden" name="liveagent.prechat.findorcreate.saveToTranscript:Case" value="CaseId" />
             <input type="hidden" name="liveagent.prechat.findorcreate.saveToTranscript:Plant_Code_Master__c" value="PlantID" />   
            <input type="hidden" name="liveagent.prechat.findorcreate.showOnCreate:Case" value="CaseId, true" />
           <!-- <input type="hidden" name="liveagent.prechat.findorcreate.displayToAgent:CaseRecordType" value="false" />
            <input type="hidden" name="liveagent.prechat.findorcreate.displayToAgent:CaseOrigin" value="false" />-->
            
            <apex:pageBlockSectionItem >
            <input type='submit' value='Start Chat' id='prechat_submit'/>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
        </apex:pageBlock>
        </apex:form>
        <style type="text/css">
            p {font-weight: bolder }
        </style>
    </form>  
    </div>
    <apex:insert name="footer">
        <c:honeywellFooter />
</apex:insert>

</apex:page>
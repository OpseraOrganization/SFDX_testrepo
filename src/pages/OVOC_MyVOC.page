<apex:page sidebar="false" showHeader="false" standardStylesheets="false" controller="OVOC_myVOC_Controller" title="OVOC - MyVOC" cache="false" docType="html-5.0" applyHtmlTag="false">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
    <title>OVOC - MyVOC</title>

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0" />
    <meta name="apple-mobile-web-app-title" content="OVOC" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />

    <!--    Bootstrap CSS -->
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'css/bootstrap.min.css')}" rel="stylesheet" media="screen"/>
    
    <!--    Bootstrap CSS - Switch    -->
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'css/switch/bootstrap-switch.min.css')}" rel="stylesheet" media="screen"/> 
    <!--    Bootstrap CSS - Slider    -->
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'css/slider/bootstrap-slider.css')}" rel="stylesheet" media="screen"/>
    
    <!--    User defined CSS files    --> 
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'css/common.css')}" rel="stylesheet" media="screen"/>
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'css/tablet.css')}" rel="stylesheet" media="screen"/>
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'css/smartphone.css')}" rel="stylesheet" media="screen"/>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css" /> 
    
    
    <!--   Images for iOS   -->
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'images/voc_144x144.png')}" rel="apple-touch-icon-precomposed" sizes="144x144" />
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'images/voc_114x114.png')}" rel="apple-touch-icon-precomposed" sizes="114x114" />
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'images/voc_72x72.png')}" rel="apple-touch-icon-precomposed" sizes="72x72" />
    <link href="{!URLFOR($Resource.VOC_Phase2_Test,'images/voc_57x57.png')}" rel="apple-touch-icon-precomposed" />   
    <!--[if IE 8 ]>    <html class="ie8"> <![endif]-->
    
    <!-- HTML5 shiv and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<style>

.create-btn-delete {
    color: #ffffff !important;
}


#ex1Slider.slider.slider-horizontal {
    width: 60px !important;
    margin: 0 10px;
    background-image: none;
    background-color: #EE3124;
    border-radius: 20px;
    height: 34px;
    
}

#ex1Slider.slider.slider-horizontal .slider-track {
    background-color: transparent;
    background-image: none;
    box-shadow: none;
    width: 46%;
    left: 19%;
}

#ex1Slider .slider-selection {
    background-color: transparent;
    background-image: none;
    box-shadow: none;
}

#ex1Slider.slider.slider-horizontal .slider-handle {
    outline: none;
    opacity: 1;
    background-color: #FFFFFF;
    background-image: none;
//    border:1px solid #000000;
    width: 30px;
    height: 30px;
    margin-top: -10px;
}

#ex1Slider.slider.slider-horizontal .slider-track .slider-selection {
    background-color: #EE3124;
}


.export-btn-cls {
    background-image: url("{!URLFOR($Resource.VOC_Phase2_Test,'images/export.png')}");
    background-repeat: no-repeat;
    background-size: 12px 12px; 
    background-position: 5px 10px;
    float: right;
    width: 90px;
}

.detail-attachments{
    margin-top: 20px;
    margin-bottom: 20px;
    text-align: right;
}

.detail-attach-popup{
    width:430px;
}

.detail-attach-align{
    padding: 0px 5px 0px 0px;
}

.detail-attach-popup-align{
    margin: 0;
    position: absolute;
    top: 50%;
    left: 50%;
    margin-top: -80px;
    margin-left: -214px;
}

@media only screen and (max-width: 767px) {
    #details-accordion .panel {
        border: 1px solid #CBCCCE;
        margin: 0;
        border-radius: 0;
    }
    
    #details-accordion {
        margin: 10px 0 0 0;
    }
    
    .detail-attach-popup{
        width:100%;
        padding-right: 20px;
    }
    
    .detail-attach-align{
        padding-top:10px;
    }
    
    .detail-attach-popup-align{
        margin: 0;
        position: absolute;
        top: 2%;
        left: 10px;
        //margin-top: 20px;
        //margin-left: 20px;
    }
}


</style>

<script>    // Windows Phone and IE8 support
    
if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
  var msViewportStyle = document.createElement("style");
  msViewportStyle.appendChild(  document.createTextNode( "@-ms-viewport{width:auto!important}" ) );
  document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
}

if (navigator.userAgent.match(/IE\/8\.0/)) {
  var msViewportStyle = document.createElement("style");
  msViewportStyle.appendChild( document.createTextNode( "@-ms-viewport{width:auto!important}" ) );
  document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
}


if (navigator.appName.match('Microsoft Internet Explorer')) {
  var msViewportStyle = document.createElement("style");
  //msViewportStyle.appendChild( document.createTextNode( "@-ms-viewport{width:auto!important}" ) );
  //document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
}


</script>


<body>

<apex:form >
    
<!--    My VOC Page    -->
<div id="myvoc-page" class="container">
    <!--    Honeywell Header Image    -->
    <div class="row voc-hdr-img">    
        <div class="col-xs-9 col-sm-10 col-md-10 col-lg-10 voc-hdr-imgcls"></div>
        <div class="col-xs-3 hidden-sm hidden-md hidden-lg right-menu-cls"></div>
        <div class="hidden-xs col-sm-2 col-md-2 col-lg-2">
            <a href="/secur/logout.jsp" class="ovoc-logout"> Logout
<!--                <div class="voc-logout-btn"></div>    -->
            </a>
        </div>
    </div>
    
    <!--    Honeywell Header Image - Summary Report Page    -->
    <div class="row voc-hdr-new">
        <div class="col-xs-3 hidden-sm hidden-md hidden-lg back-btn-cls" id="summary-back"> &lt; Back</div>
        <div class="col-xs-6 col-sm-12 col-md-12 col-lg-12 voc-hdr-sub" id="summary-sub-txt">Summary Report</div>
        <div class="col-xs-3 hidden-sm hidden-md hidden-lg right-menu-cls"></div>
    </div>

    <!--    Main Tabs - START    -->
    <div class="row home-black-strip">
        <div class="btn-group btn-group-justified">
            <a id="voc-create" href="OVOC_Create" rel="external" class="btn-group btn btn-default">
                <img src="{!URLFOR($Resource.VOC_Phase2_Test,'images/top-menu-create.png')}" alt=""></img>Create
            </a>
            <a href="" id="voc-myvoc" rel="external" class="btn-group btn btn-default active">
                <img src="{!URLFOR($Resource.VOC_Phase2_Test,'images/top-menu-myVoc.png')}" alt=""></img>My VOC
            </a>
            <a href="OVOC_Search" id="voc-search" rel="external" class="btn-group btn btn-default">
                <img src="{!URLFOR($Resource.VOC_Phase2_Test,'images/top-menu-search.png')}" alt=""></img>Search
            </a>
            <a href="OVOC_HelpPage" id="voc-help" class="btn-group btn btn-default">
                <img src="{!URLFOR($Resource.VOC_Phase2_Test,'images/top-menu-help.png')}" alt=""></img>Help
            </a>
        </div>
    </div>
  
    <!--    VOC - Home Image    -->
    <div class="row hidden-xs home-image"></div>
    <!--    VOC - Home Image for IE8   -->
    <div class="row home-image-ie8" style="display:none;">
        <img id="ie8-hm" src="{!URLFOR($Resource.VOC_Phase2_Test,'images/homeimage_desk.png')}" width='auto' height='150px'></img>
    </div>
   
    <!--    My VOC Content    -->
    <div class="row home-container">
        <!-- Nav tabs -->
        <ul class="nav nav-tabs myvoc-tabs">
          <li id="myvoc-submitted-control" class="active"><a id="myvoc-submitted-tab" href="#myvoc-submitted" data-toggle="tab">Submitted</a></li>
          <li id="myvoc-draft-control"><a id="myvoc-drafts-tab" href="#myvoc-drafts" data-toggle="tab">Drafts</a></li>
          <li id="myvoc-rep-control"><a id="myvoc-reports-tab" href="#myvoc-reports" data-toggle="tab" class="voc-loader-show">Reports</a></li>
          <li id="myvoc-detail-control" class="hidden"><a id="myvoc-details-tab" href="#myvoc-details" data-toggle="tab" class="voc-loader-show">Details</a></li>
          <li id="myvoc-report-control" class="hidden"><a id="myvoc-reportGenerate-tab" href="#myvoc-reportGenerate" data-toggle="tab" class="voc-loader-show">Summary Report</a></li>
        </ul>
        
        <!-- Tab panes -->
        <div class="myvoc-tabcontent tab-content">
            <!--  Submitted Records  -->
            <div class="tab-pane active" id="myvoc-submitted">
                <!-- Record    -->
                
                <!--<div class="row myvoc-records">
                    <div class="col-xs-9 col-sm-12 col-md-12">
                        <div class="col-xs-3 col-sm-1 col-md-1 myvoc-calender">
                            <div class="myvoc-calender-month">Oct</div>
                            <div class="myvoc-calender-day">6</div>
                            <div class="myvoc-calender-year">2013</div>
                        </div>
                        <div class="col-xs-9 col-sm-11 col-md-11">
                            <div class="col-xs-12 col-sm-12 col-md-12 myvoc-record-head">SB improvements</div>
                            <div class="col-xs-12 col-sm-12 col-md-12 myvoc-rec-sub-hdr"> By Sisi Zhang</div>
                        </div>
                    </div>
                    
                    <div class="col-xs-12 col-sm-12 col-md-12 hidden-xs myvoc-rec-desc">
                        Usually the person is still having with logging in this is beyond the 24-48 hour timeframe. Additional emails are required. Other OEMs define a top kit part number + break up (as Airbus). Makes easier the ordering/cost process They would like to have warranty conditions in all SBs even if not applicable. Pricing and warranty coverage is very confusing, some of our S/B do not cover the entire cost of repair but only ...
                    </div>
                    
                    <div class="col-xs-3 col-sm-12 col-md-12">
                        <div class="col-md-1 col-sm-1 col-xs-12 myvoc-submitted-tag myvoc-voc-tag">VOC-2997</div>
                        <div class="col-md-9 col-sm-9 hidden-xs"><a href="#" class="myvoc-export-link help-link" style="margin-left: 35px;">Export</a></div>
                    </div>
                </div>-->
                
                   
                   
            </div>    
            
            <!--  Drafted Records  -->
            <div class="tab-pane" id="myvoc-drafts">          
                
            
            </div>
            
            <!--  Reports  -->
            <div class="tab-pane" id="myvoc-reports">
                <a href="#" class="myvoc-reports-cls help-link" id="summaryReport">Summary Report</a>
            </div>
            
            <!--  Reports Generate -->
            <div class="tab-pane" id="myvoc-reportGenerate">
            
                 
                <div class="panel-group" id="search-accordion">
                
                      <!--  Saved Searches  -->
               <!--   <div class="panel panel-gray hidden-sm hidden-md hidden-lg">
                    <div id="sSavedSearchesID" class="panel-heading col-sm-12 col-md-12 search-createria">
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Saved Searches</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-savedsearches" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                          <div class="row">
                              <div class="saved-links col-xs-12">  <a href="#" class="help-link">Search Embraer Related</a></div>
                              <div class="saved-links col-xs-12">  <a href="#" class="help-link">All AZ + Engines</a></div>
                              <div class="saved-links col-xs-12">  <a href="#" class="help-link">Customer is Boeing</a></div>
                              <div class="saved-links col-xs-12">  <a href="#" class="help-link">J Mantia as Hon Lead</a></div>
                              <div class="saved-links col-xs-12">  <a href="#" class="help-link">Gulfstream 350 related</a></div>
                              <div class="saved-links col-xs-12">  <a href="#" class="help-link">All Dassault AC</a></div>
                              <div class="saved-links col-xs-12">  <a href="#" class="help-link">Falcon F7X APU</a></div>
                          </div>
                      </div>
                    </div>
                  </div> -->
                
                  <!--  Report Number  -->
                  <div class="panel panel-gray">
                    <div id="sReportNumberID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Record Number</div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Enter a record number to target your report Report Number</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-ReportNumber" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                             
                              <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1" style="width: 130px">Record Number </div>
                              <div class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5">
                                <!--  <input id="sReportNumber" type="text" class="create-inp-flds" placeholder="VOC or OVOC Number"></input> -->
                                  <apex:inputtext styleclass="search-inp-flds" value="{!recordNumber}" html-placeholder="VOC or OVOC Number" id="recnumreport"/>
                              </div>
                          </div>
                      </div>
                    </div>
                  </div>
                  
                  <!--  Current Status  -->
                  <div class="panel panel-white">
                    <div id="sCurrentStatusID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Current Status </div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Select a status to narrow down the results. </div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-CurrentStatus" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                              <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                                        Select the status you want to target
                              </div>
                              <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1">Report Status  </div>
                              <div id="" class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5">
                                      <apex:selectList id="Status" value="{!CurrentStatus}" size="1">
                                          <apex:selectOption itemValue="Any" itemLabel="Any"/>
                                          <apex:selectOption itemValue="Draft" itemLabel="Draft"/>
                                          <apex:selectOption itemValue="Completed" itemLabel="Completed"/>
                                      </apex:selectList>     
                                <!--  <select id="currentstatusList">
                                  </select>  -->  
                              </div>
                          </div>
                      </div>
                    </div>
                  </div>
                  
                  <!--  Sensitivity Level   -->
                  <div class="panel panel-gray">
                    <div id="sSensitivityLevelID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Sensitivity Level    </div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Select a sensitivity level to narrow down the results.</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-SensitivityLevel" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                              <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                                   Sensitivity Level of the records
                              </div>
                              <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1">Name / Title: </div>
                              <div class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5">
                                      <apex:selectList id="SensitivityLevel" value="{!SensitiveLevel}" size="1">
                                          <apex:selectOption itemValue="Any" itemLabel="Any"/>
                                          <apex:selectOption itemValue="Sensitive Information" itemLabel="Sensitive Information"/>
                                          <apex:selectOption itemValue="Nonsensitive Information" itemLabel="Nonsensitive Information"/>
                                      </apex:selectList>
                              </div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <!--  Date Range Search  -->
                  <div class="panel panel-white">
                    <div id="sDaterangeID" class="panel-heading col-sm-12 col-md-12 search-createria">
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Date Range </div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Enter a date range to narrow your search</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-daterange" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                          <div class="row" style="margin-top: 5px;">
                              <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                                  Enter a date range to narrow your search
                              </div>
                              <div class="create-lbls hidden-xs col-sm-1 col-md-1 col-lg-1">From: </div>
                              <div class="create-inp-rows col-xs-12 col-sm-4 col-md-4 col-lg-4">
                                  <apex:inputtext id="sFromDate" styleclass="search-inp-flds dateClass" html-placeholder="From date" value="{!FromDate}"/>
                                  <apex:inputtext id="sFromDate_mob" styleclass="search-inp-flds mobdateClass" html-placeholder="From date" value="{!FromDate_Mob}"/> 
                                  
<!--                                  <input id="sFromDate_mob" class="search-inp-flds mobdateClass"  onfocus="(this.type='date')" style="display:none;" placeholder="From date" data-date-format="mm/dd/yy"></input>    -->
                                 <!-- <input id="sFromDate" type="text" class="create-inp-flds" placeholder="From date" data-date-format="mm/dd/yy"></input> -->
                              </div>
                              <div class="create-lbls hidden-xs col-sm-1 col-md-1 col-lg-1">To: </div>
                              <div class="create-inp-rows col-xs-12 col-sm-4 col-md-4 col-lg-4">
                               <!--   <input id="sToDate" type="text" class="create-inp-flds" placeholder="To date" data-date-format="mm/dd/yy"></input> -->
                                  <apex:inputtext id="sToDate" styleclass="search-inp-flds dateClass" html-placeholder="To date" value="{!ToDate}"/>
                                  <apex:inputtext id="sToDate_mob" styleclass="search-inp-flds mobdateClass" html-placeholder="To date" onfocus="setCurrDate();" value="{!ToDate_Mob}"/> 
                              </div>
                          </div>
                      </div>
                    </div>
                  </div>
                  
                  <!--  Customer Name/Title Search  -->
                  <div class="panel panel-gray">
                    <div id="sCustnameID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Customer Name/Title</div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Name, title, role or job description for customers interviewed</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-custname" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                              <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                                   Name, title, role or job description for customers interviewed
                              </div>
                              <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1">Name / Title: </div>
                              <div class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5">
                                <!--  <input id="sNameTitle" type="text" class="create-inp-flds" placeholder="Name / Title"></input> -->
                                  <apex:inputText styleclass="search-inp-flds" html-placeholder="Name / Title" value="{!CustomerNameTitle}" id="customerNamereport"/>
                              </div>
                          </div>
                      </div>
                    </div>
                  </div>
                  
                   <!--  Account Search  -->
                  <div class="panel panel-white">
                    <div id="sAccountID" class="panel-heading col-sm-12 col-md-12 search-createria">
                        <div class="col-xs-10 col-sm-8 col-md-8     col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Account (Customer or OEM)</div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Typically an OEM such as Boeing or Dassault</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-account" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                              <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                                  Typically an OEM such as Boeing or Dassault
                              </div>
                              <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1">Account: </div>
                              <div class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5">
                                 <!-- <input id="sAccount" type="text" class="create-inp-flds" placeholder="e.g. Boeing, Dassault"></input> -->
                                  <apex:inputtext styleclass="search-inp-flds" html-placeholder="e.g. Boeing, Dassault" value="{!AccountName}" id="accountNameReport"/>
                              </div>
                          </div>
                      </div>
                    </div>
                  </div>
                  
                   <!--  Honeywell Lead Search  -->
                  <div class="panel panel-gray">
                    <div id="sLeadID" class="panel-heading col-sm-12 col-md-12 search-createria">
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Honeywell Lead</div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Primary Honeywell contact for a VOC report</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-lead" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                          <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                               Primary Honeywell contact for a VOC report
                          </div>
                          <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1">Lead: </div>
                          <div class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5">
                           <!--   <input id="sLeads" type="text" class="create-inp-flds" placeholder="Lead Name"></input> -->
                              <apex:inputtext styleclass="search-inp-flds" html-placeholder="Lead Name" value="{!HonLead}" id="honLeadReport"/>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                <!--  
                  <div class="panel panel-white">
                    <div id="sPlatformId" class="panel-heading col-sm-12 col-md-12 search-createria">
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Platform</div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Aircraft Name</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-PlatformId" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                          <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                               Aircraft Name
                          </div>
                          <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1">Platform: </div>
                          <div class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5">
                              <apex:inputtext styleclass="search-inp-flds" html-placeholder="Aircraft name" value="{!platform}" id="PlatformReport"/>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  -->
                  
                   <!--  Product Line Search  -->
                  <div class="panel panel-white">
                    <div id="sProductID" class="panel-heading col-sm-12 col-md-12 search-createria">
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Product Line</div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Honeywell Product Line, such as Crew Interface</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-productline" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                          <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                                    Honeywell Product Line, such as Platform Systems
                          </div>
                          <div class="col-xs-12 col-sm-8 col-md-8">
                            <div id="" class="create-outline create-multiselect">
                                  <apex:repeat value="{!ProductWrapperList}" var="p" id="productlinereport">                                      
                                          <apex:inputCheckbox styleClass="voc-check" value="{!p.checked}" id="productlineValuereport"/>
                                          <apex:outputText value="{!p.pickListEntry}"/><br/>                                     
                                  </apex:repeat>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                   
                  
                  <!--  Purpose   -->
                  <div class="panel panel-gray">
                    <div id="sPurposeID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Purpose     </div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Purpose of VOC or OVOC Record </div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="s-Purpose" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin-top: 5px;">
                              <div class="col-xs-12 hidden-sm hidden-md hidden-lg search-criteria-note">
                                   Purpose(s) of the projects to include.
                              </div>
                              <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1">Purpose </div>
                              <div id="" class="create-outline create-multiselect">
                                  <apex:repeat value="{!PurposeWrapperList}" var="p" id="purposeReport">                                      
                                          <apex:inputCheckbox styleClass="voc-check" value="{!p.checked}" id="purposeValueReport"/>
                                          <apex:outputText value="{!p.pickListEntry}"/><br/>                                
                                  </apex:repeat>
                              </div>
                          </div>
                      </div>
                    </div>
                  </div>
            
               
                    <!-- VOC Title  -->
                    <div class="panel panel-white">
                        <div id="sVOCTitleId" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                            <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                                <div class="col-sm-12 col-md-12 search-criteria-head">VOC Title/Collection</div>
                                <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Title/Collection of the VOC or OVOC Record</div>
                            </div>
                            <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                        </div>
                        <div id="s-VocTitle" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                          <div class="panel-body" style="height: 100%;">
                            <div class="row" style="margin-top: 5px;">
                                 
                                  <div class="create-lbls hidden-xs col-sm-2 col-md-2 col-lg-1" style="width: 130px">VOC Title </div>
                                  <div class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5">
                                      <apex:inputtext styleclass="search-inp-flds" value="{!voctitle}" html-placeholder="VOC or OVOC Title/Collection" id="voctitlereport"/>
                                  </div>
                              </div>
                          </div>
                        </div>
                    </div>
            
                </div>
                

                  <!-- Output format -->  
                  <div class="col-xs-12 col-sm-12 col-md-12">
                      <div class="col-xs-12 col-sm-7 col-md-7">
                          <div class="col-xs-6 col-sm-6 col-md-6" style="margin-top: 10px;">
                              Order By
                          </div>
                          <div class="col-xs-6 col-sm-6 col-md-6" style="margin-top: 10px;">
                                  <apex:selectList id="Order" value="{!Orderby}" size="1">
                                      <apex:selectOption itemValue="Record Number" itemLabel="Record Number"/>
                                      <apex:selectOption itemValue="Status" itemLabel="Status"/>
                                      <apex:selectOption itemValue="Date" itemLabel="Date"/>
                                      <apex:selectOption itemValue="Honeywell Lead" itemLabel="Honeywell Lead"/>
                                      <apex:selectOption itemValue="Account" itemLabel="Account"/>
                                      <apex:selectOption itemValue="Sensitive" itemLabel="Sensitive"/>
                                  </apex:selectList>
                          </div>
                      </div>
                      <div class="col-xs-12 col-sm-5 col-md-5" style="margin-top: 10px;">
                      
                          <div class="col-xs-6 col-sm-6 col-md-6">
                              Output Format
                          </div>
                          <div class="col-xs-6 col-sm-6 col-md-6 report-generate">
                              <!--<apex:selectRadio required="true" value="{!GenerateFormat}" styleClass="exp-radios-cls hidden-xs" id="exp-radios" >
                                  <apex:selectOptions value="{!thisformat}"/> 
                              </apex:selectRadio>    -->
                              <div class="hidden-xs">
                                  <input type="radio" name="reportSelectionDesk" value="PDF" checked="checked">PDF</input>
                                  <input type="radio" name="reportSelectionDesk" value="XLS">XLS</input>
                              </div>
                              <apex:inputHidden value="{!GenerateFormat}" id="generateFormartId"/>
                              
                     <!--         <div class="hidden-sm hidden-md hidden-lg">
                                  PDF <input id="export-check" type="checkbox" name="exp-checkbox" checked="checked"></input> XLS 
                              </div>   
                      -->        
                              <div class="col-xs-12 hidden-sm hidden-md hidden-lg" id="voc-ovoc-slider">
                                  PDF<input id="ex1" data-slider-id='ex1Slider' type="text" data-slider-min="1" data-slider-max="2" data-slider-step="1" data-slider-value="1"/>XLS
                              </div>
                    
                       <!--       <div class="expo-desk">
                                  <input type="radio" name="reportSelectionDesk" value="PDF" checked="checked">PDF</input>
                                  <input type="radio" name="reportSelectionDesk" value="XLS">XLS</input>
                                  <apex:inputHidden value="{!GenerateFormat}" id="generateFormartId"/>
                              </div>
                              <div class="hidden-sm hidden-md hidden-lg expo-mob">
                                  PDF <input id="export-check" type="checkbox" name="exp-checkbox" checked="checked"></input> XLS 
                              </div>    -->

                            <!--  <input type="radio" class="voc-radio" name="report_btn" value="pdf" id="report-pdf" checked="checked">PDF</input>
                              <input type="radio" class="voc-radio" name="report_btn" value="xls" id="report-xls">XLS</input> -->
                          </div>
                      </div>
                  </div>     
                  
                  <!-- Report Generating button -->
                  <div class="col-xs-12 col-sm-12 col-md-12"> 
                     <div id="create-btns1" class="row create-btns-cls" style="border-bottom: 1px solid #CBCCCE;">
                        <div class="col-sm-2 col-md-2 hidden-xs">
                            <a href="" rel="external" class="btn gray-btn create-btn-back" id="" onclick="backbutton();">Back</a>
                        </div>
                        <div class="col-sm-3 col-sm-offset-1 col-md-2 col-md-offset-0 hidden-xs" >
                            <button class="btn gray-btn create-btn-draft" type="reset" onclick="resetbutton()">Reset</button>
                        </div>
                        <div class="col-xs-12 col-xs-offset-0 col-sm-2 col-sm-offset-0 col-md-2 col-md-offset-2" style="margin-bottom: 10px;">
                            <a class="btn red-btn create-generate-btn" onclick="SendReporMailPopup()">Email Report</a>
                           <!-- <apex:commandLink id="EmailReport" styleclass="btn red-btn create-generate-btn" rerender="mypanel" action="{!Generatemailreport}">Email Report
                            </apex:commandLink> -->
                        </div>
                        <div id="genReportID" class="col-xs-12 col-xs-offset-0 col-sm-3 col-sm-offset-1 col-md-3 col-md-offset-1" style="text-align:right;">
                            <!--<a class="btn red-btn create-next-btn" data-toggle="tab" id="generateReport" onclick="GetReportList()" target="_blank">Generate PDF Report</a>-->
                            <apex:actionFunction name="passStringToController" action="{!assignReportFormat}" rerender="generateFormartId"/>
                            <apex:commandLink id="genReport" styleclass="btn red-btn create-generate-btn" action="{!setParams}" onclick="setType();" target="_blank">Generate PDF Report</apex:commandLink>
                              <!--  <a class="btn red-btn create-next-btn" data-toggle="tab" id="generateReport" onclick="setSearchParams();" target="_blank">Generate PDF Report</a>  -->
                            <apex:outputpanel id="mypanel">
                            
                            <!-- Added for Mobile begins-->
                            <div class="col-xs-12 hidden-sm hidden-md hidden-lg" id="MobResetlink" style="margin-top: 10px;">
                                <button class="help-link" onclick="resetbutton()" style="float:left; background: none; border: none; padding-top:5px" type="reset">Reset Search Form</button>
                            </div>
                            <!-- Added for Mobile ends-->
                            
                            </apex:outputpanel>
                            <apex:actionFunction action="{!setParams}" name="setParams" rerender="mypanel">
                                <apex:param name="recordNumber" assignTo="{!recordNumber}" value="" />
                                <apex:param name="CurrentStatus" assignTo="{!CurrentStatus}" value="" />
                                <apex:param name="SensitiveLevel" assignTo="{!SensitiveLevel}" value="" />
                              <!--  <apex:param name="FromDate" assignTo="{!FromDate}" value="" /> -->
                                <apex:param name="ToDate" assignTo="{!ToDate}" value="" />
                                <apex:param name="CustomerNameTitle" assignTo="{!CustomerNameTitle}" value="" />
                                <apex:param name="AccountName" assignTo="{!AccountName}" value="" />
                                <apex:param name="HonLead" assignTo="{!HonLead}" value="" />
                                <apex:param name="platform" assignTo="{!platform}" value="" />
                                <apex:param name="ProductFamily" assignTo="{!ProductFamily}" value="" />
                                <apex:param name="VOCPurpose" assignTo="{!VOCPurpose}" value="" />
                                <apex:param name="orderBy" assignTo="{!orderBy}" value="" />
                                <apex:param name="pdfORxls" assignTo="{!pdfORxls}" value="" />
                                <apex:param name="ReportMail" assignTo="{!ReportMail}" value="true" />
                            </apex:actionFunction>
                        </div>
                    </div>
                  
                  </div>
                  
                  <div>     
                  </div>      
            </div>
            
            <!--  Details -->
            <div class="tab-pane" id="myvoc-details">
                
                <div class="col-xs-9 col-sm-12 col-md-12">
                    <div class="col-xs-3 col-sm-1 col-md-1 myvoc-calender">
                        <div class="myvoc-calender-month" id="month"></div>
                        <div class="myvoc-calender-day" id="date"></div>
                        <div class="myvoc-calender-year" id="year"></div>
                    </div>
                    <div class="col-xs-9 col-sm-11 col-md-11">
                        <div class="col-xs-12 col-sm-12 col-md-12 myvoc-record-head" id="title"></div>
                        <div class="col-xs-12 col-sm-12 col-md-12 myvoc-rec-sub-hdr" id="submittedBy"></div>
                    </div>
                </div>
                
                <div class="col-xs-3 visible-xs hidden-sm hidden-md hidden-lg" id="detailExportBtn_Mob">
                   <!-- <a class="btn gray-btn export-btn-cls" >Export</a> -->
                </div>
                <div class="hidden-xs visible-sm col-sm-12 visible-md visible-lg col-md-12"> <!--    Desktop view for App details page - START    -->
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-header">Hypothesis</div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc" id="hypothesis"></div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-header">Key Takeaways</div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc" id="keyTakeaways"></div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-header">Financial Implications</div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc" id="financialImplications"></div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-header">Key Action Items</div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc" id="keyActions"></div>
                    
                    <div class="col-xs-12 col-sm-12 col-md-12"><hr class="detail-hr"/></div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-header">Purpose of this VOC</div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc-indetail" id="purposeOfVOC"></div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-header">Customers Interviewed</div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc-indetail">
                        <table class="table table-striped">
                            <thead>
                                <tr><th>#</th><th>Name</th> <th>Title</th> <th>Email</th> <th>Company</th></tr>
                            </thead>
                            <tbody id="customers"></tbody>
                        </table>
                    </div>
                    
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-header">Product Related</div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc-indetail">
                        <div id="prodName"></div>
                        <div id="platform"></div>
                        <div id="prodFamily"></div>
                    </div>
                    
                    <div class="col-xs-12 col-sm-12 col-md-12"><hr class="detail-hr" /></div>
                    <div class="col-xs-12 col-sm-12 col-md-12" id="diaplayAttachs">
                        <div class="col-xs-12 col-sm-5 col-md-5 detail-header">Attachments</div>
                        <div class="col-xs-12 col-sm-7 col-md-7 detail-attachments hidden-xs" style="padding-right: 25px;"><a href="#attachAfterSubmit" data-toggle="modal" class="help-link">Click here to add additional attachments</a></div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc-indetail"><div id="attachmentNameLink" class="hidden"></div></div>
                    <div class="col-xs-12 col-sm-12 col-md-12"><hr class="detail-hr" /></div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-header">Reference Links</div>
                    <div class="col-xs-12 col-sm-12 col-md-12 detail-desc-indetail"><div id="ExternalLinks" class="hidden"></div></div>
                    <div class="col-xs-12 col-sm-12 col-md-12"><hr class="detail-hr" /></div>
                </div>    <!--    Desktop view for App details page - END    -->
                
                <!--    Mobile view for App details page Start    -->
                
                <div class="panel-group visible-xs col-xs-12 hidden-sm hidden-md hidden-lg" id="details-accordion" >
                    <!--  Key Takeaways  -->
                  <div class="panel panel-white">
                    <div id="dKeyTakeID" class="panel-heading col-sm-12 col-md-12 search-createria">
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Key Takeaways</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="d-keytake" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div id="keyTakeaways_mob" class="panel-body" style="height: 100%;">
                          hello world
                      </div>
                    </div>
                  </div>    <!--  Key Takeaways  -->
                  
                   <!--  Hypothesis  -->
                  <div class="panel panel-gray">
                    <div id="dHypothesisID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Hypothesis</div>
                            <div class="hidden-xs col-sm-12 col-md-12 search-criteria-note">Name, title, role or job description for customers interviewed</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="d-hypothesis" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div id="hypothesis_mob" class="row" style="margin: 10px 0;">
                            Hello Ntt
                        </div>
                      </div>
                    </div>
                  </div>    <!--  Hypothesis    -->
                  
                 
                  <!--  Financial Implications  -->
                  <div class="panel panel-gray">
                    <div id="dFinancialID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Financial Implications</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="d-financial" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div id="financialImplications_mob" class="row" style="margin: 10px 0;">
                            Hello Ntt
                        </div>
                      </div>
                    </div>
                  </div>    <!--  Financial Implications    -->
                  
                  <!--  Key Action Items  -->
                  <div class="panel panel-gray">
                    <div id="dKeyactID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Key Action Items</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="d-keyact" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div id="keyActions_mob" class="row" style="margin: 10px 0;">
                            Hello Ntt
                        </div>
                      </div>
                    </div>
                  </div>    <!--  Key Action Items    -->
                  
                  <!--  Additional Details  -->
                  <div class="panel panel-gray">
                    <div id="dAdditionalID" class="panel-heading col-sm-12 col-md-12 search-createria">                        
                        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8">
                            <div class="col-sm-12 col-md-12 search-criteria-head">Additional Details</div>
                        </div>
                        <div class="col-xs-2 col-sm-4 col-md-4 col-lg-4 collapse-arrow">  </div>
                    </div>
                    <div id="d-additional" class="panel-collapse collapse" style="min-height:50px; height: auto !important;">
                      <div class="panel-body" style="height: 100%;">
                        <div class="row" style="margin: 10px 0;">
                            <div><b>Purpose: </b><span id="purpose_mob"></span></div>
                            <div id=""><b>Honeywell Lead: </b><span id="honLead_mob"></span></div>
                            <div id=""><b>Account:</b><span id="account_mob"></span></div>
                            <!--<div id="oem_mob"><b>OEM:</b></div>-->
                            <div id=""><b>Product Family:</b><span id="prodFamily_mob"></span></div>
                            <div id="sensitive_mob"><b>Sensitive Info?</b> <input id="senInfo_mob" type="checkbox" disabled="disabled"/></div>
                            <div id="" style="margin-top: 5px;"><a href="#attachments_mob" data-toggle="modal" class="help-link">Attachment(s)</a></div>
                            <div id="" style="margin-top: 5px;"><a href="#additionalLinks_mob" data-toggle="modal" class="help-link">Additional Link(s)</a></div>
                            <div id="" style="margin-top: 5px;"><a href="#attachAfterSubmit" data-toggle="modal" class="help-link">Click here to add additional attachments</a></div>
                        </div>
                      </div>
                    </div>
                  </div>    <!--  Additional Details    -->
                    
                  
                </div> <!--    Mobile view for App details page End    -->
                
            </div>
        </div>
    
    </div>    

    <!--    Footer for Mobile devices    --> 
<!--    <div class="row visible-xs hidden-sm hidden-md hidden-lg footer-mob">
        <div class="col-xs-6">
            <a href="javascript:void(0)" class="footer-link">Terms &amp; Conditions</a>
        </div>
        <div class="col-xs-6">
            <a href="javascript:void(0)" class="footer-link-mob footer-link">Privacy Statement</a>
        </div>
    </div>  
-->
    <!--    Footer for Tablet and Desktops    -->
    <div class="row hidden">
        <div class="footer">
            <img src="{!URLFOR($Resource.VOC_Phase2_Test,'images/footer_bg.png')}" style="width: 100%;"></img>
            <ul  class="inline-list">
                <li><a class="ex5 link" href="https://aerospace.honeywell.com" >Honeywell MyAerospace</a></li>   

                
                <!--<li><span>|</span><a href="https://www51.honeywell.com/aero/portal/Common/Documents/Generic_Terms_Conditions.pdf" target="_system" rel="external" >Terms &amp; Conditions</a></li>
                <li><span>|</span><a href="https://www51.honeywell.com/privacy/" target="_system" rel="external">Privacy Policy</a></li>-->
                
                <!--- Changes for  DOCUMMENTUM Change Project -->
                
                <li><span>|</span><a href="{!$Setup.Docummentum__c.Docummentum_URL1__c}/aero/portal/Common/Documents/Generic_Terms_Conditions.pdf" target="_system" rel="external" >Terms &amp; Conditions</a></li>
                <li><span>|</span><a href="{!$Setup.Docummentum__c.Docummentum_URL1__c}/privacy/" target="_system" rel="external">Privacy Policy</a></li>
                
                
                <li><span>|</span><a href="https://wingmanservices.bendixking.com/GlobalCustomerCareWeb/contactusform.do" target="_system" rel="external">Website Feedback</a></li>
                <li><span>|</span><a href="http://www.careersathoneywell.com/en/aerospace" target="_system" rel="external">Careers</a></li>
                <li><span>|</span><a href="https://commerce.honeywell.com/webapp/wcs/stores/servlet/HonMultimediaDisplayView?storeId=10651" target="_system" rel="external">Media Center</a></li>
                <li><span>|</span><a href="https://aerospace.honeywell.com" target="_system" rel="external">Sitemap</a></li> 
            </ul>
        </div>
        <div class="voc-copyrights">
            <span>&copy; 2013</span>&nbsp;&nbsp; 
            <a href="http://www.honeywell.com" >Honeywell International Inc.</a>
        </div>
    </div>  

</div>

<!--  Top Right Menu  -->
<div class="right-menu-overlay"></div>
<div class="right-menu">
    <ul class="list-group ">
        <!--<li class="list-group-item">
            <input class="menu-search" placeholder="Search"></input>
        </li>-->
        <li class="list-group-item menu-item"><a href="OVOC_Create" class="voc-loader-show">Create</a></li>
        <li class="list-group-item menu-item voc-loader-show">My VOC</li>
        <li class="list-group-item menu-item"><a href="OVOC_Search" class="voc-loader-show">Search</a></li>
        <li class="list-group-item menu-item"><a href="OVOC_HelpPage" class="voc-loader-show">Help / VOC Guidelines</a></li>
        <li class="list-group-item menu-item"><a href="/secur/logout.jsp" class="voc-loader-show">Logout</a></li>
    </ul>
</div>

<!--  Loader Icon  -->
<div class="voc-loader">
    <div class="voc-loader-overlay"></div>
    <div class="voc-loader-icon"></div>
</div>

<!-- Export popup begins -->
<div id="Exportpopup" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Export
            </div>
            <div class="modal-body popup-body">
                Select any One of the following
            </div> 
            <div id="exportexcel" class="modal-body popup-body">
            
            </div>
            <div id="exportemail" class="modal-body popup-body">  
            
            </div>                 
            <div class="modal-footer popup-footer">
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%" onclick="HideExportPopup()" type="button" data-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Export popup ends -->

<!-- Email popup begins -->  
<div id="Emailpopup" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Send Email to : {!$User.FirstName} {!$User.LastName} ?
            </div>
            <div class="modal-body popup-body">
             {!$User.email}   
            </div>                    
            <div class="modal-footer popup-footer">
                <div id="emailOkbuton" class="col-xs-6" style="padding-right:10px">
                </div>
                <div class="col-xs-6" style="padding-right:10px">
                    <a class="btn btn-default white-btn create-next-btn" onclick="ExportPopupemailhide()" type="button" data-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Email popup ends -->

<!-- Email popup ends -->

<!-- Thank you popup begins -->
<div id="ThankYouPopup" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Email confirmation
            </div>
            <div class="modal-body popup-body">
             Email has been sent to your registered email address.   
            </div>                    
            <div class="modal-footer popup-footer">
                <!--<div class="col-xs-6" style="padding-right:10px">
                </div>-->
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%" onclick="ThankYoupopupHide()" type="button" data-dismiss="modal">
                        Ok
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Thank you popup ends -->

<!-- Email Report popup begins -->  
<div id="ReportEmailpopup" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Send Email to : {!$User.FirstName} {!$User.LastName} ?
            </div>
            <div class="modal-body popup-body">
             {!$User.email}   
            </div>                    
            <div class="modal-footer popup-footer">
                <div id="ReportemailOkbuton" class="col-xs-6" style="padding-right:10px">
                <apex:commandLink id="EmailReportpopupbtn" styleclass="btn btn-default white-btn create-next-btn" onclick="ReportEmailpopuphide()" action="{!Generatemailreport}" rerender="mypanel">Ok</apex:commandLink> <!-- rerender="mypanel"-->
                </div>
                <div class="col-xs-6" style="padding-right:10px">
                    <a class="btn btn-default white-btn create-next-btn" onclick="ReportEmailpopuphide()" type="button" data-dismiss="modal">
                        Cancel
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Email Report popup ends -->

<!-- Attachment mobile popup starts  -->
<div id="attachments_mob" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">Attachments  </div>
            <div class="modal-body popup-body" >
                 <div id="attachmentList_mob"></div>
                 <div class="hidden">
                 <!--    src="/servlet/servlet.FileDownload?file=00Pc0000001Bwq1EAC" -->
                     <video  src="/servlet/servlet.FileDownload?file=00Pc0000001BubEEAS"
                        controls="controls" height="300" width="100%" >
                        Your browser does not support this
                     </video>
                     
                 </div>
            </div>                    
            <div class="modal-footer popup-footer">
                
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%"  type="button" data-dismiss="modal">
                        Close
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Attachment mobile popup ends-->
<!-- Addititional Links mobile popup starts  -->
<div id="additionalLinks_mob" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">Additional Link(s)</div>
            <div class="modal-body popup-body" >
                 <div id="additionalAllLinks_mob"></div>
                
            </div>                    
            <div class="modal-footer popup-footer">
                
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%"  type="button" data-dismiss="modal">
                        Close
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Addititional Links mobile popup ends-->

<!-- Delete confirm popup begins -->  
<div id="deletedraftconfirm" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Confirmation  
            </div> 
            <div class="modal-body popup-body">
                Do you really want to DELETE this record?
            </div>                   
            <div class="modal-footer popup-footer">
                <div id="deleteYesbutton" class="col-xs-6" style="padding-right:10px">
                    
                </div>
                <div class="col-xs-6" style="padding-right:10px">
                    <a class="btn btn-default white-btn create-next-btn" onclick="deletedraftconfirmhide()" type="button" data-dismiss="modal">
                        No
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>

<div id="draftdeleted" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Notification
            </div>
            <div class="modal-body popup-body">
             Record Deleted!   
            </div>                    
            <div class="modal-footer popup-footer">
                <!--<div class="col-xs-6" style="padding-right:10px">
                </div>-->
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%" onclick="draftdeletedPopuphide()" type="button" data-dismiss="modal">
                        Ok
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>

<!-- Delete confirm popup ends -->

<!-- Attachments after submit popup starts  -->
<div id="attachAfterSubmit" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" modal-backdrop="true">
    <div class="modal-dialog modal-sm detail-attach-popup detail-attach-popup-align">
        <div class="modal-content">
            <!--<div class="modal-header popup-header">Attachments</div>-->
            <div class="modal-body popup-body" >
                <div class="col-xs-12 col-sm-12 col-md-12" style="margin-top: 20px;margin-bottom: 30px;">
                    <div class="col-xs-12 col-sm-6 col-md-6" >
                        <!--<form id="form1" enctype="multipart/form-data" method="post">-->
                        
                          
                          <input type="file" name="fileToUpload" id="fileToUpload" onchange="fileSelected();"></input>
                          
                            
                          <!--</form>-->
                    </div>
                    
                    <!--<div class="col-xs-12 col-sm-5 col-sm-offset-1 col-md-5 col-md-offset-1" style="text-align: right;">
                        <input type="button" class="btn gray-btn create-btn-back create-upload" onclick="uploadFile()" value="Upload" ></input>
                    </div>-->
                </div>
                    
            </div>                    
            <div class="modal-footer popup-footer">
            
                <div class="col-xs-12 col-sm-6 col-md-6 detail-attach-align">
                    <input type="button" class="btn gray-btn create-btn-back" onclick="uploadFile()" value="Upload" style="width:100%"></input>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-6 detail-attach-align">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%"  type="button" data-dismiss="modal">
                        Cancel
                    </a>
                </div>
                
            </div>
        </div>
    </div> 
</div>
<!-- Attachments after submit popup starts -->

<!-- File selection Check - popup  -->
    <div id="fileSelection_popup" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header popup-header">
                    Notification Message
                </div>
                <div class="modal-body popup-body">
                    Please select a file and use Upload File button.
                    
                </div>
                <div class="modal-footer popup-footer">
                    <div class="col-xs-12" style="">
                        <a type="button" id="" style="width:100%" class="btn btn-default white-btn create-next-btn" data-dismiss="modal">Ok</a>
                    </div>
                                                                 
                    
                </div>
                                    
            </div>
        </div>
    </div>
    <!-- File selection Check - popup   - popup  -->
    
    
    
    <!-- File size Check - popup  -->
    <div id="fileSize_popup" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header popup-header">
                    Notification Message
                </div>
                <div class="modal-body popup-body">
                    File too large, greater than 25MB.
                    
                </div>
                <div class="modal-footer popup-footer">
                    <div class="col-xs-12" style="">
                        <a type="button" id="" style="width:100%" class="btn btn-default white-btn create-next-btn" data-dismiss="modal">Ok</a>
                    </div>
                                                                 
                    
                </div>
                                    
            </div>
        </div>
    </div>
    <!-- File size Check - popup   - popup  -->

</apex:form>

<script src="{!URLFOR($Resource.VOC_Phase2_Test,'js/jquery.min.js')}"></script>
<script src="https://code.jquery.com/ui/1.10.3/jquery-ui.min.js" />

<script src="{!URLFOR($Resource.VOC_Phase2_Test,'js/bootstrap.min.js')}"></script>
<script src="{!URLFOR($Resource.VOC_Phase2_Test,'js/switch/bootstrap-switch.min.js')}"></script>
<script src="{!URLFOR($Resource.VOC_Phase2_Test,'js/slider/bootstrap-slider.js')}"></script>
<script src="{!URLFOR($Resource.VOC_Phase2_Test,'js/common.js')}"></script>
<script src="{!URLFOR($Resource.VOC_Phase2_Test,'js/forcetk.js')}"></script>
<script>
var pdfORxls = 'pdf';

//Get parameters
function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

// This function is not used in this page... copied from search page for ref

// Convert To HTML Starts

var convertToHtml = function(convert){
return $("<span />", { html: convert }).text();
};

// Convert To HTML ends

function setSearchParams(){
      
    var recNum = $('#sReportNumber').val();
    
    var currentStatus = $('#currentstatusList').val();
    
    var sensitiveLevel = $('#SensitivityLevel').val();
    
    var fromDate = $('#sFromDate').val();

    var toDate = $('#sToDate').val();

    var userAgent = navigator.userAgent; 
    if (userAgent.match(/IEMobile\/10\.0/)) {
        fromDate = $('#sFromDate').val();
        toDate = $('#sToDate').val();
   //     console.log("IE --> " + fromDate + " -- " + toDate );
        
    } else if (userAgent.match(/(iPad|iPhone|iPod|Mobile|Android|BlackBerry)/g)) { 
        fromDate = $('#sFromDate_mob').val();
        toDate = $('#sToDate_mob').val();
   //      console.log("mob --> " + fromDate + " -- " + toDate );
    }
    else { 
        fromDate = $('#sFromDate').val();
        toDate = $('#sToDate').val();
   //     console.log("from --> " + fromDate + " -- " + toDate );
    }
    
/*    if ( browser == false ) {
        var fromDate = $('#sFromDate_mob').val();
        var toDate = $('#sToDate_mob').val();
    } else {
        var fromDate = $('#sFromDate').val();
        var toDate = $('#sToDate').val();
    }
*/
    
    var customerName = $('#sNameTitle').val();
    
    var accountName = $('#sAccount').val();
    
    var honLead = $('#sLeads').val();
    
    var prodLine ='';
    $('#ProductFamilyselect input:checked').each(function(){
        prodLine += $(this).val() + ';';
    });
    
    var purpose='';
    
    $('#PurposeOfvoc input:checked').each(function(){
        purpose += $(this).val() + ';';
    });
    
   
    var orderBy = $('#OrderBy').val();
    

    setParams(recNum, currentStatus, sensitiveLevel, fromDate, toDate, customerName, accountName, honLead, prodLine, purpose, orderBy, pdfORxls);
}

function setType(){
    var userAgent = navigator.userAgent;
    //alert(userAgent);
    if (userAgent.match(/(iPad|iPhone|iPod|Mobile|Android|BlackBerry)/g)) { 
        //alert(userAgent);
        browser = false;
//        var switchStatus = $('#export-check').bootstrapSwitch('state');    
        var c_sliderVal = $('#ex1').slider('getValue');
        if( c_sliderVal == 2 ){
            $('[id$=generateFormartId]').val('XLS');
        }else{
            $('[id$=generateFormartId]').val('PDF');
        }
        //alert($('[id$=generateFormartId]').val('PDF'));
    }
    else{
        browser = true;
       
        if($('input[name="reportSelectionDesk"]:checked').val() == 'PDF'){
            $('[id$=generateFormartId]').val('PDF');
        }else if($('input[name="reportSelectionDesk"]:checked').val() == 'XLS'){
            $('[id$=generateFormartId]').val('XLS');
        }
    }
    passStringToController();
    return true;
}
function summaryRepPage() {
    

    if ( $('#myvoc-report-control').hasClass("active") ) { 
            
    
        if ( $( window ).width() < 750 ) {
        
            
            $('.myvoc-tabs').hide();
            $('.home-black-strip').hide();
            $('.voc-hdr-img').hide();
            
            $('.voc-hdr-new').show();
            $('#summary-sub-txt').text('Summary Report');
            $('#myvoc-reportGenerate').show();
            
        } else {
            
            $('.myvoc-tabs').show();
            $('.home-black-strip').show();
            $('.voc-hdr-img').show();
            
            $('.voc-hdr-new').hide();
            $('#myvoc-reportGenerate').show();
        }
    
    } 
    
    if ( $('#myvoc-detail-control').hasClass("active") ) { 
            
    
        if ( $( window ).width() < 750 ) {
        
            
            $('.myvoc-tabs').hide();
            $('.home-black-strip').hide();
            $('.voc-hdr-img').hide();
            
            $('.voc-hdr-new').show();
            $('#summary-sub-txt').text('VOC');
            $('#myvoc-details').show();
            
        } else {
            
            $('.myvoc-tabs').show();
            $('.home-black-strip').show();
            $('.voc-hdr-img').show();
            
            $('.voc-hdr-new').hide();
            $('#myvoc-details').show();
        }
    
    }
}


$( window ).resize(function() {
    summaryRepPage();
});

function setCurrDate() {
 //   alert("today--> "  );
  
}

function openAttachedFile( a_fileID ) {
  //  alert( "hi--> " + a_fileID  );
}


$(document).ready(function() { 
    
    //code for working of - Home Screen shortcut
    if (("standalone" in window.navigator) && window.navigator.standalone) {
    // For iOS Apps
    $('a').on('click', function(e){
          e.preventDefault();
          var new_location = $(this).attr('href');
          if (new_location != undefined && new_location.substr(0, 1) != '#' && $(this).attr('data-method') == undefined){
            window.location = new_location;
          }
        });
    }
    
    //File attchment page rendering
    var query = window.location.search.substring(1);
    var vocDetailRecId = getParameterByName('id');
    
    if(vocDetailRecId != ''){
        openNewTabForDetails(vocDetailRecId);
        $('#myvoc-detail-control').addClass('active');
        $('#myvoc-detail-control').removeClass('hidden');
        $('#myvoc-detail-control').show();
    }else{
        $('#myvoc-report-control').hide();
        $('#myvoc-detail-control').hide();
        $('#myvoc-report-control').removeClass('hidden');
        $('#myvoc-detail-control').removeClass('hidden');
    }
    
    /* Called to display Records    */
    getOVOCRecords('Submitted');   
    getOVOCRecords('Draft');   
    
    /* PDF - XLS Slider Start  */
     $('#ex1').slider({ handle : 'round', selection: 'before', tooltip: 'hide' });
    
     $('#ex1').on('slideStop', function() {
        var c_sliderVal = $('#ex1').slider('getValue');
   
        console.log( c_sliderVal );
         if( c_sliderVal == 2 ){
            $('[id$=genReport]').html('Generate XLS Report');
          } else {
             $('[id$=genReport]').html('Generate PDF Report');
          }
        
    });
    /* PDF - XLS Slider End     */
    
    
    /*  Main Tabs   */
    
    // Create Page
    $("#voc-create").click( function() {    
        $(".voc-loader").show();
    });
    
    // My VOC Page
    $("#voc-myvoc").click( function() { 
//        $(".voc-loader").show();    
    });
    
    // Search Page
    $("#voc-search").click( function() { 
        $(".voc-loader").show();
    });
    
    // Help Page
    $("#voc-help").click( function() {
        $(".voc-loader").show();
    });

   

    var mDate = new Date();
    var mDay = mDate.getDate();
    var mMonth = mDate.getMonth() + 1;
    var mYear = mDate.getFullYear();

    //$('#myvoc-drafts').attr('class').

    //Apply target for command link
    $('#genReportID a').attr('target','_system');

    var userAgent = navigator.userAgent;
    if (userAgent.match(/IEMobile\/10\.0/)) {
        $(".mobdateClass").hide();
        $(".dateClass").show();
        
        $(".dateClass").attr("readonly", "readonly");
    
    } else if (userAgent.match(/(iPad|iPhone|iPod|Mobile|Android|BlackBerry)/g)) { 
        browser = false;
        
         // Date Fields
          $(".mobdateClass").show();
          $(".dateClass").hide();
          
          $(".mobdateClass").attr("type", "date");
    //     $(".mobdateClass").attr("readonly", "readonly");

    }
    else {   
        browser = true;
        
         // Date Fields
          $(".mobdateClass").hide();
          $(".dateClass").show();
        $(".dateClass").attr("readonly", "readonly");
    }

    /*     Switch code     */
    $("[name='exp-checkbox']").bootstrapSwitch();
    $('div.bootstrap-switch').addClass('switch-dimensions');
    $('.bootstrap-switch-handle-on').html('');
    $('.bootstrap-switch-handle-off').html('');
    
    
    $('input[name="exp-checkbox"]').bootstrapSwitch('state',false);
    
    $('input[name="exp-checkbox"]').on('switchChange.bootstrapSwitch', function(event, state) {
      
          if ( state.value == true ) {
             $('[id$=genReport]').html('Generate XLS Report');
          } else {
             $('[id$=genReport]').html('Generate PDF Report');
          }
    });
  

    //    Key Takeaways
    $("#dKeyTakeID").click( function() {
        if ( $('#d-keytake').hasClass("in")) {
            $('#d-keytake.collapse').removeClass("in");
            $('#dKeyTakeID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#details-accordion .panel .panel-heading').removeClass('panel-red');
            $('#d-keytake.collapse').addClass("in");
            $('#dKeyTakeID').addClass('panel-red');
        }
    });

    //    Hypothesis
    $("#dHypothesisID").click( function() {
        if ( $("#d-hypothesis").hasClass("in")) {
            $('#d-hypothesis.collapse').removeClass("in");
            $('#dHypothesisID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");   
            $('#details-accordion .panel .panel-heading').removeClass('panel-red');
            $('#d-hypothesis.collapse').addClass("in");
            $('#dHypothesisID').addClass('panel-red');
        }
    });
    
    //    Financial Implications
    $("#dFinancialID").click( function() {
        if ( $("#d-financial").hasClass("in")) {
            $('#d-financial.collapse').removeClass("in");
            $('#dFinancialID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");   
            $('#details-accordion .panel .panel-heading').removeClass('panel-red');
            $('#d-financial.collapse').addClass("in");
            $('#dFinancialID').addClass('panel-red');
        }
    });
    
    //    Key Action Items
    $("#dKeyactID").click( function() {
        if ( $("#d-keyact").hasClass("in")) {
            $('#d-keyact.collapse').removeClass("in");
            $('#dKeyactID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");   
            $('#details-accordion .panel .panel-heading').removeClass('panel-red');
            $('#d-keyact.collapse').addClass("in");
            $('#dKeyactID').addClass('panel-red');
        }
    });
    
    
    //    Additional Details
    $("#dAdditionalID").click( function() {
        if ( $("#d-additional").hasClass("in")) {
            $('#d-additional.collapse').removeClass("in");
            $('#dAdditionalID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");   
            $('#details-accordion .panel .panel-heading').removeClass('panel-red');
            $('#d-additional.collapse').addClass("in");
            $('#dAdditionalID').addClass('panel-red');
        }
    });

    summaryRepPage();
    
    
    $("#summaryReport").click(function() {
        if ( $( window ).width() < 750 ) {
        
            
            $('.myvoc-tabs').hide();
            $('.home-black-strip').hide();
            $('.voc-hdr-img').hide();
            
            $('.voc-hdr-new').show();
            $('#summary-sub-txt').text('Summary Report');
            $('#myvoc-reportGenerate').show();
            
        } else {
            
            $('.myvoc-tabs').show();
            $('.home-black-strip').show();
            $('.voc-hdr-img').show();
            
            $('.voc-hdr-new').hide();
     //       $('#myvoc-reportGenerate').show();
        }
    });

    
    $("#summary-back").click(function() {
        $('.myvoc-tabs').show();
        $('.home-black-strip').show();
        $('.voc-hdr-img').show();
        
        $('.voc-hdr-new').hide();
        
        $('#myvoc-report-control').hide();
        $('#myvoc-reportGenerate').hide();
        
        $('#myvoc-report-control').removeClass("active");
        $('#myvoc-reportGenerate').removeClass("active");
        
        $('#myvoc-detail-control').hide();
        $('#myvoc-details').hide();
        
        $('#myvoc-detail-control').removeClass("active");
        $('#myvoc-details').removeClass("active");
        
        $('.nav-tabs.myvoc-tabs li:first-child').addClass("active");
        $('#myvoc-submitted').addClass("active");
        
    });

    $('#ThankYouPopup').hide();
    $('#Exportpopup').hide();
    $('#Emailpopup').hide();
    populateProductFamily();
    populateStatus();
    populatePurpose();
    // Datepicker
    $(function () {
        $('[id$=sFromDate]' ).datepicker();
        $('[id$=sToDate]' ).datepicker();
    });
    
    //Set drafts as active when Draft is created
    var recordType = getParameterByName('type');
    if(recordType == 'draft'){
        $('ul.myvoc-tabs li').removeClass('active');
        $('#myvoc-draft-control').addClass('active');
        $('div.tab-pane').removeClass('active');
        $('#myvoc-drafts').addClass('active');
    }
    
    //Selection of PDF or XLS report
    $('tr td input:radio[value="PDF"]').attr('checked',true);
    
    $('tr td input:radio').click(function(){
        if($(this).val() == 'XLS'){
            $('[id$=genReport]').html('Generate XLS Report');
        }else if($(this).val() == 'PDF'){
            $('[id$=genReport]').html('Generate PDF Report');
        }
    });
    
    $('input[name="reportSelectionDesk"]').click(function(){
        if($(this).val() == 'XLS'){
            $('[id$=genReport]').html('Generate XLS Report');
        }else if($(this).val() == 'PDF'){
            $('[id$=genReport]').html('Generate PDF Report');
        }
    });
    
    $( "input[name='report_btn']" ).click( function(){
        //alert($( "input:checked" ).val());
        
        if($( "input[name='report_btn']:checked" ).val() == 'pdf'){
            $( "#generateReport" ).html('Generate PDF Report');
            pdfORxls = 'pdf';
        }
        if($( "input[name='report_btn']:checked" ).val() == 'xls'){
            $( "#generateReport" ).html('Generate XLS Report');
            pdfORxls = 'xls';
        }
    });
    
    /*$('#myvoc-report-control').hide();
    $('#myvoc-detail-control').hide();
    $('#myvoc-report-control').removeClass('hidden');
    $('#myvoc-detail-control').removeClass('hidden');*/
    
    $('ul.myvoc-tabs li').click(function(){
        //alert('clicked other' + $(this).attr('id'));
        if($(this).attr('id') != 'myvoc-report-control')
            $('#myvoc-report-control').hide();
            
        if($(this).attr('id') != 'myvoc-detail-control')
            $('#myvoc-detail-control').hide();
    });
    
    $(".voc-loader-show").click(function(){
        $(".voc-loader").show();
        setTimeout(function(){$(".voc-loader").hide()}, 1000);
    
    });

    $("#myvoc-submitted-tab").click(function(){
       $("#myvoc-reportGenerate").hide();
       $("#myvoc-details").hide();
    });
    
    $("#myvoc-drafts-tab").click(function(){
        $("#myvoc-reportGenerate").hide();
        $("#myvoc-details").hide();
    });
    
    $("#myvoc-reports-tab").click(function(){
        $("#myvoc-reportGenerate").hide();
        $("#myvoc-details").hide();
    });
   
    
    
    //Summary Report
    $('#summaryReport').click(function(){
        $('ul.myvoc-tabs li').removeClass('active');
        $('#myvoc-report-control').show().addClass('active');
        $('div.tab-pane').removeClass('active');
        $('#myvoc-reportGenerate').addClass('active').show();
        
    });
    
    
    
    /*  Collapse Blocks  */
       
    //    Date Range Search
    $("#sSavedSearchesID").click( function() {
        if ( $('#s-savedsearches').hasClass("in")) {
            $('#s-savedsearches.collapse').removeClass("in");
            $('#sSavedSearchesID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-savedsearches.collapse').addClass("in");
            $('#sSavedSearchesID').addClass('panel-red');
        }
    });
    
    //    Record
    $("#sReportNumberID").click( function() {
        if ( $('#s-ReportNumber').hasClass("in")) {
            $('#s-ReportNumber.collapse').removeClass("in");
            $('#sReportNumberID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-ReportNumber.collapse').addClass("in");
            $('#sReportNumberID').addClass('panel-red');
        }
    });
    
    
    //    Sensitivity Level
    $("#sSensitivityLevelID").click( function() {
        if ( $('#s-SensitivityLevel').hasClass("in")) {
            $('#s-SensitivityLevel.collapse').removeClass("in");
            $('#sSensitivityLevelID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-SensitivityLevel.collapse').addClass("in");
            $('#sSensitivityLevelID').addClass('panel-red');
        }
    });
    
    //    Purpose
    $("#sPurposeID").click( function() {
        if ( $('#s-Purpose').hasClass("in")) {
            $('#s-Purpose.collapse').removeClass("in");
            $('#sPurposeID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-Purpose.collapse').addClass("in");
            $('#sPurposeID').addClass('panel-red');
        }
    });
    
    
     //    Current Status
    $("#sCurrentStatusID").click( function() {
        if ( $('#s-CurrentStatus').hasClass("in")) {
            $('#s-CurrentStatus.collapse').removeClass("in");
            $('#sCurrentStatusID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-CurrentStatus.collapse').addClass("in");
            $('#sCurrentStatusID').addClass('panel-red');
        }
    });
    
    //    Date Range Search
    $("#sDaterangeID").click( function() {
        if ( $('#s-daterange').hasClass("in")) {
            $('#s-daterange.collapse').removeClass("in");
            $('#sDaterangeID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-daterange.collapse').addClass("in");
            $('#sDaterangeID').addClass('panel-red');
        }
    });

    //    Customer Search
    $("#sCustnameID").click( function() {
        if ( $("#s-custname").hasClass("in")) {
            $('#s-custname.collapse').removeClass("in");
            $('#sCustnameID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");   
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-custname.collapse').addClass("in");
            $('#sCustnameID').addClass('panel-red');
        }
    });
    
    
    //    Account Search
    $("#sAccountID").click( function() {
        if ( $("#s-account").hasClass("in")) {
            $('#s-account.collapse').removeClass("in");
            $('#sAccountID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-account.collapse').addClass("in");
            $('#sAccountID').addClass('panel-red');
        }
    });
    
    //    Lead Search
    $("#sLeadID").click( function() {
        if ( $("#s-lead").hasClass("in")) {
            $('#s-lead.collapse').removeClass("in");
            $('#sLeadID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-lead.collapse').addClass("in");
            $('#sLeadID').addClass('panel-red');
        }
    });
    
    //    platform Search
    $("#sPlatformId").click( function() {
        if ( $("#s-PlatformId").hasClass("in")) {
            $('#s-PlatformId.collapse').removeClass("in");
            $('#sPlatformId').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-PlatformId.collapse').addClass("in");
            $('#sPlatformId').addClass('panel-red');
        }
    });
    
    //    Product Line Search
    $("#sProductID").click( function() {
        if ( $("#s-productline").hasClass("in")) {
            $('#s-productline.collapse').removeClass("in");
            $('#sProductID').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");   
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-productline.collapse').addClass("in");
            $('#sProductID').addClass('panel-red');
        }
    });
     
    //    VOC Title
    $("#sVOCTitleId").click( function() {
        if ( $('#s-VocTitle').hasClass("in")) {
            $('#s-VocTitle.collapse').removeClass("in");
            $('#sVOCTitleId').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-VocTitle.collapse').addClass("in");
            $('#sVOCTitleId').addClass('panel-red');
        }
    }); 
    
    //    VOC Collection
    $("#sVOCCollectionId").click( function() {
        if ( $('#s-VOCCollection').hasClass("in")) {
            $('#s-VOCCollection.collapse').removeClass("in");
            $('#sVOCCollectionId').removeClass('panel-red');
        } else {
            $('.collapse').removeClass("in");
            $('#search-accordion .panel .panel-heading').removeClass('panel-red');
            $('#s-VOCCollection.collapse').addClass("in");
            $('#sVOCCollectionId').addClass('panel-red');
        }
    });
     
        
    // Added for Report redirect 
    if(window.location.href.indexOf("success") > -1) {
        if ( $( window ).width() < 750 ) {
            $('.myvoc-tabs').hide();
            $('.home-black-strip').hide();
            $('.voc-hdr-img').hide();           
            $('.voc-hdr-new').show();
            $('#summary-sub-txt').text('Summary Report');
            $('#myvoc-reportGenerate').show();
            $('#ThankYouPopup').modal({
                show:true,
                closeOnEscape: true
            });
        } 
        else {
            $('ul.myvoc-tabs li').removeClass('active');
            $('#myvoc-report-control').show().addClass('active');
            $('div.tab-pane').removeClass('active');
            $('#myvoc-reportGenerate').addClass('active').show();
            $('#ThankYouPopup').modal({
                show:true,
                closeOnEscape: true
            }); 
        }   
    }   
});

///////////////////////////////////////Function to fetch VOC/OVOC records////////////////////////////////
var min = 0;
var size = 15;//Pagination size
var Dmin = 0;
var Dsize = 15;//Pagination size
var Allrecordnext;
var Allrecorddraft;
    
function normalizeDateExtended(mydate){
    mydate = new Date(mydate);
    data = new Date(mydate -  mydate.getTimezoneOffset() * 60000);
    var d = mydate.getDate();
    var month = mydate.getMonth()+1;
    var y = mydate.getFullYear();
    var m = '';
    switch (month) {
        case 1:
            m = 'Jan';
            break;
        case 2:
            m = 'Feb';
            break;
        case 3:
            m = 'Mar';
            break;
        case 4:
            m = 'Apr';
            break;
        case 5:
            m = 'May';
            break;
        case 6:
            m = 'Jun';
            break;
        case 7:
            m = 'Jul';
            break;
        case 8:
            m = 'Aug';
            break;
        case 9:
            m = 'Sep';
            break;
        case 10:
            m = 'Oct';
            break;
        case 11:
            m = 'Nov';
            break;
        case 12:
            m = 'Dec';
            break;    
        
    }
    return [m,d,y];
}    


    
function getOVOCRecords(status){
    $('.voc-loader').show();
    var i=0;
    var Di=0;
    var allRecords='';
    var loggedInUser = '{!$User.FirstName} {!$User.LastName}';
    var hrefForRecord = '';
    OVOC_myVOC_Controller.getMyVOCRecords(status, function(result, event) {
      if(event.type == 'exception') {
            //  alert(event.message);
            $('.voc-loader').hide();
      }else{
            //alert(result.length);
            if(status == 'Submitted'){
                Allrecordnext = result;
            }
            if(status == 'Draft') {
                Allrecorddraft = result;    
            }
            $.each(result, function(index,value){ 
                //Allrecordnext = result;    
                var cssClass = '';
                var ovoc_voc_number = '';
                
                if(value.RecordTypeId == '{!$Label.OVOC_RecType_Id}'){
                    cssClass ='myvoc-ovoc-tag';
                    ovoc_voc_number = 'OVOC-DRAFT';
                }else{
                    cssClass ='myvoc-voc-tag';
                    ovoc_voc_number = 'VOC-DRAFT';
                }
                
                var thisDate = normalizeDateExtended(value.CreatedDate);
                var month = thisDate[0];
                var date = thisDate[1];
                var year = thisDate[2];
                
                
                if(value.Status__c == 'Submitted') {
                if(i==size){
                         return;
                         $('.voc-loader').hide();
                    }
                    else {
                        var clickarea = '';
                        if ( $( window ).width() < 750 ) {
                            clickarea = '<div class="row myvoc-records" onclick="openNewTabForDetails(\''+ value.Id + '\');">'
                        }
                        else {
                            clickarea = '<div class="row myvoc-records">'
                        }
                        ovoc_voc_number = value.VOC__c;
                        hrefForRecord = '#';
                        var expid = value.Id;
                        allRecords += clickarea+ '<div class="col-xs-9 col-sm-12 col-md-12">'
                        //'<div class="row myvoc-records" onclick="openNewTabForDetails(\''+ value.Id + '\');">'
                        
                        + '<div class="col-xs-3 col-sm-1 col-md-1 myvoc-calender">'
                        + '<div class="myvoc-calender-month">' 
                        + month +'</div>'
                        + '<div class="myvoc-calender-day">'
                        + date + '</div>'
                        + '<div class="myvoc-calender-year">'
                        + year + '</div>' 
                        + '</div>' 
                        + '<div class="col-xs-9 col-sm-11 col-md-11">'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-record-head"><a onclick="openNewTabForDetails(\'' 
                        + value.Id + '\');" rel="external" target="_top">' + value.VOC_Title__c +'</a></div>'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-rec-sub-hdr">'
                        + 'By '+value.Honeywell_Lead_Formula__c + '</div>'            //loggedInUser
                        + '</div>'
                        + '</div>'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 hidden-xs myvoc-rec-desc">'
                        + value.VOC_Hypothesis__c + '</div>'
                        + '<div class="col-xs-3 col-sm-12 col-md-12">' 
                        + '<div class="col-md-1 col-sm-2 col-xs-12 myvoc-submitted-tag '+ cssClass +'">'
                        + ovoc_voc_number + '</div>'
                        + '<div class="col-md-9 col-sm-9 hidden-xs"><a href="#" class="myvoc-export-link help-link" style="margin-left: 35px;" onclick="DisplayExportPopup(\'' + expid +'\');">Export</a></div>' 
                        + '</div>'
                        + '</div>';
                        i++;
                        min = size;
                        if(min<=0) {
                            $('#idNext').hide(); 
                            $('#idPrevious').hide();
                        }
                        else {
                            $('#idNext').show();    
                        }
                        
                        $('.voc-loader').hide();
                    }     
                    

                }
                else {
                    if(Di==Dsize){
                         return;
                         $('.voc-loader').hide();
                    }
                    else {
                        hrefForRecord = '{!$Page.OVOC_Create}?id=' + value.Id;
                        var expid = value.Id;
                        allRecords += '<div class="row myvoc-records" onclick="openCreatePageDetails(\''+ value.Id + '\');">'
                        + '<div class="col-xs-9 col-sm-12 col-md-12">'
                        + '<div class="col-xs-3 col-sm-1 col-md-1 myvoc-calender">'
                        + '<div class="myvoc-calender-month">' 
                        + month +'</div>'
                        + '<div class="myvoc-calender-day">'
                        + date + '</div>'
                        + '<div class="myvoc-calender-year">'
                        + year + '</div>' 
                        + '</div>' 
                        + '<div class="col-xs-9 col-sm-11 col-md-11">'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-record-head"><a class="voc-loader-show"' 
                        + ' href="'+ hrefForRecord +'" rel="external" target="_top">' + value.VOC_Title__c +'</a></div>'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-rec-sub-hdr">'
                        + 'By '+value.Honeywell_Lead_Formula__c+ '</div>'
                        + '</div>'
                        + '</div>'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 hidden-xs myvoc-rec-desc">'
                        + value.VOC_Hypothesis__c + '</div>'
                        + '<div class="col-xs-3 col-sm-12 col-md-12">'
                        + '<a href="#" onclick="DeleteThisdraft(\'' + expid +'\');" style="float:right"><div class="btn create-btn-delete hidden-sm hidden-md hidden-lg" style="background-position: 11px 9px;"></div></a>'                         
                        + '<div class="col-md-1 col-sm-2 col-xs-12 myvoc-submitted-tag myvoc-draft-bgcolor">'
                        + ovoc_voc_number + '</div>'
                        + '<div class="col-md-9 col-sm-9 hidden-xs"><a href="#" class="myvoc-export-link help-link" style="margin-left: 35px;" onclick="DisplayExportPopup(\'' + expid +'\');">Export</a>'
                        +'<div style="float:right; width:15px; height: 18px; margin-bottom: 15px;" ><a href="#" onclick="DeleteThisdraft(\'' + expid +'\');"><div class="btn create-btn-delete" style="padding-left: 30px;"><span class="hidden-xs">Delete</span></div></a></div></div>'                                                                                                                          
                        + '</div>'
                        + '</div>';
                        Di++;
                        Dmin = Dsize;
                        if(Dmin<=0) {
                            $('#idNext').hide(); 
                            $('#idPrevious').hide();
                        }
                        else {
                            $('#idNext').show();    
                        }
                        
                       $('.voc-loader').hide();
                    }              
                }
                
           });
           
           if(status == 'Submitted') {
               if(allRecords.length > 0) {
                   $('#myvoc-submitted').html(allRecords); //#myvoc-submitted
                    if(result.length > 15) {
                        buttondisplay = '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="float:right; margin-top: 10px;">'
//                                        + '<input type="button"  href="#" id="idNext" style="width:100px; float:right; margin-bottom:15px" class="btn gray-btn" value="Next" onclick="getNextResults()" style="float:right"/>'
                                            + '<input type="button"  href="#" id="idNext" style="width:100px; float:right; margin-bottom:15px" class="btn gray-btn" value="Next" onclick="CallNextTimeout()" style="float:right"/>'
                                        + '</div>';
                        $('#myvoc-submitted').append(buttondisplay);
                    }
                    $('.voc-loader').hide();
               }
               else {
                   $('#myvoc-submitted').html('You have no active records'); 
                   $('.voc-loader').hide();
               }
           }
           else if(status == 'Draft') { 
               if(allRecords.length > 0) { 
                   $('#myvoc-drafts').html(allRecords);                 
                   if(result.length > 15) {
                        buttondisplay = '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="float:right; margin-top: 10px;">'
                                        + '<input type="button"  href="#" id="DraftidNext" style="width:100px; float:right; margin-bottom:15px" class="btn gray-btn" value="Next" onclick="CallDraftNextTimeout()" style="float:right"/>'
                                        + '</div>';
                        $('#myvoc-drafts').append(buttondisplay);
                   }
                   $('.voc-loader').hide();
               }
               else {
                    $('#myvoc-drafts').html('You have no active records');
                    $('.voc-loader').hide();
               }
           }
      }
    });
}


function openCreatePageDetails ( cPgID ) {
    
}

    function getNextResults(){
  //      $('.voc-loader').show();
        
        var buttondisplay = '';
        // Pagination control
        if(min<=0)
           $('#idPrevious').hide();
        else
           $('#idPrevious').show();
        //Display Data
        $('#myvoc-submitted').empty();
        var loggedInUser = '{!$User.FirstName} {!$User.LastName}';
        var cssClass = '';
        var ovoc_voc_number = '';
        allRecords = '';    
           
        $.each(Allrecordnext, function(index,value) {
        ovoc_voc_number = value.VOC__c;
                    hrefForRecord = '#';
                    var expid = value.Id;
                    
        var thisDate = normalizeDateExtended(value.CreatedDate);
                var month = thisDate[0];
                var date = thisDate[1];
                var year = thisDate[2];
        if(value.RecordTypeId == '{!$Label.OVOC_RecType_Id}'){
                    cssClass ='myvoc-ovoc-tag';
                    ovoc_voc_number = value.VOC__c;
                }else{
                    cssClass ='myvoc-voc-tag';
                    ovoc_voc_number = value.VOC__c;
                }
                    if(index >= min && index<min+size){                    
                        allRecords += '<div class="row myvoc-records" onclick="openNewTabForDetails(\''+ value.Id + '\');">'
                        + '<div class="col-xs-9 col-sm-12 col-md-12">'
                        + '<div class="col-xs-3 col-sm-1 col-md-1 myvoc-calender">'
                        + '<div class="myvoc-calender-month">' 
                        + month +'</div>'
                        + '<div class="myvoc-calender-day">'
                        + date + '</div>'
                        + '<div class="myvoc-calender-year">'
                        + year + '</div>' 
                        + '</div>' 
                        + '<div class="col-xs-9 col-sm-11 col-md-11">'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-record-head"><a onclick="openNewTabForDetails(\'' 
                        + value.Id + '\');" rel="external" target="_top">' + value.VOC_Title__c +'</a></div>'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-rec-sub-hdr">'
                        + 'By '+value.Honeywell_Lead_Formula__c+ '</div>'
                        + '</div>'
                        + '</div>'
                        + '<div class="col-xs-12 col-sm-12 col-md-12 hidden-xs myvoc-rec-desc">'
                        + value.VOC_Hypothesis__c + '</div>'
                        + '<div class="col-xs-3 col-sm-12 col-md-12">' 
                        + '<div class="col-md-1 col-sm-1 col-xs-12 myvoc-submitted-tag '+ cssClass +'">'    
                        + ovoc_voc_number + '</div>'
                        + '<div class="col-md-9 col-sm-9 hidden-xs"><a href="#" class="myvoc-export-link help-link" style="margin-left: 35px;" onclick="DisplayExportPopup(\'' + expid +'\');">Export</a></div>' 
                        + '</div>'
                        + '</div>';                            
                    }  
                    $('#myvoc-submitted').html(allRecords); //myvoc-submitted
                   
               // else
               // return;                        
       });
           buttondisplay = '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="margin-top: 10px;">'
                            + '<input type="button"  href="#" style="width:100px; margin-bottom:15px" id="idPrevious" class="btn gray-btn" value="Previous" onclick="CallPreviousTimeout()"/>'
                            + '</div>'   
                            + '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="float:right; margin-top: 10px;">'
//                            + '<input type="button"  href="#" style="width:100px; float:right; margin-bottom:15px" id="idNext" class="btn gray-btn" value="Next" onclick="getNextResults()" style="float:right"/>'
                            + '<input type="button"  href="#" style="width:100px; float:right; margin-bottom:15px" id="idNext" class="btn gray-btn" value="Next" onclick="CallNextTimeout()" style="float:right"/>'
                            + '</div>';
           $('#myvoc-submitted').append(buttondisplay);
           min = min + size;
           if(Allrecordnext.length <= min) {
               $('#idNext').hide();
           }
           
            $('.voc-loader').hide();

    }
    
    function CallNextTimeout() {    // For all Submited NEXT buttons
        $(".voc-loader").show();
        setTimeout(function(){ getNextResults() }, 100);
    }
    
    function CallPreviousTimeout() {    // For all Submited PREVIOUS buttons
        $(".voc-loader").show();
        setTimeout(function(){ getPreviousResults() }, 100);
    }
    
    function CallDraftNextTimeout() {    // For all Draft NEXT buttons
        $(".voc-loader").show();
        setTimeout(function(){ DraftgetNextResults() }, 100);
    }
    
    function CallDraftPreviousTimeout() {    // For all Draft PREVIOUS buttons
        $(".voc-loader").show();
        setTimeout(function(){ DraftgetPreviousResults() }, 100);
    }
    
        function DraftgetNextResults() {
             $('.voc-loader').show();
        var Draftbuttondisplay = '';
        // Pagination control
        if(Dmin<=0)
           $('#DraftidPrevious').hide();
        else
           $('#DraftidPrevious').show();
        //Display Data
        $('#myvoc-drafts').empty();
        var loggedInUser = '{!$User.FirstName} {!$User.LastName}';
        var cssClass = '';
        var ovoc_voc_number = '';
        allRecords = '';       
        $.each(Allrecorddraft, function(index,value) {
        ovoc_voc_number = value.VOC__c;
                    hrefForRecord = '#';
                    var expid = value.Id;
                    
        var thisDate = normalizeDateExtended(value.CreatedDate);
                var month = thisDate[0];
                var date = thisDate[1];
                var year = thisDate[2];
        if(value.RecordTypeId == '{!$Label.OVOC_RecType_Id}'){
                    cssClass ='myvoc-ovoc-tag';
                    ovoc_voc_number = value.VOC__c;
        }
        else {
            cssClass ='myvoc-voc-tag';
            ovoc_voc_number = value.VOC__c;
        }
            if(index >= Dmin && index<Dmin+Dsize){                    
                hrefForRecord = '{!$Page.OVOC_Create}?id=' + value.Id;
                var expid = value.Id;
                allRecords += '<div class="row myvoc-records" onclick="openCreatePageDetails(\''+ value.Id + '\');">'
                + '<div class="col-xs-9 col-sm-12 col-md-12">'
                + '<div class="col-xs-3 col-sm-1 col-md-1 myvoc-calender">'
                + '<div class="myvoc-calender-month">' 
                + month +'</div>'
                + '<div class="myvoc-calender-day">'
                + date + '</div>'
                + '<div class="myvoc-calender-year">'
                + year + '</div>' 
                + '</div>' 
                + '<div class="col-xs-9 col-sm-11 col-md-11">'
                + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-record-head"><a class="voc-loader-show"' 
                + ' href="'+ hrefForRecord +'" rel="external" target="_top">' + value.VOC_Title__c +'</a></div>'
                + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-rec-sub-hdr">'
                + 'By '+value.Honeywell_Lead_Formula__c+ '</div>'
                + '</div>'
                + '</div>'
                + '<div class="col-xs-12 col-sm-12 col-md-12 hidden-xs myvoc-rec-desc">'
                + value.VOC_Hypothesis__c + '</div>'
                + '<div class="col-xs-3 col-sm-12 col-md-12">'
                + '<a href="#" onclick="DeleteThisdraft(\'' + expid +'\');" style="float:right"><div class="btn create-btn-delete hidden-sm hidden-md hidden-lg" style="background-position: 11px 9px;"></div></a>'                 
                + '<div class="col-md-1 col-sm-2 col-xs-12 myvoc-submitted-tag myvoc-draft-bgcolor">'
                + ovoc_voc_number + '</div>'
                + '<div class="col-md-9 col-sm-9 hidden-xs"><a href="#" class="myvoc-export-link help-link" style="margin-left: 35px;" onclick="DisplayExportPopup(\'' + expid +'\');">Export</a>'
                +'<div style="float:right; width:15px; height: 18px; margin-bottom: 15px;" ><a href="#" onclick="DeleteThisdraft(\'' + expid +'\');"><div class="btn create-btn-delete" style="padding-left: 30px;"><span class="hidden-xs">Delete</span></div></a></div></div>'                                                                                                                  
                + '</div>'
                + '</div>';                          
            }  
            $('#myvoc-drafts').html(allRecords); //myvoc-draft                       
       });
           Draftbuttondisplay = '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="margin-top: 10px;">'
                            + '<input type="button"  href="#" style="width:100px; margin-bottom:15px" id="DraftidPrevious" class="btn gray-btn" value="Previous" onclick="CallDraftPreviousTimeout()"/>'
                            + '</div>'   
                            + '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="float:right; margin-top: 10px;">'
                            + '<input type="button"  href="#" style="width:100px; float:right; margin-bottom:15px" id="DraftidNext" class="btn gray-btn" value="Next" onclick="CallDraftNextTimeout()" style="float:right"/>'
                            + '</div>';
           $('#myvoc-drafts').append(Draftbuttondisplay);
           Dmin = Dmin + Dsize;
           if(Allrecorddraft.length <= Dmin) {
               $('#DraftidNext').hide();
           }
         $('.voc-loader').hide();
    }
    
    function navigateToDraft() {
        $('.voc-loader').show();
    }
    
    
    function getPreviousResults(){
         $('.voc-loader').show();
        // Pagination control 
            if(min<=0)
                $('#idPrevious').hide();
            else
                $('#idPrevious').show();
        //Display Data
        $('#myvoc-submitted').empty();
        var loggedInUser = '{!$User.FirstName} {!$User.LastName}';
        var cssClass = '';
        var ovoc_voc_number = '';
        allRecords = '';
                $.each(Allrecordnext, function(index,value) {
        ovoc_voc_number = value.VOC__c;
                    hrefForRecord = '#';
                    var expid = value.Id;
                    
        var thisDate = normalizeDateExtended(value.CreatedDate);
                var month = thisDate[0];
                var date = thisDate[1];
                var year = thisDate[2];
        if(value.RecordTypeId == '{!$Label.OVOC_RecType_Id}'){
                    cssClass ='myvoc-ovoc-tag';
                    ovoc_voc_number = value.VOC__c;
                }else{
                    cssClass ='myvoc-voc-tag';
                    ovoc_voc_number = value.VOC__c;
                }
                 if(index>=min-size-size && index<min-size){
                    allRecords += '<div class="row myvoc-records" onclick="openNewTabForDetails(\'' + value.Id + '\');">'
                    + '<div class="col-xs-9 col-sm-12 col-md-12">'
                    + '<div class="col-xs-3 col-sm-1 col-md-1 myvoc-calender">'
                    + '<div class="myvoc-calender-month">' 
                    + month +'</div>'
                    + '<div class="myvoc-calender-day">'
                    + date + '</div>'
                    + '<div class="myvoc-calender-year">'
                    + year + '</div>' 
                    + '</div>' 
                    + '<div class="col-xs-9 col-sm-11 col-md-11">'
                    + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-record-head"><a onclick="openNewTabForDetails(\'' 
                    + value.Id + '\');" rel="external" target="_top">' + value.VOC_Title__c +'</a></div>'
                    + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-rec-sub-hdr">'
                    + 'By '+value.Honeywell_Lead_Formula__c+ '</div>'
                    + '</div>'
                    + '</div>'
                    + '<div class="col-xs-12 col-sm-12 col-md-12 hidden-xs myvoc-rec-desc">'
                    + value.VOC_Hypothesis__c + '</div>'
                    + '<div class="col-xs-3 col-sm-12 col-md-12">' 
                    + '<div class="col-md-1 col-sm-1 col-xs-12 myvoc-submitted-tag '+ cssClass +'">'
                    + ovoc_voc_number + '</div>'
                    + '<div class="col-md-9 col-sm-9 hidden-xs"><a href="#" class="myvoc-export-link help-link" style="margin-left: 35px;" onclick="DisplayExportPopup(\'' + expid +'\');">Export</a></div>' 
                    + '</div>'
                    + '</div>';                             
                    }  
                    $('#myvoc-submitted').html(allRecords);   //myvoc-submitted              
       });
           buttondisplay = '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="margin-top: 10px;">'
                            + '<input type="button"  href="#" id="idPrevious" style="width:100px; margin-bottom:15px" class="btn gray-btn" value="Previous" onclick="CallPreviousTimeout()"/>'
                            + '</div>'   
                            + '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="float:right; margin-top: 10px;">'
//                            + '<input type="button"  href="#" id="idNext" style="width:100px; float:right; margin-bottom:15px" class="btn gray-btn" value="Next" onclick="getNextResults()" style="float:right"/>'
                            + '<input type="button"  href="#" id="idNext" style="width:100px; float:right; margin-bottom:15px" class="btn gray-btn" value="Next" onclick="CallNextTimeout()" style="float:right"/>'
                            + '</div>';
            $('#myvoc-submitted').append(buttondisplay);
           min = min - size;           
           // Pagination control
           if(min<=size)
               $('#idPrevious').hide();
           if(Allrecordnext.length > size)
               $('#idNext').show();
               
      $('.voc-loader').hide();
    }


    function DraftgetPreviousResults() {
         $('.voc-loader').show();
    var Draftbuttondisplay;
        // Pagination control 
            if(Dmin<=0)
                $('#DraftidPrevious').hide();
            else
                $('#DraftidPrevious').show();
        //Display Data
        $('#myvoc-drafts').empty();
        var loggedInUser = '{!$User.FirstName} {!$User.LastName}';
        var cssClass = '';
        var ovoc_voc_number = '';
        allRecords = '';
                $.each(Allrecorddraft, function(index,value) {
        ovoc_voc_number = value.VOC__c;
                    hrefForRecord = '#';
                    var expid = value.Id;
                    
        var thisDate = normalizeDateExtended(value.CreatedDate);
                var month = thisDate[0];
                var date = thisDate[1];
                var year = thisDate[2];
        if(value.RecordTypeId == '{!$Label.OVOC_RecType_Id}') {
                    cssClass ='myvoc-ovoc-tag';
                    ovoc_voc_number = 'OVOC-DRAFT';
                }else{
                    cssClass ='myvoc-voc-tag';
                    ovoc_voc_number = 'VOC-DRAFT';
                }
                 if(index>=Dmin-Dsize-Dsize && index<Dmin-Dsize){
                    hrefForRecord = '{!$Page.OVOC_Create}?id=' + value.Id;
                    var expid = value.Id;
                    allRecords += '<div class="row myvoc-records" onclick="openCreatePageDetails(\''+ value.Id + '\');">'
                    + '<div class="col-xs-9 col-sm-12 col-md-12">'
                    + '<div class="col-xs-3 col-sm-1 col-md-1 myvoc-calender">'
                    + '<div class="myvoc-calender-month">' 
                    + month +'</div>'
                    + '<div class="myvoc-calender-day">'
                    + date + '</div>'
                    + '<div class="myvoc-calender-year">'
                    + year + '</div>' 
                    + '</div>' 
                    + '<div class="col-xs-9 col-sm-11 col-md-11">'
                    + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-record-head"><a class="voc-loader-show"' 
                    + ' href="'+ hrefForRecord +'" rel="external" target="_top">' + value.VOC_Title__c +'</a></div>'
                    + '<div class="col-xs-12 col-sm-12 col-md-12 myvoc-rec-sub-hdr">'
                    + 'By '+value.Honeywell_Lead_Formula__c+ '</div>'
                    + '</div>'
                    + '</div>'
                    + '<div class="col-xs-12 col-sm-12 col-md-12 hidden-xs myvoc-rec-desc">'
                    + value.VOC_Hypothesis__c + '</div>'
                    + '<div class="col-xs-3 col-sm-12 col-md-12">' 
                    + '<a href="#" onclick="DeleteThisdraft(\'' + expid +'\');" style="float:right"><div class="btn create-btn-delete hidden-sm hidden-md hidden-lg" style="background-position: 11px 9px;"></div></a>'                    
                    + '<div class="col-md-1 col-sm-2 col-xs-12 myvoc-submitted-tag myvoc-draft-bgcolor">'
                    + ovoc_voc_number + '</div>'
                    + '<div class="col-md-9 col-sm-9 hidden-xs"><a href="#" class="myvoc-export-link help-link" style="margin-left: 35px;" onclick="DisplayExportPopup(\'' + expid +'\');">Export</a>' 
                    +'<div style="float:right; width:15px; height: 18px; margin-bottom: 15px;" ><a href="#" onclick="DeleteThisdraft(\'' + expid +'\');"><div class="btn create-btn-delete" style="padding-left: 30px;"><span class="hidden-xs">Delete</span></div></a></div></div>'                                                                                                                     
                    + '</div>'
                    + '</div>';                          
                    }  
                    $('#myvoc-drafts').html(allRecords);   //myvoc-drafts
                    });                
           Draftbuttondisplay = '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="margin-top: 10px;">'
                            + '<input type="button"  href="#" id="DraftidPrevious" style="width:100px; margin-bottom:15px" class="btn gray-btn" value="Previous" onclick="CallDraftPreviousTimeout()"/>'
                            + '</div>'   
                            + '<div class="col-xs-6 col-sm-6 col-md-6 col-md-offset-0" style="float:right; margin-top: 10px;">'
                            + '<input type="button"  href="#" id="DraftidNext" style="width:100px; float:right; margin-bottom:15px" class="btn gray-btn" value="Next" onclick="CallDraftNextTimeout()" style="float:right"/>'
                            + '</div>';
            $('#myvoc-drafts').append(Draftbuttondisplay);
           Dmin = Dmin - Dsize;           
           // Pagination control
           if(Dmin<=Dsize)
               $('#DraftidPrevious').hide();
           if(Allrecorddraft.length > Dsize)
               $('#DraftidNext').show();
               
        $('.voc-loader').hide();    
           
    }




///////////////////////////////////////Export Functionality begins///////////////////////////////////////

function DisplayExportPopup(expid) {     
        var excelLink = '/apex/VOC_ExportToExcel?id=';
        var popupExportLink = '<a href="#" data-dismiss="modal" class="myvoc-export-link help-link" onclick="ExportPopupexcel(\'' + expid +'\');">Export to Excel</a>';
        var popupEmailLink = '<a href="#" data-dismiss="modal" class="myvoc-export-link help-link" onclick="ExportPopupemailshow(\'' + expid +'\');"">Send via Email</a>';
        $('#exportexcel').html(popupExportLink);
        $('#exportemail').html(popupEmailLink);       
        $('#Exportpopup').modal({
            show:true,
            closeOnEscape: true
        }); 
    } 
    
    function ExportPopupexcel(expid) {
        window.open('/apex/VOC_ExportToExcel?id='+expid,'_blank',height=20,width=20);        
    }
    
    function ExportPopupemailshow(expid) {
        var Okbutton =  '<a class="btn btn-default white-btn create-next-btn" type="button" data-dismiss="modal" onclick="SendMailfunction(\'' + expid +'\');">Ok</a>';
        $('#emailOkbuton').html(Okbutton);
      //  $('#Emailpopup').show(400);
      //  $('#Exportpopup').hide(400); 
        
        $('#Exportpopup').modal("hide")
        $('#Emailpopup').modal({
            show:true,
            closeOnEscape: true
        });   
    }
    
    function ExportPopupemailhide(expid) { 
        $('#Emailpopup').hide(400);
     //   $('#Exportpopup').show(400); 
        $('#Exportpopup').modal({
            show:true,
            closeOnEscape: true
        });  
    }
    
    function SendMailfunction(expid) {
        var usermail = '{!$User.email}' ;
        Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.OVOC_myVOC_Controller.sendPdf}',
              expid,usermail,
              function(result, event){
                  if(event.type == 'exception') {
                   //   alert(event.message);
                  } 
                  else {           
                     // $('#Emailpopup').hide(400);  
                    //  $('#ThankYouPopup').show(400); 
                      
                      $('#Emailpopup').modal("hide"); 
                      $('#ThankYouPopup').modal({
                          show:true,
                          closeOnEscape: true
                      });   
                  }             
              });       
    }
    
    function ThankYoupopupHide() {
         $('#ThankYouPopup').hide();
    }
    function HideExportPopup() {
        $('#Exportpopup').hide(400);
    }

///////////////////////////////////////Export Functionality ends///////////////////////////////////////

///////////////////////////////////////Function to fetch VOC/OVOC records////////////////////////////////

////////////////////////////Details//////////////////////

function openNewTabForDetails(recId){
    $('.voc-loader').show();
    $('ul.myvoc-tabs li').removeClass('active');
    $('#myvoc-detail-control').show().addClass('active');
    $('div.tab-pane').removeClass('active');
    $('#myvoc-details').addClass('active').show();
    getPouplateForDeatils(recId);
   
    if ( $( window ).width() < 750 ) {
        
       
        $('.myvoc-tabs').hide();
        $('.home-black-strip').hide();
        $('.voc-hdr-img').hide();
        
        $('.voc-hdr-new').show();
        $('#summary-sub-txt').text('VOC');
        $('#myvoc-details').show();
        
    } else {
      
        $('.myvoc-tabs').show();
        $('.home-black-strip').show();
        $('.voc-hdr-img').show();
        
        $('.voc-hdr-new').hide();
 //       $('#myvoc-details').show();
    }
}




function getPouplateForDeatils(recordId) {
    
    
    
    var vocRecord;
    var Expbtn_mob = '';
    if(recordId != ''){
                   
        draftRecordId = recordId;
        
        var vocRecord;
        OVOC_myVOC_Controller.getMyVOCDetails( recordId, function(result, event){
            if(event.type == 'exception') {
              //  alert(event.message);
              $('.voc-loader').hide();
            }else{
                
                
                if(result.VOC_Title__c != null){
                    $('#title').html(convertToHtml(result.VOC_Title__c));
                    
                }    
                if(result.VOC_Hypothesis__c != null){
                    $('#hypothesis').html(convertToHtml(result.VOC_Hypothesis__c));
                    $('#hypothesis_mob').html(convertToHtml(result.VOC_Hypothesis__c));
                }else{
                    $('#hypothesis').html('');
                    $('#hypothesis_mob').html('');
                }    
                    
                if(result.Key_Takeaways1__c != null){
                    $('#keyTakeaways').html(convertToHtml(result.Key_Takeaways1__c));
                    $('#keyTakeaways_mob').html(convertToHtml(result.Key_Takeaways1__c));
                }else{
                    $('#keyTakeaways').html('');
                    $('#keyTakeaways_mob').html('');
                }
                
                if(result.Financial_Implications__c != null){
                    $('#financialImplications').html(convertToHtml(result.Financial_Implications__c));
                    $('#financialImplications_mob').html(convertToHtml(result.Financial_Implications__c));
                }else{
                    $('#financialImplications').html('');
                    $('#financialImplications_mob').html('');
                }
                    
                if(result.Key_Action_Items__c != null){
                    $('#keyActions').html(convertToHtml(result.Key_Action_Items__c));
                    $('#keyActions_mob').html(convertToHtml(result.Key_Action_Items__c));
                }else{
                    $('#keyActions').html('');
                    $('#keyActions_mob').html('');
                }   
                 
                if(result.Purpose_of_this_VOC__c != null){
                    $('#purposeOfVOC').html(convertToHtml(result.Purpose_of_this_VOC__c));
                    $('#purpose_mob').html(' '+convertToHtml(result.Purpose_of_this_VOC__c));
                }else{
                    $('#purposeOfVOC').html('');
                    $('#purpose_mob').html('');
                }    
                    
                if( result.Product_Name__c != null){
                    $('#prodName').html(convertToHtml(result.Product_Name__c));
                }else{
                    $('#prodName').html('');
                }    
                    
                if(result.Product_Family__c != null){
                    $('#prodFamily').html(convertToHtml(result.Product_Family__c));
                    $('#prodFamily_mob').html(' '+ convertToHtml(result.Product_Family__c));
                }else{
                    $('#prodFamily').html('');
                    $('#prodFamily_mob').html('');
                } 
                 
                if(result.Sensitive__c!= null){
                    if(result.Sensitive__c == true){
                        $('#senInfo_mob').attr('checked',true);
                    }
                }  
                if(result.Honeywell_Lead__c != null){
                    $('#honLead_mob').html(' '+ convertToHtml(result.Honeywell_Lead__c));
                }else{
                    $('#honLead_mob').html('');
                } 
                if(result.Platform_Formula__c != ''){
                    $('#platform').html(convertToHtml(result.Platform_Formula__c));
                }else{
                    $('#platform').html('');
                }    
                if(result.CreatedBy != null){
                    $('#submittedBy').html('By ' + convertToHtml(result.Honeywell_Lead_Formula__c));    //CreatedBy.Name
                }    
                if(result.VOC_Customer_Names__r != null){
                    var listCustomers = '';
                    var i = 1;
                    var allAccounts = '';
                    $.each(result.VOC_Customer_Names__r, function(index, value){
                        var vocAccountName = '';
                        if(value.VOC_Account__r != null)
                            vocAccountName = convertToHtml(value.VOC_Account__r.Name);       
                            allAccounts += vocAccountName + ',';
                        listCustomers += '<tr><td>' + i + '</td><td>'
                                        + convertToHtml(value.Customer_Name__c) + '</td><td>'
                                        + convertToHtml(value.Customer_s_Title_Role__c)  + '</td><td>'
                                        + value.Primary_Customer_s_Email__c +'</td><td>'
                                        + vocAccountName + '</td></tr>';
                                
                        i++;           
                            
                    });
                    $('#customers').html(listCustomers);
                    $('#account_mob').html(' '+ allAccounts);
                }
                
                if(result.CreatedDate != null){
                    
                    var submittedDate = normalizeDateExtended(result.CreatedDate);
                    //alert('date' + submittedDate[1]);
                    $('#date').html(submittedDate[1]);
                    $('#month').html(submittedDate[0]);
                    $('#year').html(submittedDate[2]);
                
                }
                if(result.External_Links__c != null){
                    var Myarray = new Array();
                    Myarray = result.External_Links__c.split(',');
                    //var newstring = result.External_Links__c.replace(";"," ");
            //        alert(Myarray); 
                    var linklist = ''; 
                    $.each(Myarray, function(index,value) {
                        //alert(value);
                        linklist += '<a class="help-link" style="word-wrap: break-word;" target="_blank" href="' + value + '">' + value + '</a><br/>';
                        $('#ExternalLinks').html(linklist);
                        $('#ExternalLinks').removeClass('hidden');
                        
                    }); 
                    $('#additionalAllLinks_mob').html(linklist);     
                }else{
                    $('#ExternalLinks').html('');
                    $('#ExternalLinks').removeClass('hidden');
                    $('#additionalAllLinks_mob').html('');     
                }
                
                
                if(result.Attachments != null){
                    var linkForFile ='';
                    $.each(result.Attachments, function(index, value){
                    
                        var att_valueId = value.Id;
                       
                        linkForFile += '<a target="_blank" class="help-link" href="/servlet/servlet.FileDownload?file=' + value.Id +'">' + value.Name + '</a><br/>';
                    //    linkForFile += '<a  onclick="openAttachedFile(' + att_valueId + ' )">' + value.Name + '</a><br/>';
                    });
                
                    $('#attachmentNameLink').html(linkForFile);
                    $('#attachmentNameLink').removeClass('hidden');
                    //alert(linkForFile);
                    $('#attachmentList_mob').html(linkForFile);
                }else{
                    $('#attachmentNameLink').html('');
                    //$('#attachmentNameLink').removeClass('hidden');
                    //alert(linkForFile);
                    $('#attachmentList_mob').html('');
                }
                
                $('#myvoc-details-tab').html(result.VOC__c);
                $('#summary-sub-txt').html(result.VOC__c);
                
                
                if(recordId != ''){
                    vocRecordDetailsId = recordId;
                }else{
                    vocRecordDetailsId = '';
                }
            }
            
            Expbtn_mob = '<a class="btn gray-btn export-btn-cls" onclick="DisplayExportPopup(\'' + result.Id +'\');">Export</a>';
            $('#detailExportBtn_Mob').html(Expbtn_mob);
            $('.voc-loader').hide();
        });
    }
 //   $('.voc-loader').hide();
}
////////////////////////////Details//////////////////////

//////////////////////// Populate Product Family Start //////////////////////////////////////////   
   
   function populateProductFamily() {
       var listProductFamily = '';
       var productFamily = '';
       OVOC_myVOC_Controller.getProductLine(function(result, event){
       if(event.type == 'exception') {
           //  alert(event.message);
       } 
       else {            
           listProductFamily = result;
           if(listProductFamily != null){
               $.each(listProductFamily , function(index, value){
                   productFamily += '<div class="col-xs-12 col-sm-12 col-md-12"><input type="checkbox" value="' + value +'"><span>' + value + '</span></input></div>';
               });
               $('#ProductFamilyselect').html(productFamily);
           }          
       }
      });
   } 
   
   function getProductValues(){
        var product='';
        
       // alert($('#ProductFamilyselect input:checked').length);
        $('#ProductFamilyselect input:checked').each(function(){
                product += $(this).val() + ';';
        });
        return product;
    }

//////////////////////// Populate Product Family End //////////////////////////////////////////


//////////////////////// Populate Status Start //////////////////////////////////////////   
   
   function populateStatus() {
       var listStatus = '';
       var status = '';
       OVOC_myVOC_Controller.getStatus(function(result, event){
       if(event.type == 'exception') {
           //  alert(event.message);
       } 
       else {            
           listStatus = result;
           if(listStatus != null){
               $.each(listStatus , function(index, value){
                   if (value == 'Submitted') {
                       value= 'Complete';
                   }
                   status += '<div class="create-inp-rows col-xs-12 col-sm-5 col-md-5 col-lg-5"><option value="'+value+'">'+value+'</option></div>';
               });
               $('#currentstatusList').html(status);
           }          
       }
      });
   } 

//////////////////////// Populate Status End //////////////////////////////////////////


//////////////////////// Populate Purpose Start //////////////////////////////////////////   
   
   function populatePurpose() {
       var listpurpose = '';
       var purpose = '';
       OVOC_myVOC_Controller.getPurpose(function(result, event){
       if(event.type == 'exception') {
           //  alert(event.message);
       } 
       else {            
           listpurpose = result;
           if(listpurpose != null){
               $.each(listpurpose , function(index, value){
                   if (value == 'Submitted') {
                       value= 'Complete';
                   }
                   purpose += '<div class="col-xs-12 col-sm-12 col-md-12"><input type="checkbox" value="' + value +'"><span>' + value + '</span></input></div>';
               });
               $('#PurposeOfvoc').html(purpose);
           }          
       }
      });
   } 
   
   function getPurposeValues(){
        var Purpose='';
        $('#PurposeOfvoc input:checked').each(function(){
                Purpose += $(this).val() + ';';
        });
        return Purpose;
    }

//////////////////////// Populate Purpose End //////////////////////////////////////////

////////////////////////Report Query begins/////////////////////////////////////////////

    function GetReportList() {
        var RecordNumber = document.getElementById('sReportNumber').value; 
        var CurrentStatus = document.getElementById('currentstatusList').value; 
        var SensitiveLevel = document.getElementById('SensitivityLevel').value;
        var FromDate = document.getElementById('sFromDate').value;
        var ToDate= document.getElementById('sToDate').value;
        var CustomerNameTitle = document.getElementById('sNameTitle').value; 
        var AccountName= document.getElementById('sAccount').value;
        var HonLead = document.getElementById('sLeads').value;
        var OrderByValue = document.getElementById('OrderBy').value;
        var ProductFamily = getProductValues();
        var VOCPurpose = getPurposeValues();
        //Visualforce.remoting.Manager.invokeAction(
        //    '{!$RemoteAction.OVOC_myVOC_Controller.QueryRecords}',
        OVOC_myVOC_Controller.QueryRecords(RecordNumber,CurrentStatus,SensitiveLevel,FromDate,ToDate,CustomerNameTitle,AccountName,HonLead,ProductFamily,VOCPurpose,OrderByValue,
            function(result, event) {
               // alert('aaaaaaaaaaaa');
                if(event.type == 'exception') {
                //    alert(event.message);
                } 
                else { 
                    //alert('Success');
                 //   alert(result);
                    window.open('/apex/Test_Report', 'mywin', 'height=400,width=300'); return false;
                }       
        });
    }  

////////////////////////Report Query Ends///////////////////////////////////////////////

////////////////////////Report tab Back Function Starts/////////////////////////////////
    function backbutton() {
        $('#myvoc-report-control').hide();
        $('div.tab-pane').removeClass('active');
       // $('#myvoc-submitted-control').addClass('active');   
       // $('#myvoc-submitted').addClass('active');
        $('#myvoc-rep-control').addClass('active');   
        $('#myvoc-reports').addClass('active');
    }

////////////////////////Report tab Back Function Starts/////////////////////////////////

    function resetbutton() {
    
        window.scrollTo(0,0);
    
        $('[id$=genReport]').html('Generate PDF Report');
        $('#s-productline.collapse').removeClass("in");
        $('#sProductID').removeClass('panel-red');
        $('#s-Purpose.collapse').removeClass("in");
        $('#sPurposeID').removeClass('panel-red');
        $('#s-lead.collapse').removeClass("in");
        $('#sLeadID').removeClass('panel-red');
        $('#s-account.collapse').removeClass("in");
        $('#sAccountID').removeClass('panel-red');
        $('#s-custname.collapse').removeClass("in");
        $('#sCustnameID').removeClass('panel-red');
        $('#s-daterange.collapse').removeClass("in");
        $('#sDaterangeID').removeClass('panel-red');
        $('#s-SensitivityLevel.collapse').removeClass("in");
        $('#sSensitivityLevelID').removeClass('panel-red');
        $('#s-CurrentStatus.collapse').removeClass("in");
        $('#sCurrentStatusID').removeClass('panel-red');
        $('#s-ReportNumber.collapse').removeClass("in");
        $('#sReportNumberID').removeClass('panel-red');
        $('#s-VocTitle.collapse').removeClass("in");
        $('#sVOCTitleId').removeClass('panel-red');
    }
////////////////////////Send Report Email Function Starts/////////////////////////////////    
    function SendReporMailPopup() {
        $('#ReportEmailpopup').modal({
          show:true,
          closeOnEscape: true
        });     
    }
    function ReportEmailpopuphide() {
        $('#ReportEmailpopup').modal("hide");   
    }
////////////////////////Send Report Email Function Starts/////////////////////////////////

////////////////////////Delete Draft Begins///////////////////////////////////////////////
    function DeleteThisdraft(expid) {         
        $('#deletedraftconfirm').modal({
            show:true,
            closeOnEscape: true
        });
        var okbutton = '<a class="btn btn-default white-btn create-next-btn" onclick="DeleteDraftfinal(\'' + expid +'\')" type="button">Yes</a>';
        $('#deleteYesbutton').html(okbutton);
    }
    
    function DeleteDraftfinal(expid) {   
          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.OVOC_myVOC_Controller.DeleteDraft}',
              expid,
              function(result, event){
                  if(event.type == 'exception') {
                     // alert(event.message);
                      $('#errorpanel').modal({
                        show:true,
                        closeOnEscape: true
                    }); 
                  } 
                  else {  
                      $('#deletedraftconfirm').modal("hide");         
                      $('#draftdeleted').modal({
                        show:true,
                        closeOnEscape: true
                    });    
                  }             
              });    
      }
   function deletedraftconfirmhide() {
       $('#draftdeleted').modal("hide");      
   }
   function draftdeletedPopuphide() {
       $('#draftdeleted').modal("hide");  
       getOVOCRecords('Draft');       
   }

////////////////////////Delete draft ends/////////////////////////////////////////////////
///////////////////File upload////////////////////////  
    var forcetkClient = new forcetk.Client();
    var fileUrl ='';
    var fileUploading = false;
    var fileBody;
    var fileNameText = '';
    var vocRecordDetailsId = '';
    forcetkClient.setSessionToken('{!$Api.Session_ID}');
    
    function uploadAttachment(filename, filecontent) {
        $('.voc-loader').show();
        fileBody = filecontent;
        fileNameText = filename;
        fileUploading = true;
    
        forcetkClient.create('Attachment', {
            "ParentId": vocRecordDetailsId,
            "Name": fileNameText,
            "Body": fileBody
        }, function(data) {
              
           //alert('Success! Created ContentVersion ' + data.id);
           
           if(data.id != null){
               top.location = '/apex/OVOC_MyVOC?id='+ vocRecordDetailsId; 
           }
                
        },function(error) {
                           
           if(error.statusText == "Created"){
               top.location = '/apex/OVOC_MyVOC?id='+ vocRecordDetailsId;
           }else{
               alert(JSON.stringify(error));
           }
        });
 
    }

    function fileSelected() {
        var file = document.getElementById('fileToUpload').files[0];
        
        if (file) {
            var fileSize = 0;
            if (file.size > (25 * 1024 * 1024)) {
                //alert('File too large, greater than 25MB');
                $('#fileSize_popup').modal({
                    show:true,
                    closeOnEscape: true
                });
                return;
            }
            if (file.size > 1024 * 1024)
                fileSize = (Math.round(file.size * 100 / (1024 * 1024)) / 100).toString() + 'MB';
            else
                fileSize = (Math.round(file.size * 100 / 1024) / 100).toString() + 'KB';

            //document.getElementById('fileName').innerHTML = 'File Name: ' + file.name;
            //document.getElementById('fileSize').innerHTML = 'File Size: ' + fileSize;
            //document.getElementById('fileType').innerHTML = 'File Type: ' + file.type;
            //fileName = file.Name;
        }
    }

    function uploadFile() {
 //       $('.voc-loader').show();
        var file = document.getElementById('fileToUpload').files[0];
        
        if(file == undefined){
 //           $('.voc-loader').hide();
            $('#fileSelection_popup').modal({
                show:true,
                closeOnEscape: true
            });
            
        } else {   
            if (file.size > (25 * 1024 * 1024)) {
                //alert('File too large, greater than 25MB');
                $('#fileSize_popup').modal({
                    show:true,
                    closeOnEscape: true
                });
                return;
            } 
        $('.voc-loader').show();
            setTimeout(  function() {
                var reader = new FileReader();
                reader.onload = loaded;
                //reader.onerror = errorHandler;
                reader.readAsDataURL(file); 
            } , 1000 );
        }         
    }

    function loaded(evt) {
        var filename = document.getElementById('fileToUpload').files[0].name;
        var fileContent = String(evt.target.result);
        fileContent = fileContent.substr(fileContent.indexOf(',') + 1);
        uploadAttachment(filename, fileContent);  
    }

    function errorHandler(evt) {
        if (evt.target.error.name == 'NotReadableError') {
            alert('File could not be read');
        }
        else {
            alert(evt.target.error);
        }
    }
    

///////////////////File upload////////////////////////
</script>
</body>
</html>
</apex:page>
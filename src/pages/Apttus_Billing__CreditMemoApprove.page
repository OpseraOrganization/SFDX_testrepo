<!-- 
    Apttus Billing 
    CreditMemoApprove
 
    @2013-2015 Apttus Inc. All rights reserved.
 -->
<apex:page standardController="Apttus_Billing__CreditMemo__c" extensions="Apttus_Billing.CreditMemoStatusController" showHeader="true" 
           sidebar="true" standardStylesheets="true" cache="false" tabstyle="Apttus_Billing__CreditMemo__c" >

    <apex:sectionHeader title="{!$ObjectType.Apttus_Billing__CreditMemo__c.label} {!$Label.apttus_billing__approve}"/>
    <apex:form >
        <apex:pageBlock title="" mode="create">
            <apex:messages />
	        <apex:pageBlockButtons >
	            <apex:commandButton action="{!doUpdateCreditMemoStatus}" 
	            					value="{!$Label.apttus_billing__approve}" 
	            					disabled="{!!canBeApproved}"
	            					oncomplete="calculateTaxForCreditMemo();" 
	            					status="approvalStatus" />
	            <apex:commandButton action="{!cancel}" value="{!$Label.apttus_billing__cancel}"/>
	            <apex:actionStatus id="approvalStatus" >
	               	<apex:facet name="start">
	                	<img src="{!URLFOR($Resource.Apttus_Config2__Image_LoadingIcon)}"/>  
					</apex:facet>
				</apex:actionStatus>
		    </apex:pageBlockButtons>
	    <apex:pageBlockSection id="pageMessageSection" columns="1" collapsible="false" >
                <apex:outputText value="{!pageMessage}" escape="false"/>
            </apex:pageBlockSection>
            <apex:pageBlockSection id="autoApplyCreditToInvoiceCheckboxSection" columns="1" collapsible="false" > 
	    	<apex:inputCheckbox value="{!autoApplyCreditToInvoice}" label="{!$Label.apttus_billing__autoapplycredittoinvoice}" id="idAutoApplyCreditToInvoice" selected="false" disabled="{!Apttus_Billing__CreditMemo__c.InvoiceID__r.Apttus_Billing__PaymentStatus__c == $Label.apttus_billing__paid}" />
	    </apex:pageBlockSection>
        </apex:pageBlock>
        <apex:actionFunction name="calculateTaxForCreditMemo" action="{!doCalculateTaxForCreditMemo}" />
    </apex:form>
 
</apex:page>
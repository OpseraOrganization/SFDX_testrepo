<apex:page standardController="Task" extensions="Tasks" showHeader="true" sidebar="true">
<apex:form >
<apex:sectionHeader title="My Tasks"/>
<table width="100%"><tr><td width="30%"></td>
<td width="70%">
<input value=" New Task"  class="btn" name="new" onclick="navigateToUrl('/00T/e?&retURL=/servlet/servlet.Integration?lid=01r30000001MnTi&ic=1',null,'new');" title="New" type="button" />
</td></tr></table>
<table width="100%"><tr><td width="70%"></td>
  <td width="30%">
        <apex:selectList id="chooseList" value="{!listSel}" size="1"   onchange="Refresh(this,'{!$Component.chooseList}')" > 
            <apex:selectOption itemValue="Today" itemLabel="Today"/>
            <apex:selectOption itemValue="OverDue" itemLabel="OverDue"/>
            <apex:selectOption itemValue="Today+OverDue" itemLabel="Today+OverDue"/>
            <apex:selectOption itemValue="Tomorrow" itemLabel="Tomorrow"/>
            <apex:selectOption itemValue="Next 7 days" itemLabel="Next 7 days"/>
            <apex:selectOption itemValue="Next 7 days+OverDue" itemLabel="Next 7 days+OverDue"/>
            <apex:selectOption itemValue="This Month" itemLabel="This Month"/>
            <apex:selectOption itemValue="All Open" itemLabel="All Open"/>                       
            <apex:actionFunction name="RefreshData1" action="{!RefreshData}" rerender="newId" />  
        </apex:selectList> 
        </td></tr></table>         
 <apex:pageBlock id="newId">   
     <apex:pageBlockTable width="100%" value="{!Tasks}" var="tas" >                
        <apex:column width="5%">   
         <apex:facet name="header">Action</apex:facet>
         <a href="/{!tas.id}/e?&retURL=/servlet/servlet.Integration?lid=01r30000001MnTi&ic=1">Edit</a>
        </apex:column> 
                       
       <apex:column >
         <apex:facet name="header">   
           <apex:commandLink action="{!RefreshData}" value="Subject{!IF(sortExpression=='subject',IF(sortDirection='DESC','▼','▲'),'')}" id="cmdSort">
             <apex:param value="subject" name="column" assignTo="{!sortExpression}" ></apex:param>
           </apex:commandLink>
         </apex:facet>
         <a href="/{!tas.id}?retURL=/servlet/servlet.Integration?lid=01r30000001MnTi&ic=1">{!tas.Subject}</a>
      </apex:column>
      
      <apex:column >
         <apex:facet name="header">   
           <apex:commandLink action="{!RefreshData}" value="Activity Number{!IF(sortExpression=='Activity_Number__c',IF(sortDirection='DESC','▼','▲'),'')}">
             <apex:param value="Activity_Number__c" name="column" assignTo="{!sortExpression}" ></apex:param>
           </apex:commandLink>
         </apex:facet>
         <apex:outputField value="{!tas.Activity_Number__c}"/>
        </apex:column>
      
      <apex:column >
         <apex:facet name="header">   
           <apex:commandLink action="{!RefreshData}" value="Activity Type{!IF(sortExpression=='Type',IF(sortDirection='DESC','▼','▲'),'')}">
             <apex:param value="Type" name="column" assignTo="{!sortExpression}" ></apex:param>
           </apex:commandLink>
         </apex:facet>
         <apex:outputField value="{!tas.Type}"/>
        </apex:column>
      
       <apex:column >
         <apex:facet name="header">   
           <apex:commandLink action="{!RefreshData}" value="Due Date{!IF(sortExpression=='ActivityDate',IF(sortDirection='DESC','▼','▲'),'')}">
             <apex:param value="ActivityDate" name="column" assignTo="{!sortExpression}" ></apex:param>
           </apex:commandLink>
         </apex:facet>
         <apex:outputField value="{!tas.ActivityDate}"/>
        </apex:column>
        
        <apex:column >
         <apex:facet name="header">   
           <apex:commandLink action="{!RefreshData}" value="Priority{!IF(sortExpression=='Priority',IF(sortDirection='DESC','▼','▲'),'')}">
             <apex:param value="Priority" name="column" assignTo="{!sortExpression}" ></apex:param>
           </apex:commandLink>
         </apex:facet>
         <apex:outputField value="{!tas.Priority}"/>
        </apex:column>
        
        <apex:column >
         <apex:facet name="header">   
           <apex:commandLink action="{!RefreshData}" value="Status{!IF(sortExpression=='Status',IF(sortDirection='DESC','▼','▲'),'')}">
             <apex:param value="Status" name="column" assignTo="{!sortExpression}" ></apex:param>
           </apex:commandLink>
         </apex:facet>
             <apex:outputField value="{!tas.Status}"/>
        </apex:column>
        
        <apex:column >
         <apex:facet name="header">   
           <apex:commandLink action="{!RefreshData}" value="Related To{!IF(sortExpression=='WhatId',IF(sortDirection='DESC','▼','▲'),'')}">
             <apex:param value="WhatId" name="column" assignTo="{!sortExpression}" ></apex:param>
           </apex:commandLink>
         </apex:facet>
         <apex:outputField value="{!tas.WhatId}"/>
        </apex:column>
                
        <apex:column >
         <apex:facet name="header">   
           <apex:commandLink action="{!RefreshData}" value="Comments{!IF(sortExpression=='Status',IF(sortDirection='DESC','▼','▲'),'')}">
             <apex:param value="Description" name="column" assignTo="{!sortExpression}" ></apex:param>
           </apex:commandLink>
         </apex:facet>
             <apex:outputField value="{!tas.Description}"/>
        </apex:column>
                                                                 
     </apex:pageBlockTable>  
  </apex:pageBlock>   
  </apex:form>
 <script>
        function Refresh(input,Id){       
             var doc = document.getElementById(Id).value;                       
             RefreshData1();  
        }
  </script>
</apex:page>
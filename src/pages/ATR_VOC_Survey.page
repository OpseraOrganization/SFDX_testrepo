<!-- Fix for Maintenance request need for vulnerability --> 
<apex:page cache="false" expires="10" controller="ATR_VOC" showHeader="false" standardStylesheets="false" docType="html-5.0" applyHtmlTag="false">
<!-- <apex:page cache="false" controller="ATR_VOC" showHeader="false" standardStylesheets="false" docType="html-5.0" applyHtmlTag="false"> -->
<!-- Fix for Maintenance request need for vulnerability -->
<apex:form >
<html lang="en" style="height:100%">
<head>
<meta charset="utf-8" />
<meta http-equiv="refresh" content="300" />
<title>ATR VOC Survey</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="format-detection" content="telephone=no" />
    <link href="{!URLFOR($Resource.GEResource,'css/jquery-ui.css')}" rel="stylesheet" media="screen"/>
  <!--  <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.GEResource,'/css/bootstrap.min.css')}" /> -->
<!-- Le styles-->
<link href="{!URLFOR($Resource.db_bootstrap_zip, 'css/bootstrap.css')}" rel="stylesheet" type="text/css" />
<link href="{!URLFOR($Resource.db_bootstrap_zip, 'css/bootstrap-responsive.css')}" rel="stylesheet" type="text/css" />

<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>-->
<c:lt_IE9_check />
<!--[endif]-->

<!-- Le fav and touch icons
<link rel="shortcut icon" href="ico/favicon.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="ico/apple-touch-icon-144-precomposed.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="ico/apple-touch-icon-114-precomposed.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="ico/apple-touch-icon-72-precomposed.png" />
<link rel="apple-touch-icon-precomposed" href="ico/apple-touch-icon-57-precomposed.png" />
-->
    
<!-- Header Scripts -->
    
<link href="{!URLFOR($Resource.db_bootstrap_zip, 'css/SPEXdashboard-responsive.css')}" rel="stylesheet" type="text/css" />

<style type="text/css">
.active {
    text-decoration: none;
}
.ui-menu{
height:200px !important;
overflow-y: scroll;
overflow-x: hidden;



}
.accname
{
padding-right:50px;

}




span.val {
        height: 10px;
        padding: 5px 5px !important;
        width: 20px !important;
        font-size: 75%;
        -moz-border-radius-bottomleft:20px;
    -webkit-border-bottom-left-radius:20px;
    border-bottom-left-radius:20px;
    
    -moz-border-radius-bottomright:20px;
    -webkit-border-bottom-right-radius:20px;
    border-bottom-right-radius:20px;
    
    -moz-border-radius-topright:20px;
    -webkit-border-top-right-radius:20px;
    border-top-right-radius:20px;
    
    -moz-border-radius-topleft:20px;
    -webkit-border-top-left-radius:20px;
    border-top-left-radius:20px;
        
    }
    
.table-striped td {
  font-size: 120% !important;
  font-weight: bold;
  padding-bottom: 15px;
  padding-top: 15px;
}    
    
 


.undefind{
 width: 45px;
 padding-right: 62px;
}
.hideDivision{
    display:none;
}

span.val.yellow{
color: black;
  font-weight: 100;
}



span.val.blue{
    
    border: 1px solid Lightblue;
    background: #81a8cb;
    background: -webkit-gradient(linear, left top, left bottom, from(#4477a1), to(#0000FF) );
    background: -moz-linear-gradient(-90deg, #4477a1, #81a8cb);
    filter:  progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#4477a1', endColorstr='#81a8cb');
}
  body{
    margin-top: 100px;
  }  
 #myModal1{
  width:1300px;
  height:85%;
  margin: auto;
  position:fixed;
  top:0; left:0; bottom: 0; right: 0;
}

#myModal1 .modal-body {
    overflow-y: hidden;
    padding: 5px 15px;
    max-height:100%;

}

#myModal1 .modal-body img {
    height: 100%;
    width: 100%;
}

#myModal2 {
  width:1300px;
  height:75%;
  margin: auto;
  position: fixed;
  top: 0; left: 0; bottom: 0; right: 0;
}
#myModal2 .modal-body {
    overflow-y: hidden;
    padding: 5px 15px;
    max-height:100%;

}

#myModal2 .modal-body img {
    height: 100%;
    width: 100%;
}
#myModal3{
  width:1300px;
  height:50%;
  margin: auto;
  position: fixed;
  top: 0; left: 0; bottom: 0; right: 0;
}
#myModal3 .modal-body {
    overflow-y: hidden;
    padding: 5px 15px;
    max-height:100%;

}

#myModal3 .modal-body img {
    height: 100%;
    width: 100%;
}
#myModal4{
  width:1300px;
  height:35%;
  margin: auto;
  position: fixed;
  top: 0; left: 0; bottom: 0; right: 0;
}
#myModal4 .modal-body {
    overflow-y: hidden;
    padding: 5px 15px;
    max-height:100%;

}

#myModal4 .modal-body img {
    height: 100%;
    width: 100%;
}
#myModal5{
  width:1300px;
  height:55%;
  margin: auto;
  position: fixed;
  top: 0; left: 0; bottom: 0; right: 0;
}
#myModal5 .modal-body {
    overflow-y: hidden;
    padding: 5px 15px;
    max-height:100%;

}

#myModal5 .modal-body img {
    height: 100%;
    width: 100%;
}
#myModal6{
  width:1700px;
  height:90%;
  margin: auto;
  position: fixed;
  top: 0; left: 0; bottom: 0; right: 0;
}
#myModal6 .modal-body {
    overflow-y: hidden;
    padding: 5px 15px;
    max-height:100%;

}

#myModal6 .modal-body img {
    height: 100%;
    width: 100%;
}
#myModal7{
  width:1400px;
  height:65%;
  margin: auto;
  position: fixed;
  top: 0; left: 0; bottom: 0; right: 0;
} 
#myModal7 .modal-body {
    overflow-y: hidden;
    padding: 5px 15px;
    max-height:100%;

}

#myModal7 .modal-body img {
    height: 100%;
    width: 100%;
}
a {
  color: inherit;
  text-decoration: underline;
}
</style>
</head>

<body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
      
          <div class="container-fluid " style="height: 90px;"    >
            <div class="row-fluid">
              <div class="span2" style="width:auto">
             
            <!--<a class="btn btn-large" href=""><i class="icon icon-chevron-left"></i>Home</a>-->
            <h1 style="font-weight: normal;padding-top: 8px;">ATR VOC Survey</h1>
            </div>
              <div class="span4">
               <!-- <h1 style="font-weight: normal;padding-top: 8px;">ATR VOC Survey</h1>-->
              <br></br>
                 
                 
              
             
             <!--
          
              Enter Account Name
              <apex:inputText styleClass="autocomplete" value="{!selectedAccout}"/>
             
              Select Year
              <select id="filter" onchange="StypeValue();">
              <option value="ALL" selected="">ALL</option>
                                <option value="2010">2010</option>
                                <option value="2011">2011</option>
                                <option value="2012">2012</option>
                                <option value="2013">2013</option>
                                <option value="2014">2014</option>
                                <option value="2015">2015</option>
                                <option value="2016">2016</option>
                                <option value="2017">2017</option>
                                <option value="2018">2018</option>
                                <option value="2019">2019</option>
                                <option value="2020">2020</option>
                </select>
               Select Product
              <select id="filter" onchange="StypeValue();">
              <option value="ALL" selected="">ALL</option>
                                <option value="APU">APU</option>
                                <option value="Avionics">Avionics</option>
                                <option value="Mechanical">Mechanical</option>
                                
                              
                </select>-->
            
             </div>
             
                
             
             <!--gfgfdgdfgvdfdfdfdfdfdfdfdfdfh-->
             
             <!--sdfsdsdgsdfsdfswfrwerwerwerw-->
              <!--<p class="navbar-text pull-right">-->
                <!--<span class="last_updated pull-left">Last Updated: {!dtRefreshTime}&nbsp;MST</span>-->
                <!--<a class="btn btn-large pull-right" data-target="#myModal" data-toggle="modal"><i class="icon icon-info-sign"></i> Legend</a>
              </p>--><!-- INC000006348765 - commented to hide Legend button-->
              
              <!-- INC000006348765 - Countdown for IES Starts-->
              <div class="navbar-text pull-right">
               <!-- <h1 style="font-weight: normal; padding-top: 8px; display: block; float: left; padding-right: 30px;">
                    <span id="eisDaysLeft">0</span> Days to Goal<small id="eisDate" style="display:inline"></small>
                </h1>-->
                
                <a data-toggle="modal" data-target="#myModal" class="btn btn-large pull-right">
                    <i class="icon icon-info-sign"></i> Legend
                </a>
            
              </div>
              <!-- INC000006348765 - Countdown for IES Ends-->
             
            </div>
<div class="row-fluid">           
                <span style="padding-right:50px;">Enter Account Name
            <!-- <apex:inputText id="viewacc" onblur="document.getElementById('filter1').value = this.value;" style="height:2px overflow-y: scroll; " styleClass="autocomplete" value="{!selectedAccout}" /> 
            
            <input type="hidden" id="filter1" onchange="alert(document.getElementById('filter1').value);" />
            --><input type="text" class="form-control" style="width: 360px;" id="idCompany" placeholder="Account Name" onkeypress="getDataForAutoComplete('idCompany', 'idCompanyId', 'Account')"/>
                <input type="hidden" class="form-control" id="idCompanyId" />
            
            <button type="button" style=" margin-bottom: 7px;height: 28px;" onclick="StypeValue()">Go</button>
            <!-- <input type="Text" style="height:2px overflow-y: scroll; " styleClass="autocomplete" id="AccName"/> -->
            </span>
              
             <span style="padding-right: 30px;">
              Select Year
              <select id="filter2" onchange="StypeValue();" style="width: 90px;height: 27px;margin-bottom: 4px;">
              <option value="ALL" selected="">ALL</option>
                                <option value="2010">2010</option>
                                <option value="2011">2011</option>
                                <option value="2012">2012</option>
                                <option value="2013">2013</option>
                                <option value="2014">2014</option>
                                <option value="2015">2015</option>
                                <option value="2016">2016</option>
                                <option value="2017">2017</option>
                                <option value="2018">2018</option>
                                <option value="2019">2019</option>
                                <option value="2020">2020</option>
                </select>
                </span>
                <span style="padding-right: 30px;">Filter by Survey Type 
              
              <select id="filter" onchange="StypeValue();" style="width: 90px;height: 27px;margin-bottom: 4px;">
              <option value="ALL" selected="">ALL</option>
                                <option value="Airbus">Airbus</option>
                                <option value="Boeing">Boeing</option>
                                <option value="GE">GE</option>
                                <option value="NSS">NSS</option>
                                <option value="HOS">HOS</option>
                </select>                
                </span>
                Select Product
              <select id="filter3" onchange="StypeValue();" style="width: 90px;height: 27px;margin-bottom: 4px;">
              <option value="ALL" selected="">ALL</option>
                                <option value="APU">APU</option>
                                <option value="Avionics">Avionics</option>
                                <option value="Mechanical">Mechanical</option>
                                
                              
                </select>
               
    </div>
          
       </div>
       </div>
       </div>
       
    
      
<div class="container-fluid"> 
 <!-- <div> 
  <span style="position: fixed;background-color: #576F79;" >
  <div>fffffff</div>
   
    Filter by Survey Type
              <select id="filter" onchange="StypeValue();" style="width: 90px;height: 25px;">
              <option value="ALL" selected="">ALL</option>
                                <option value="Airbus">Airbus</option>
                                <option value="Boeing">Boeing</option>
                                <option value="GE">GE</option>
                                <option value="NSS">NSS</option>
                                <option value="HOS">HOS</option>
                </select>
   
   </span>
   </div> -->
   <span></span>
    <div class="row-fluid">
    
      
      <div class="span12">
          
            <div id="ShowAvgDiv" class="hideDivision" style="width:1450px; height:auto; float:left; margin-top:30px;">
                <p style="float:left;">
                    <span >Average for the Survey Type</span>
                    <span id="rav" class="val grey" style=" width: 3px; height: 19px; margin-left:419px;"></span>
                   <!-- <span id="qual" class="val grey" style=" width: 3px; height: 19px; margin-left:50px;"> </span>-->
                    <span id="wa" class="val grey" style=" width: 3px; height: 19px; margin-left:52px"> </span>
                    <span id="rp" class="val grey" style=" width: 3px; height: 19px;margin-left:50px"> </span>
                    <span id="ssp" class="val grey" style=" width: 3px; height: 19px;margin-left:60px"> </span>
                   <!-- <span id="rh" class="val grey" style=" width: 3px; height: 19px;margin-left:68px"> </span>
                    <span id="va" class="val grey" style=" width: 3px; height: 19px;margin-left:68px"> </span>
                    <span id="co" class="val grey" style=" width: 3px; height: 19px;margin-left:50px"> </span>
                    <span id="oap" class="val grey" style=" width: 3px; height: 19px;margin-left:40px"> </span>-->
                    <span id="cm" class="val grey" style=" width: 3px; height: 19px;margin-left:70px"> </span>
                   <!-- <span id="dc" class="val grey" style=" width: 3px; height: 19px;margin-left:93px"> </span>-->
                    <span id="sas" class="val grey" style=" width: 3px; height: 19px;margin-left:90px"> </span>
                    <!--<span id="gtos" class="val grey" style=" width: 3px; height: 19px;margin-left:90px"> </span>
                    <span id="fl" class="val grey" style=" width: 3px; height: 19px;margin-left:90px"> </span>-->
                    <span id="cosma" class="val grey" style=" width: 3px; height: 19px;margin-left:97px"> </span>
                    <span id="csr" class="val grey" style=" width: 3px; height: 19px;margin-left:85px"> </span>
                    
                </p>
            </div>
        
        <table class="table table-striped" id="tab1" style="table-layout: fixed;">
<thead><tr style="height: 110px;"><th style="width: 120px;">Feedback Number</th><th style="width: 100px;">Survey Type</th><th style="width: 100px;">Product Category</th>   <th style="width: 60px;">Year</th>   <th style="width: 140px;">Account </th><th style="width: 70px;">Reliability</th><!--<th style="width: 70px;">Quality</th>--><th style="width: 70px;">Warranty</th><th style="width: 85px;">Repair Performance</th><th style="width: 85px;">Spares Performance</th><!--<th style="width: 90px;">Recommend HON</th><th style="width: 70px;">Value</th><th style="width: 60px;">Cost</th><th style="width: 80px;">Overall Perception</th> -->           <th style="width: 110px;">Communication</th><!--<th style="width: 110px;">Documentation</th>--><th style="width: 110px;">Service/Support</th>  <!--<th style="width: 110px;">Global Technical Ops Support</th><th style="width: 110px;">Flexibility</th> --><th style="width: 110px;">Customer Overall Satisfaction Metric</th><th style="width: 110px;">Consolidated score Rating</th></tr></thead>
        </table>
        <table class="table table-striped" id="tab2" style="table-layout: fixed;">

        </table>
      </div>
           

    </div>
    
  </div> <!-- /container -->
  
    <div id="myModal" class="modal hide">
        <div class="modal-header">
            <h3>ATR VOC Survey</h3>
            <h4>What do these colors mean?</h4>
        </div>
        <div class="modal-body">

            <div style="padding:5px;" class="row-fluid"><div class="span3"><span class="val red" style="height: 20px;width: 20px;">&nbsp;</span></div> Surveys that score 0-1 for GE and 1-2 for AIRBUS,BOEING and 0-6 for HOS,NSS </div>
            <div style="padding:5px;" class="row-fluid"><div class="span3"><span class="val yellow" style="height: 20px;width: 20px;">&nbsp;</span></div> Surveys that score 2 for GE and 3 for AIRBUS,BOEING and 7-8 for HOS,NSS</div>
            <div style="padding:5px;" class="row-fluid"><div class="span3"><span class="val green" style="height: 20px;width: 20px;">&nbsp;</span></div> Surveys that score 3 for GE and 4 for AIRBUS,BOEING and 9 for HOS,NSS</div>
            <div style="padding:5px;" class="row-fluid"><div class="span3"><span class="val blue" style="height: 20px;width: 20px;">&nbsp;</span></div> Surveys that score 4 for GE and 5 for AIRBUS,BOEING and 10 for HOS,NSS</div>

            </div>
        <div class="modal-footer">
            <a class="btn btn-large btn-danger" data-dismiss="modal" href="#">Close</a>
        </div>
    </div>
    
    
       
    
    
   
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="{!URLFOR($Resource.db_bootstrap_zip, 'js/jquery.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.db_bootstrap_zip, 'js/bootstrap-collapse.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.db_bootstrap_zip, 'js/bootstrap-modal.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.db_bootstrap_zip, 'js/jquery.cookie.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.db_bootstrap_zip, 'js/SPEX-scripts.js')}"></script>
    
    <!--  <script src="https://code.jquery.com/jquery-1.8.2.js"></script> -->
    <!--  <link rel="stylesheet" href="https://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css"/> -->
     <!-- <script src="https://code.jquery.com/ui/1.9.0/jquery-ui.js"></script> -->
       
       
       
        <!-- <link rel="stylesheet" href="//code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css"/> -->
       <!--    <script src="//code.jquery.com/jquery-1.10.2.js"></script> -->
          <!--    <script src="//code.jquery.com/ui/1.11.3/jquery-ui.js"></script> -->
          
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
             <link rel="stylesheet" href="//code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css"/>

  <script src="//code.jquery.com/ui/1.11.3/jquery-ui.js"></script>


    
    
    <script>
    
    function getUrlVar(key){
    var result = new RegExp(key + "=([^&]*)", "i").exec(window.location.search); 
    return result && unescape(result[1]) || ""; 
}
        
        $("#partback").click(function() {
            $("#myModal1").modal('hide');
            $("#myModal7").modal('show');
        });
        $("#suppliersnext").click(function() {
            $("#myModal1").modal('hide');
            $("#myModal2").modal('show');
        });
        $("#ordersback").click(function() {
            $("#myModal2").modal('hide');
            $("#myModal1").modal('show');
        });
        $("#deliverynext").click(function() {
            $("#myModal2").modal('hide');
            $("#myModal3").modal('show');
        });
        $("#suppliersback").click(function() {
            $("#myModal3").modal('hide');
            $("#myModal2").modal('show');
        });
        $("#irrnext").click(function() {
            $("#myModal3").modal('hide');
            $("#myModal4").modal('show');
        });
        $("#deliveryback").click(function() {
            $("#myModal4").modal('hide');
            $("#myModal3").modal('show');
        });
        $("#qualitynext").click(function() {
            $("#myModal4").modal('hide');
            $("#myModal5").modal('show');
        });
        $("#irrback").click(function() {
            $("#myModal5").modal('hide');
            $("#myModal4").modal('show');
        });
        $("#yieldnext").click(function() {
            $("#myModal5").modal('hide');
            $("#myModal6").modal('show');
        });
        $("#qualityback").click(function() {
            $("#myModal6").modal('hide');
            $("#myModal5").modal('show');
        });
        $("#partnext").click(function() {
            $("#myModal6").modal('hide');
            $("#myModal7").modal('show');
        });
        $("#yieldback").click(function() {
            $("#myModal7").modal('hide');
            $("#myModal6").modal('show');
        });
        $("#ordersnext").click(function() {
            $("#myModal7").modal('hide');
            $("#myModal1").modal('show');
        });
        
        //INC000006348765 - Countdown for IES Starts
$(document).ready(function(){
        //********************//
       //alert('works');
        
 var  stypearray = new Array();
//alert('5555');
var urlaccname = getUrlVar('accname');
//alert(document.getElementById('idCompany').value);
if(document.getElementById('idCompany').value=='' && urlaccname!='')
{//alert(urlaccname);
urlaccname=urlaccname.replace(/\+/g, ' ');
document.getElementById('idCompany').value=urlaccname;
}
stypearray.push(document.getElementById('filter').value);
stypearray.push(document.getElementById('filter2').value);
stypearray.push(document.getElementById('filter3').value);
stypearray.push(document.getElementById('idCompany').value);
 ATR_VOC.RemFeedback(stypearray ,function(result, event)
 {
   //alert('all'+result.length);
 var tab = '<tbody>';
 if(event.type == 'exception') {
               // alert(event.message);
            } 
            
  else
  {
  //alert('inside else');
  var RecentRequestCount=0;
   $.each(result, function(index, value)
 {
tab+='<tr><td style="width: 120px;"><a href="#"  onclick="getFeedBackDetails(\'' + value.Id + '\')"> '+checkundefined(value.Name)+'</td><td style="width: 100px;">'+checkundefined(value.ATR_Survey_Group__c)+'</td> <td style="width: 100px;">'+checkundefined(value.Product_Category__c)+'</td>  <td style="width: 60px;">'+checkundefined(value.Year__c)+'</td> <td style="width: 140px;">'+checkundefined(value.Account_Name__c)+'</td><td style="width: 70px;"><span class="'+getcolor(value.Metric_for_Reliability__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Metric_for_Reliability__c)+'</span></td>  <!--<td style="width: 70px;"><span class="'+getcolor(value.Metric_for_Quality__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Metric_for_Quality__c)+'</span></td> --> <td style="width: 70px;"><span class="'+getcolor(value.Warranty__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Warranty__c)+'</span></td><td style="width: 85px;"><span class="'+getcolor(value.Repair_Performance__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Repair_Performance__c)+'</span></td><td style="width: 85px;"><span class="'+getcolor(value.Spares_Performance__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Spares_Performance__c)+'</span></td> <!--<td style="width: 90px;"><span class="'+getcolor(value.Recommend_HON__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Recommend_HON__c)+'</span></td> <td style="width: 70px;"><span class="'+getcolor(value.Metric_for_Value__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Metric_for_Value__c)+'</span></td><td style="width: 60px;"><span class="'+getcolor(value.Cost__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Cost__c)+'</span></td><td style="width: 80px;"><span class="'+getcolor(value.Overall_Perception__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Overall_Perception__c)+'</span></td>  --><td style="width: 110px;"><span class="'+getcolor(value.Communication__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Communication__c)+'</span></td> <!--<td style="width: 110px;"><span class="'+getcolor(value.Documentation__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Documentation__c)+'</span></td> --> <td style="width: 110px;"><span class="'+getcolor(value.Metric_for_Service_Support__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Metric_for_Service_Support__c)+'</span></td> <!--<td style="width: 110px;"><span class="'+getcolor(value.Global_Technical_Ops_Support__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Global_Technical_Ops_Support__c)+'</span></td><td style="width: 110px;"><span class="'+getcolor(value.Flexibility__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Flexibility__c)+'</span></td> --><td style="width: 110px;"><span class="'+getcolor(value.Customer_Overall_Satisfaction_Metric__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Customer_Overall_Satisfaction_Metric__c)+'</span></td><td style="width: 110px;"><span class="'+getcolor(value.Consolidated_score__c,'Consolidated score Rating')+'"style="height: 20px;width:35px;" >'+checkundefined(value.Consolidated_score__c)+'</span></td></tr>'; 
 RecentRequestCount++;
 var i=0;
 //alert(i);
 //if(ATR_Survey_Group__c == 'Airbus')
 
 //{ 
 //var rel= rel+value.reliability;
// i++;
  
 
 
 
// }
//alert(rel);
 
 
 
 
 } );
 tab+='</tbody>';
 $('#tab2').html(tab);


  $('#nav2').hide();  
 if(RecentRequestCount>15)
                                {
                                 
                                //alert('hi');
                                 $('#tab2').after('<div id="nav" style="padding: 15px 0; float: right;"></div>');
                                    
                                    var rowsShown = 15;
                                    var rowsTotal = RecentRequestCount;
                                    var numPages = rowsTotal/rowsShown;
                                    //alert(numPages);
                                    for(i = 0;i < numPages;i++) {
                                        var pageNum = i + 1;
                                        $('#nav').append('<a href="#" rel="'+i+'">'+pageNum+'</a> ');
                                    }

                                    $('#tab2 tr').hide();
                                    $('#tab2 tr ').slice(0, rowsShown).show();




                                   $('#nav a:first').addClass('active');
                                    $('#nav a').bind('click', function(){
                                        $('#nav a').removeClass('active');
                                        $(this).addClass('active');
                                        var currPage = $(this).attr('rel');
                                        var startItem = currPage * rowsShown;
                                        var endItem = startItem + rowsShown;
                                       
                                        $('#tab2 tr').css('opacity','0.0').hide().slice(startItem, endItem).
                                        css('display','table-row').animate({opacity:1}, 300);
                                        
                                    });
                                } 
  }
 
 
 }
 );

        
           
        });
        
  
        
        
        
        function getcolor(cvalue,n){
        if(n=='NSS'|| n=='HOS'){
        if(cvalue>=0 && cvalue<=6)
        return 'val red';
        if(cvalue>=7 && cvalue<=8)
        return 'val yellow';
        if(cvalue>=9 && cvalue<=10 )
        return 'val green';
        //if(cvalue==10 )
        //return 'val blue';
        }
        if(n=='Airbus'|| n=='Boeing'){
        if(cvalue>=0 && cvalue<=2)
        return 'val red';
        if(cvalue==3)
        return 'val yellow';
        if(cvalue>=4 && cvalue<=10 )
        return 'val green';
        /*if(cvalue==5 )
        return 'val blue';
        if(cvalue>=6 && cvalue<=10)
        return 'val grey';*/
        else
        return 'undefind';

        }
        if(n=='GE'){
        if(cvalue>=0 && cvalue<=1)
        return 'val red';
        if(cvalue==2)
        return 'val yellow';
        if(cvalue>=3 && cvalue<=4)
        return 'val green';
        /*if(cvalue==4)
        return 'val blue';
        if(cvalue>=5 && cvalue<=10)
        return 'val grey';*/
        else
        return 'undefind';
        }
        if(n=='Consolidated score Rating')
        {
        if(cvalue==1)
        return 'val red';
        if(cvalue==2)
        return 'val yellow';
        if(cvalue==3 || cvalue==4)
        return 'val green';
        //if(cvalue==4)
        //return 'val blue';
        }
        
        }
        
        function checkundefined(n){
        if(n==null)
        return '';
        else
        return n;
        }
        //function avg(n)
        
        
       // var Stype= ["ATR_Survey_Group__c","Account__c","Year__c","Product_Category__c"];
        //alert(Stype[0]);
        
        function StypeValue()
        { 
        //alert('enerere');
        //alert(document.getElementById('idCompany').value);    
var  stypearray = new Array();
var SelectedStrSurveyType = null;
//alert('5555');
SelectedStrSurveyType = document.getElementById('filter').value;
//alert(':::::SelectedStrSurveyType::::'+SelectedStrSurveyType);
stypearray.push(document.getElementById('filter').value);
stypearray.push(document.getElementById('filter2').value);
stypearray.push(document.getElementById('filter3').value);
stypearray.push(document.getElementById('idCompany').value);
     //alert(stypearray );
     
       ATR_VOC.RemFeedback(stypearray ,function(result, event)
 {

//alert('inside fun'+result.length);
 var tab = '<tbody>';
 if(event.type == 'exception') {
                //alert(event.message);
            } 
            
  else
  {
  var r=0;
  var rel=0;
  var boe=0;
  var qua=0;
  var war=0;
  var reppf=0;
  var sppf=0; 
  var rechn=0; 
  var mval =0;
  var cos=0;
  var oap=0;
  var com=0;
  var doc=0;
  var mfs=0;
  var gts=0;
  var flx=0;
  var cosm=0;
  var conscr=0;
  var rpavg=0;
  var ravg=0;
  var bavg=0;
  var qavg=0;
  var wavg=0;
  var spavg=0;
  var rhavg=0;
  var vavg=0;
  var cavg=0;
  var opavg=0;
  var comavg=0;
  var docavg=0;
  var mfsavg=0;
  var gtsavg=0;
  var flxavg=0;
  var cosmavg=0;
  var conscravg=0;
  if(result.length==0){
  
  
  
  $('#rav').html(ravg);
  $('#qual').html(qavg);
  $('#wa').html(wavg);
  $('#rp').html(rpavg);
   $('#ssp').html(spavg);
   $('#rh').html(rhavg);
    $('#va').html(vavg);
     $('#co').html(cavg);
      $('#oap').html(opavg);
      $('#cm').html(comavg);
       $('#dc').html(docavg);
       $('#sas').html(mfsavg);
       $('#gtos').html(gtsavg);
        $('#fl').html(flxavg);
        $('#cosma').html(cosmavg);
        $('#csr').html(conscravg );
  }
  
  var RecentRequest=0;
  //alert('inside else');
   $.each(result, function(index, value)
 {
 //if(result.length==0)
 var len = result.length;
 //alert('len'+result);
tab+='<tr><td style="width: 120px;"><a href="#"  onclick="getFeedBackDetails(\'' + value.Id + '\')"> '+checkundefined(value.Name)+'</td><td style="width: 100px;">'+checkundefined(value.ATR_Survey_Group__c)+'</td>  <td style="width: 100px;">'+checkundefined(value.Product_Category__c)+'</td> <td style="width: 60px;">'+checkundefined(value.Year__c)+'</td> <td style="width: 140px;">'+checkundefined(value.Account_Name__c)+'</td><td style="width: 70px;"><span class="'+getcolor(value.Metric_for_Reliability__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;">'+checkundefined(value.Metric_for_Reliability__c)+'</span></td> <!--<td style="width: 70px;"><span class="'+getcolor(value.Metric_for_Quality__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Metric_for_Quality__c)+'</span></td>--><td style="width: 70px;"><span class="'+getcolor(value.Warranty__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Warranty__c)+'</span></td><td style="width: 85px;"><span class="'+getcolor(value.Repair_Performance__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Repair_Performance__c)+'</span></td><td style="width: 85px;"><span class="'+getcolor(value.Spares_Performance__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Spares_Performance__c)+'</span></td><!--<td style="width: 90px;"><span class="'+getcolor(value.Recommend_HON__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Recommend_HON__c)+'</span></td><td style="width: 70px;"><span class="'+getcolor(value.Metric_for_Value__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Metric_for_Value__c)+'</span></td><td style="width: 60px;"><span class="'+getcolor(value.Cost__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Cost__c)+'</span></td><td style="width: 80px;"><span class="'+getcolor(value.Overall_Perception__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Overall_Perception__c)+'</span></td> --><td style="width: 110px;"><span class="'+getcolor(value.Communication__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Communication__c)+'</span></td><!--<td style="width: 110px;"><span class="'+getcolor(value.Documentation__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Documentation__c)+'</span></td>--><td style="width: 110px;"><span class="'+getcolor(value.Metric_for_Service_Support__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Metric_for_Service_Support__c)+'</span></td><!--<td style="width: 110px;"><span class="'+getcolor(value.Global_Technical_Ops_Support__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Global_Technical_Ops_Support__c)+'</span></td><td style="width: 110px;"><span class="'+getcolor(value.Flexibility__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Flexibility__c)+'</span></td>--><td style="width: 110px;"><span class="'+getcolor(value.Customer_Overall_Satisfaction_Metric__c,value.ATR_Survey_Group__c)+'"style="height: 20px;width:35px;" >'+checkundefined(value.Customer_Overall_Satisfaction_Metric__c)+'</span></td><td style="width: 110px;"><span class="'+getcolor(value.Consolidated_score__c,'Consolidated score Rating')+'"style="height: 20px;width:35px;" >'+checkundefined(value.Consolidated_score__c)+'</span></td></tr>'; 
 RecentRequest++;
 
 //alert(len);
 if(value.ATR_Survey_Group__c == 'Airbus')
 {
 if(value.Metric_for_Reliability__c != null)
 {
 rel= rel + parseInt(value.Metric_for_Reliability__c);
 ravg= Math.ceil((rel/len)*100)/100;
 $('#rav').html(ravg);
 }
 //else
 //{
 //rel=0;
  //$('#rav').html(rel);
 
 //}
 
 if(value.Metric_for_Quality__c != null)
 {
 
 qua = qua + parseInt(value.Metric_for_Quality__c);
 
 qavg= Math.ceil((qua/len)*100)/100;
 
 $('#qual').html(qavg);
 }
 //else
 //{
 
 //qua=0;
  //$('#qual').html(qua);
 
 //}
 if(value.Warranty__c!= null)
 {
 war = war + parseInt(value.Warranty__c);
 wavg= Math.ceil((war/len)*100)/100;
 $('#wa').html(wavg);
 }
 //else
 //{
 //war=0;
 //$('#wa').html(war);
 //}

 
 if(value.Repair_Performance__c!= null)
 {
 reppf =  reppf + parseInt(value.Repair_Performance__c);
 rpavg= Math.ceil((reppf/len)*100)/100;
 $('#rp').html(rpavg);
 }
 //else
 //{
// reppf =0;
// $('#rp').html(reppf);
// }
 if(value.Spares_Performance__c!= null)
 {
 sppf = sppf + parseInt(value.Spares_Performance__c);
 spavg= Math.ceil((sppf/len)*100)/100;
 $('#ssp').html(spavg);
 }
  //else
 //{
 //sppf =0;
 //$('#ssp').html(sppf );
 //}
 if(value.Recommend_HON__c!= null)
 {
 rechn= rechn+ parseInt(value.Recommend_HON__c);
 rhavg= Math.ceil((rechn/len)*100)/100;
 $('#rh').html(rhavg);
 }
 //else
 //{
 //rechn=0;
// $('#rh').html(rechn);
 //}
 if(value.Metric_for_Value__c!= null)
 {
 mval = mval + parseInt(value.Metric_for_Value__c);
 vavg= Math.ceil((mval/len)*100)/100;
 $('#va').html(vavg);
 }
 //else
 //{
 //mval =0;
 //$('#va').html(mval);
 //}
 
 if(value.Cost__c!= null)
 {
 cos= cos+ parseInt(value.Cost__c);
 cavg= Math.ceil((cos/len)*100)/100;
 $('#co').html(cavg);
 }
// else
// {
// cos=0;
// $('#co').html(cos);
// }
 

 
 if(value.Overall_Perception__c!= null)
 {
 oap= oap+ parseInt(value.Overall_Perception__c);
 opavg= Math.ceil((oap/len)*100)/100;
 $('#oap').html(opavg);
 }
 //else
 //{
 //oap=0;
 //$('#oap').html(oap);
 //}

 if(value.Communication__c!= null)
 {
 com= com+ parseInt(value.Communication__c);
 comavg= Math.ceil((com/len)*100)/100;
 $('#cm').html(comavg);
 }
  //else
 //{
 //com=0;
 //$('#cm').html(com);
 //}
 if(value.Documentation__c!= null)
 {
 doc= doc+ parseInt(value.Documentation__c);
 docavg= Math.ceil((doc/len)*100)/100;
 $('#dc').html(docavg);
 }
// else
 //{
 //doc=0;
 //$('#dc').html(doc);
 //}

 if(value.Metric_for_Service_Support__c!= null)
 {
 mfs= mfs+ parseInt(value.Metric_for_Service_Support__c);
 mfsavg= Math.ceil((mfs/len)*100)/100;
 $('#sas').html(mfsavg);
 }
  //else
 //{
 //mfs=0;
 //$('#sas').html(mfs);
 //}
 if(value.Global_Technical_Ops_Support__c!= null)
 {
 gts= gts+ parseInt(value.Global_Technical_Ops_Support__c);
 gtsavg= Math.ceil((gts/len)*100)/100;
 $('#gtos').html(gtsavg);
 }
  //else
 //{
 //gts=0;
// $('#gtos').html(gts);
// }
 if(value.Flexibility__c!= null)
 {
 flx= flx+ parseInt(value.Flexibility__c);
 flxavg= Math.ceil((flx/len)*100)/100;
 $('#fl').html(flxavg);
 }
// else
 //{
 //flx=0;
 //$('#fl').html(flx);
// }

 if(value.Customer_Overall_Satisfaction_Metric__c!= null)
 {
 cosm= cosm+ parseInt(value.Customer_Overall_Satisfaction_Metric__c);
 cosmavg= Math.ceil((cosm/len)*100)/100;
 $('#cosma').html(cosmavg);
 }
  //else
 //{
 //cosm=0;
 //$('#cosma').html(cosm);
 //}

 if(value.Consolidated_score__c != null)
 {
 conscr= conscr+ parseInt(value.Consolidated_score__c );
 conscravg = Math.ceil((conscr/len)*100)/100;
 $('#csr').html(conscravg );
 }
 // else
 //{
 //conscr=0;
// $('#csr').html(conscr);
// }

 
 
 }
 
 
 
 else if(value.ATR_Survey_Group__c == 'Boeing')
 
 {
 if(value.Metric_for_Reliability__c != null)
 {
 rel= rel + parseInt(value.Metric_for_Reliability__c);
 ravg= Math.ceil((rel/len)*100)/100;
 //alert('ravg'+ravg);
 $('#rav').html(ravg);
 }
 else
 {
 rel=0;
 $('#rav').html(rel);
 }
 if(value.Metric_for_Quality__c != null)
 {
 qua = qua + parseInt(value.Metric_for_Quality__c );
 qavg= Math.ceil((qua/len)*100)/100;
 $('#qual').html(qavg);
 }
 else
{
qua=0;
$('#qual').html(qua);
 }

 if(value.Warranty__c!= null)
 {
 war = war + parseInt(value.Warranty__c);
 wavg= Math.ceil(( war/len)*100)/100;
  $('#wa').html(wavg);
 }
 else
 {
 war=0;
 $('#wa').html(war);
 }
 
 if(value.Repair_Performance__c!= null)
 {
 reppf =  reppf + parseInt(value.Repair_Performance__c);
 rpavg= Math.ceil((reppf/len)*100)/100;
 $('#rp').html(rpavg);
 }
 else
 {
 reppf =0;
 $('#rp').html(reppf);
 }
 if(value.Spares_Performance__c!= null)
 {
 sppf = sppf + parseInt(value.Spares_Performance__c);
 spavg= Math.ceil((sppf/len)*100)/100;
  $('#ssp').html(spavg);
 }
 else
 {
 sppf =0;
 $('#ssp').html(sppf );
 }
 
 if(value.Recommend_HON__c!= null)
 {
 rechn= rechn+ parseInt(value.Recommend_HON__c);
 rhavg= Math.ceil((rechn/len)*100)/100;
 $('#rh').html(rhavg);
 }
 else
 {
 rechn=0;
 $('#rh').html(rechn);
 }
 
 if(value.Metric_for_Value__c!= null)
 {
 mval = mval + parseInt(value.Metric_for_Value__c);
 vavg= Math.ceil((mval/len)*100)/100;
 $('#va').html(vavg);
 }
 else
 {
 mval =0;
 $('#va').html(mval);
 }
 
 
 if(value.Cost__c!= null)
 {
 cos= cos+ parseInt(value.Cost__c);
 cavg= Math.ceil((cos/len)*100)/100;
 $('#co').html(cavg);
 }
 else
 {
 cos=0;
 $('#co').html(cos);
 }
 
 if(value.Overall_Perception__c!= null)
 {
 oap= oap+ parseInt(value.Overall_Perception__c);
 opavg= Math.ceil((oap/len)*100)/100;
 $('#oap').html(opavg);
 }
 else
 {
 oap=0;
 $('#oap').html(oap);
 }

 if(value.Communication__c!= null)
 {
 com= com+ parseInt(value.Communication__c);
 comavg= Math.ceil((com/len)*100)/100;
 $('#cm').html(comavg);
 }
 else
 {
 com=0;
 $('#cm').html(com);
 }
 if(value.Documentation__c!= null)
 {
 doc= doc+ parseInt(value.Documentation__c);
 docavg= Math.ceil((doc/len)*100)/100;
 $('#dc').html(docavg);
 }
 else
 {
 doc=0;
 $('#dc').html(doc);
 }
 if(value.Metric_for_Service_Support__c!= null)
 {
 mfs= mfs+ parseInt(value.Metric_for_Service_Support__c);
 mfsavg= Math.ceil((mfs/len)*100)/100;
 $('#sas').html(mfsavg);
 }
  else
 {
 mfs=0;
 $('#sas').html(mfs);
 }

 
 if(value.Global_Technical_Ops_Support__c!= null)
 {
 gts= gts+ parseInt(value.Global_Technical_Ops_Support__c);
 gtsavg= Math.ceil( (gts/len)*100)/100;
 $('#gtos').html(gtsavg);
 }
 else
 {
 gts=0;
 $('#gtos').html(gts);
 }
 if(value.Flexibility__c!= null)
 {
 flx= flx+ parseInt(value.Flexibility__c);
 flxavg= Math.ceil((flx/len)*100)/100;
 $('#fl').html(flxavg);
 }
 else
 {
 flx=0;
 $('#fl').html(flx);
 }
 if(value.Customer_Overall_Satisfaction_Metric__c!= null)
 {
 cosm= cosm+ parseInt(value.Customer_Overall_Satisfaction_Metric__c);
 cosmavg= Math.ceil(( cosm/len)*100)/100;
 $('#cosma').html(cosmavg);
 }
 else
 {
 cosm=0;
 $('#cosma').html(cosm);
 }

 
 
 if(value.Consolidated_score__c != null)
 {
 conscr= conscr+ parseInt(value.Consolidated_score__c );
 conscravg = Math.ceil((conscr/len)*100)/100;
 $('#csr').html(conscravg );
 }
  else
 {
 conscr=0;
 $('#csr').html(conscr);
 }
 
 }
 else if(value.ATR_Survey_Group__c == 'GE')
 {
// alert('GE');
 rel=0;
  $('#rav').html(rel);
 if(value.Metric_for_Reliability__c != null)
 {
 rel= rel + parseInt(value.Metric_for_Reliability__c);
 ravg= Math.ceil((rel/len)*100)/100;
 $('#rav').html(ravg);
 }
 else
 {
 rel=0;
  $('#rav').html(rel);
 
 }
 if(value.Metric_for_Quality__c != null)
 {
 qua = qua + parseInt(value.Metric_for_Quality__c );
 qavg= Math.ceil(( qua/len)*100)/100;
  $('#qual').html(qavg);
 }
 else
 {
 qua=0;
  $('#qual').html(qua);
 
 }
 if(value.Warranty__c!= null)
 {
 war = war + parseInt(value.Warranty__c);
 wavg= Math.ceil((war/len)*100)/100;
  $('#wa').html(wavg);
 }
 else
 {
 war=0;
 $('#wa').html(war);
 }

 
 if(value.Repair_Performance__c!= null)
 {
 reppf =  reppf + parseInt(value.Repair_Performance__c);
 rpavg= Math.ceil((reppf/len)*100)/100;
 $('#rp').html(rpavg);
 }
  else
 {
 reppf =0;
 $('#rp').html(reppf);
 }
 if(value.Spares_Performance__c!= null)
 {
 sppf = sppf + parseInt(value.Spares_Performance__c);
 spavg= Math.ceil((sppf/len)*100)/100;
  $('#ssp').html(spavg);
 }
  else
 {
 sppf =0;
 $('#ssp').html(sppf );
 }
 if(value.Recommend_HON__c!= null)
 {
 rechn= rechn+ parseInt(value.Recommend_HON__c);
 rhavg= Math.ceil(( rechn/len)*100)/100;
 $('#rh').html(rhavg);
 }
 else
 {
 rechn=0;
 $('#rh').html(rechn);
 }

 if(value.Metric_for_Value__c!= null)
 {
 mval = mval + parseInt(value.Metric_for_Value__c);
 vavg= Math.ceil((mval/len)*100)/100;
 $('#va').html(vavg);
 }
  else
 {
 mval =0;
 $('#va').html(mval);
 }
 
 if(value.Cost__c!= null)
 {
 cos= cos+ parseInt(value.Cost__c);
 cavg= Math.ceil((cos/len)*100)/100;
 $('#co').html(cavg);
 }
 else
 {
 cos=0;
 $('#co').html(cos);
 }

 
 if(value.Overall_Perception__c!= null)
 {
 oap= oap+ parseInt(value.Overall_Perception__c);
 opavg= Math.ceil((oap/len)*100)/100;
 $('#oap').html(opavg);
 }
  else
 {
 oap=0;
 $('#oap').html(oap);
 }
 if(value.Communication__c!= null)
 {
 com= com+ parseInt(value.Communication__c);
 comavg= Math.ceil((com/len)*100)/100;
 $('#cm').html(comavg);
 }
 else
 {
 com=0;
 $('#cm').html(com);
 }

 if(value.Documentation__c!= null)
 {
 doc= doc+ parseInt(value.Documentation__c);
 docavg= Math.ceil((doc/len)*100)/100;
 $('#dc').html(docavg);
 }
 else
 {
 doc=0;
 $('#dc').html(doc);
 }

 if(value.Metric_for_Service_Support__c!= null)
 {
 mfs= mfs+ parseInt(value.Metric_for_Service_Support__c);
 mfsavg= Math.ceil((mfs/len)*100)/100;
 $('#sas').html(mfsavg);
 }
  else
 {
 mfs=0;
 $('#sas').html(mfs);
 }

 if(value.Global_Technical_Ops_Support__c!= null)
 {
 gts= gts+ parseInt(value.Global_Technical_Ops_Support__c);
 gtsavg= Math.ceil((gts/len)*100)/100;
 $('#gtos').html(gtsavg);
 }
 else
 {
 gts=0;
 $('#gtos').html(gts);
 }
 if(value.Flexibility__c!= null)
 {
 flx= flx+ parseInt(value.Flexibility__c);
 flxavg= Math.ceil((flx/len)*100)/100;
  $('#fl').html(flxavg);
 }
  else
 {
 flx=0;
 $('#fl').html(flx);
 }
 if(value.Customer_Overall_Satisfaction_Metric__c!= null)
 {
 cosm= cosm+ parseInt(value.Customer_Overall_Satisfaction_Metric__c);
 cosmavg= Math.ceil((cosm/len)*100)/100;
 $('#cosma').html(cosmavg);
 }
 else
 {
 cosm=0;
 $('#cosma').html(cosm);
 }
 if(value.Consolidated_score__c != null)
 {
 conscr= conscr+ parseInt(value.Consolidated_score__c );
 conscravg = Math.ceil((conscr/len)*100)/100;
 $('#csr').html(conscravg );
 }
 else
 {
 conscr=0;
 $('#csr').html(conscr);
 }

 
 }
 
  else if(value.ATR_Survey_Group__c == 'NSS')
 
 {
 if(value.Metric_for_Reliability__c != null)
 {
 rel= rel + parseInt(value.Metric_for_Reliability__c);
 ravg= Math.ceil((rel/len)*100)/100;
 $('#rav').html(ravg);
 }
 else
 {
 rel=0;
  $('#rav').html(rel);
 
 }
 if(value.Metric_for_Quality__c != null)
 {
 qua = qua + parseInt(value.Metric_for_Quality__c );
 qavg= Math.ceil(( qua/len)*100)/100;
  $('#qual').html(qavg);
 }
 else
 {
 qua=0;
  $('#qual').html(qua);
 
 }
 if(value.Warranty__c!= null)
 {
 war = war + parseInt(value.Warranty__c);
 wavg= Math.ceil(( war/len)*100)/100;
  $('#wa').html(wavg);
 }
 else
 {
 war=0;
 $('#wa').html(war);
 }

 
 if(value.Repair_Performance__c!= null)
 {
 reppf =  reppf + parseInt(value.Repair_Performance__c);
 rpavg= Math.ceil((reppf/len)*100)/100;
 $('#rp').html(rpavg);
 }
  else
 {
 reppf =0;
 $('#rp').html(reppf);
 }
 if(value.Spares_Performance__c!= null)
 {
 sppf = sppf + parseInt(value.Spares_Performance__c);
 spavg= Math.ceil((sppf/len)*100)/100;
  $('#ssp').html(spavg);
 }
  else
 {
 sppf =0;
 $('#ssp').html(sppf );
 }
 if(value.Recommend_HON__c!= null)
 {
 rechn= rechn+ parseInt(value.Recommend_HON__c);
 rhavg= Math.ceil( (rechn/len)*100)/100;
 $('#rh').html(rhavg);
 }
 else
 {
 rechn=0;
 $('#rh').html(rechn);
 }

 if(value.Metric_for_Value__c!= null)
 {
 mval = mval + parseInt(value.Metric_for_Value__c);
 vavg= Math.ceil((mval/len)*100)/100;
 $('#va').html(vavg);
 }
  else
 {
 mval =0;
 $('#va').html(mval);
 }
 
 if(value.Cost__c!= null)
 {
 cos= cos+ parseInt(value.Cost__c);
 cavg= Math.ceil((cos/len)*100)/100;
 $('#co').html(cavg);
 }
 else
 {
 cos=0;
 $('#co').html(cos);
 }

 
 if(value.Overall_Perception__c!= null)
 {
 oap= oap+ parseInt(value.Overall_Perception__c);
 opavg= Math.ceil((oap/len)*100)/100;
 $('#oap').html(opavg);
 }
  else
 {
 oap=0;
 $('#oap').html(oap);
 }
 if(value.Communication__c!= null)
 {
 com= com+ parseInt(value.Communication__c);
 comavg= Math.ceil( (com/len)*100)/100;
 $('#cm').html(comavg);
 }
 else
 {
 com=0;
 $('#cm').html(com);
 }

 if(value.Documentation__c!= null)
 {
 doc= doc+ parseInt(value.Documentation__c);
 docavg= Math.ceil((doc/len)*100)/100;
 $('#dc').html(docavg);
 }
 else
 {
 doc=0;
 $('#dc').html(doc);
 }

 if(value.Metric_for_Service_Support__c!= null)
 {
 mfs= mfs+ parseInt(value.Metric_for_Service_Support__c);
 mfsavg= Math.ceil((mfs/len)*100)/100;
 $('#sas').html(mfsavg);
 }
  else
 {
 mfs=0;
 $('#sas').html(mfs);
 }

 if(value.Global_Technical_Ops_Support__c!= null)
 {
 gts= gts+ parseInt(value.Global_Technical_Ops_Support__c);
 gtsavg= Math.ceil((gts/len)*100)/100;
 $('#gtos').html(gtsavg);
 }
 else
 {
 gts=0;
 $('#gtos').html(gts);
 }
 if(value.Flexibility__c!= null)
 {
 flx= flx+ parseInt(value.Flexibility__c);
 flxavg=Math.ceil((flx/len)*100)/100;
 $('#fl').html(flxavg);
 }
  else
 {
 flx=0;
 $('#fl').html(flx);
 }
 if(value.Customer_Overall_Satisfaction_Metric__c!= null)
 {
 cosm= cosm+ parseInt(value.Customer_Overall_Satisfaction_Metric__c);
 cosmavg= Math.ceil((cosm/len)*100)/100;
 $('#cosma').html(cosmavg);
 }
 else
 {
 cosm=0;
 $('#cosma').html(cosm);
 }
 if(value.Consolidated_score__c != null)
 {
 conscr= conscr+ parseInt(value.Consolidated_score__c );
 conscravg = Math.ceil((conscr/len)*100)/100;
 $('#cosm').html(conscravg );
 }
 else
 {
 conscr=0;
 $('#csr').html(conscr);
 }

 
 }
 else if(value.ATR_Survey_Group__c == 'HOS')
 
 {
 if(value.Metric_for_Reliability__c != null)
 {
 rel= rel + parseInt(value.Metric_for_Reliability__c);
 ravg= Math.ceil((rel/len)*100)/100;
 $('#rav').html(ravg);
 }
 else
 {
 rel=0;
  $('#rav').html(rel);
 
 }
 if(value.Metric_for_Quality__c != null)
 {
 qua = qua + parseInt(value.Metric_for_Quality__c );
 qavg= Math.ceil((qua/len)*100)/100;
  $('#qual').html(qavg);
 }
 else
 {
 qua=0;
  $('#qual').html(qua);
 
 }
 if(value.Warranty__c!= null)
 {
 war = war + parseInt(value.Warranty__c);
 wavg= Math.ceil((war/len)*100)/100;
  $('#wa').html(wavg);
 }
 else
 {
 war=0;
 $('#wa').html(war);
 }

 
 if(value.Repair_Performance__c!= null)
 {
 reppf =  reppf + parseInt(value.Repair_Performance__c);
 rpavg= Math.ceil((reppf/len)*100)/100;
 $('#rp').html(rpavg);
 }
  else
 {
 reppf =0;
 $('#rp').html(reppf);
 }
 if(value.Spares_Performance__c!= null)
 {
 sppf = sppf + parseInt(value.Spares_Performance__c);
 spavg= Math.ceil((sppf/len)*100)/100;
  $('#ssp').html(spavg);
 }
 else
 {
 sppf =0;
 $('#ssp').html(sppf );
 }
 if(value.Recommend_HON__c!= null)
 {
 rechn= rechn+ parseInt(value.Recommend_HON__c);
 rhavg= Math.ceil((rechn/len)*100)/100;
 $('#rh').html(rhavg);
 }
 else
 {
 rechn=0;
 $('#rh').html(rechn);
 }

 if(value.Metric_for_Value__c!= null)
 {
 mval = mval + parseInt(value.Metric_for_Value__c);
 vavg= Math.ceil((mval/len)*100)/100;
 $('#va').html(vavg);
 }
  else
 {
 mval =0;
 $('#va').html(mval);
 }
 
 if(value.Cost__c!= null)
 {
 cos= cos+ parseInt(value.Cost__c);
 cavg= Math.ceil((cos/len)*100)/100;
 $('#co').html(cavg);
 }
 else
 {
 cos=0;
 $('#co').html(cos);
 }

 
 if(value.Overall_Perception__c!= null)
 {
 oap= oap+ parseInt(value.Overall_Perception__c);
 opavg= Math.ceil((oap/len)*100)/100;
 $('#oap').html(opavg);
 }
  else
 {
 oap=0;
 $('#oap').html(oap);
 }
 if(value.Communication__c!= null)
 {
 com= com+ parseInt(value.Communication__c);
 comavg= Math.ceil((com/len)*100)/100;
 $('#cm').html(comavg);
 }
 else
 {
 com=0;
 $('#cm').html(com);
 }

 if(value.Documentation__c!= null)
 {
 doc= doc+ parseInt(value.Documentation__c);
 docavg= Math.ceil(( doc/len)*100)/100;
 $('#dc').html(docavg);
 }
 else
 {
 doc=0;
 $('#dc').html(doc);
 }

 if(value.Metric_for_Service_Support__c!= null)
 {
 mfs= mfs+ parseInt(value.Metric_for_Service_Support__c);
 mfsavg= Math.ceil(( mfs/len)*100)/100;
 $('#sas').html(mfsavg);
 }
  else
 {
 mfs=0;
 $('#sas').html(mfs);
 }

 if(value.Global_Technical_Ops_Support__c!= null)
 {
 gts= gts+ parseInt(value.Global_Technical_Ops_Support__c);
 gtsavg= Math.ceil(( gts/len)*100)/100;
 $('#gtos').html(gtsavg);
 }
 else
 {
 gts=0;
 $('#gtos').html(gts);
 }
 if(value.Flexibility__c!= null)
 {
 flx= flx+ parseInt(value.Flexibility__c);
 flxavg= Math.ceil((flx/len)*100)/100;
 $('#fl').html(flxavg);
 }
  else
 {
 flx=0;
 $('#fl').html(flx);
 }
 if(value.Customer_Overall_Satisfaction_Metric__c!= null)
 {
 cosm= cosm+ parseInt(value.Customer_Overall_Satisfaction_Metric__c);
 cosmavg= Math.ceil((cosm/len)*100)/100;
 $('#cosma').html(cosmavg);
 }
 else
 {
 cosm=0;
 $('#cosma').html(cosm);
 }
 if(value.Consolidated_score__c != null)
 {
 conscr= conscr+ parseInt(value.Consolidated_score__c );
 conscravg = Math.ceil((conscr/len)*100)/100;
 $('#csr').html(conscravg );
 }
 else
 {
 conscr=0;
 $('#csr').html(conscr);
 }

 
 }
 
 
 
 
 
 } );
 
 //alert(rel);
 /*alert('boesum'+boe);
// alert('bavg'+bavg);
//alert('relsum'+rel);
 alert('relavg'+ravg);*/
//alert('qsum'+qua);
// alert('qavg'+qavg);
 /*alert('wsum'+war);
 alert('wavg'+wavg);
 alert('reppf'+reppf );
 alert('rpavg'+rpavg);
 alert('sppf'+sppf );
 alert('spavg'+spavg);
 alert('rechn'+rechn );
 alert('rhavg'+rhavg);
 alert('mval'+mval );
 alert('vavg'+vavg);
 alert('cos'+cos);
 alert('cavg'+cavg);
 alert('oap'+oap);
 alert('opavg'+opavg);
 alert('com'+com);
 alert('comavg'+comavg);
 alert('doc'+doc);
 alert('docavg'+docavg);
 alert('mfs'+mfs);
 alert('mfsavg'+mfsavg);
 alert('gts'+gts);
 alert('gtsavg'+gtsavg);
 alert('flx'+flx);
 alert('flxavg'+flxavg);
 alert('cosm'+cosm);
 alert('cosmavg'+cosmavg);*/
 
 
// alert('RecentRequest'+RecentRequest);
 tab+='</tbody>';

 $('#tab2').html(tab);

 $('#nav2').remove(); 

  if(RecentRequest>15)
                                {
                                $('#nav').remove();  
                                //alert('hi');
                                 $('#tab2').after('<div id="nav2" style="padding: 15px 0; float: right;"></div>');
                                    
                                    var rowsShown = 15;
                                    var rowsTotal = RecentRequest;

                                    var numPages = rowsTotal/rowsShown;
                                    //alert(numPages);
                                    for(i = 0;i < numPages;i++) {
                                        var pageNum = i + 1;
                                        $('#nav2').append('<a href="#" rel="'+i+'">'+pageNum+'</a> ');
                                    }

                                    $('#tab2 tr').hide();
                                    $('#tab2 tr').slice(0, rowsShown).show();


                                   $('#nav2 a:first').addClass('active');
                                    $('#nav2 a').bind('click', function(){
                                        $('#nav2 a').removeClass('active');
                                        $(this).addClass('active');
                                        var currPage = $(this).attr('rel');
                                        var startItem = currPage * rowsShown;
                                        var endItem = startItem + rowsShown;

                                        $('#tab2 tr').css('opacity','0.0').hide().slice(startItem, endItem).
                                        css('display','table-row').animate({opacity:1}, 300);
                                    });

                                }
      else{
      
          $('#nav').show();
      }
      
     // alert('Refresh');
      if(SelectedStrSurveyType != 'ALL'){
          $('#ShowAvgDiv').removeClass( 'hideDivision' );
      }else{
          $('#ShowAvgDiv').addClass( 'hideDivision' );
      }
      //refreshSurveyTypeHid();
  }    
     
 });
        
        }
        function getFeedBackDetails(FeedId)
        {
             window.open('/Dashboards/ATRVOCRecordDetails?id='+FeedId, '_top');
        
        }
       
       var $ = jQuery.noConflict();
        var apexAccountList =[];
   <apex:repeat value="{!accountList}" var="accList">            
      apexAccountList.push('{!accList.Account_Name__c}');            
  </apex:repeat> 
     $(document).ready(function(){
    $( ".autocomplete" ).autocomplete({
  source: function( request, response ) {
          var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( request.term ), "i" );
          response( $.grep( apexAccountList , function( item ){
              return matcher.test( item );
          }) );
           
      }
});

 });    
  
      /*    Start - Account Autocomplete    */
function getDataForAutoComplete(inputFieldId, resultFieldId, objectName){
    
    var Objects;
    $('#'+ inputFieldId ).addClass('ui-autocomplete-loading');
    console.log('---->' + 'inside');
    $('[id$='+inputFieldId+']').autocomplete({
    minLength: 2,
    source: function(request, response) {
                //alert('in method call');
                queryTerm = request.term;               
                if(objectName == 'Account') {                
                    //$('#ui-id-1').addClass('ui-modal');
                    $("ul").each(function() { 
                        $(this).addClass('ui-modal')
                    }); 
                    ATR_VOC.searchAccount(request.term, function(result, event){                    
                        if(event.type == 'exception') {
                              //alert(event.message);
                        } else {
                             Objects= result;
                             response(Objects);
                             console.log('@@@@@@@@@@@@@@@@@@@@@@@## '+result);
                             console.log('@@@@@@@@@@@@@@@@@@@@@@@ '+result[0]);
                             if(result[0] == ''){
                                 
                                 $('#'+ resultFieldId ).val('');
                             }
                             if(result[0] == null) {
                                 $('#FormCompanyId').val('');
                                 $('#'+ resultFieldId ).val('');
                             }
                        }
                    });
                
                }
                
                                     
           },
    focus: function( event, ui ) {
            $('[id$='+inputFieldId+']').val( ui.item.Name );
            return false;
            },
    select: function( event, ui ) {
                $('[id$='+inputFieldId+']').val( ui.item.Name );
                $('[id$='+resultFieldId+']').val( ui.item.Id );
                return false;
            },
     }).data( "ui-autocomplete" )._renderItem = function( ul, item ) {
        
        var entry = "<a>" + item.Name;
        
        entry = entry + "</a>";
        entry = entry.replace(queryTerm, "<b>" + queryTerm + "</b>");
       // console.log('entry-->'+ entry );
        return $( "<li></li>" )
            .data( "ui-autocomplete-item", item )
            .append( entry )
            .appendTo( ul );
    };
    $('#'+ inputFieldId ).removeClass('ui-autocomplete-loading');
}
/*    End- Account Autocomplete    */
  
        
        
        
      
    </script>
</body>
</html>
</apex:form>
<apex:insert name="footer">
        <c:honeywellFooter />
</apex:insert>

</apex:page>
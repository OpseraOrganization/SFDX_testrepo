<apex:page Controller="PORMUSoldByCity" cache="true" contenttype="application/x-excel#PO_Tracker_{!stateCode}_{!SUBSTITUTE(countryCode,' ','_')}_{!TODAY()}.xls">


<apex:repeat value="{!platformsList}" var="pltfrmName">
<br/>
<br/>

<table><tr><td style="background-color: yellow;font-weight: bold;" >{!pltfrmName}</td></tr></table>
<apex:variable var="cntVal" value="{!0}" />

<table style="border: 1px solid black;">
<tr>
     <apex:repeat value="{!parentColsApiNamesList}" var="pCol">
        <td style="background-color: #EEEEEE;font-weight: bold;">{!fieldNameVsLabel[pCol]}</td>
    </apex:repeat>
     <apex:repeat value="{!rmuDetailList[pltfrmName]}" var="pDetlCol">
        <td style="background-color: #33B5E5;font-weight: bold;">{!UPPER(pDetlCol)}</td>
    </apex:repeat>
    
</tr>

<apex:repeat value="{!displayData[pltfrmName]}" var="recordPO" >
<tr>
    <apex:repeat value="{!parentColsApiNamesList}" var="pCol">
        <td style="background-color: #FFFFFF">{!recordPO[pCol]}</td>
    </apex:repeat>
    <apex:repeat value="{!rmuDetailList[pltfrmName]}" var="pDetlCol">
        <td style="background-color: {!IF((recordPO[pDetlCol] =='-'),"#FFFFFF","Green;color:white;")};width:150px;">{!recordPO[pDetlCol]}</td>
    </apex:repeat>
</tr>
<apex:variable var="cntVal" value="{!cntVal+1}" />
</apex:repeat>

</table>
<apex:outputText >Total {!cntVal} Records</apex:outputText>
    
    
</apex:repeat>
       
</apex:page>
<apex:page controller="Sendreferencematerialcls" showHeader="false">
 <apex:includeScript value="/soap/ajax/21.0/connection.js"/>
        <apex:includeScript value="/soap/ajax/21.0/apex.js"/>      
        <script>
            function email_validate(email)
            {
            var regMail = /^([_a-zA-Z0-9-]+)(\.[_a-zA-Z0-9-]+)*@([a-zA-Z0-9-]+\.)+([a-zA-Z]{2,3})$/;
            if(regMail.test(email) == false)
            {
            document.getElementById("status").innerHTML = "Email address is not valid yet.";
            }
            else
            {
             document.getElementById("status").innerHTML = "";   
            }            
            }
        </script>
        <script>
          function erroralert()
          {
          echo();
          }
        </script>
        <script>
          function successMessage()
          {
          success();         
          }
        </script>
  <apex:form style="width:80%;padding-left:2cm; padding-right:2cm;" id="sendmail" >
  <apex:actionFunction name="echo" action="{!echoVal}" reRender="resultPanel"/>
  <apex:outputPanel id="resultPanel">
  <apex:outputPanel id="scr1" rendered="{!callwindow}">
        <script>   
            alert("Please select atleast one Reference Material");            
        </script>     
</apex:outputPanel>
<apex:outputPanel id="scr2" rendered="{!callwindow2}">
        <script>   
            alert("Please select atleast one contact.");            
        </script>     
</apex:outputPanel>
<apex:outputPanel id="scr3" rendered="{!callwindow3}">
        <script>   
            alert("Please Check selected contact email address");            
        </script>     
</apex:outputPanel>
</apex:outputPanel>
<apex:actionFunction name="success" action="{!successMessage}" reRender="SuccessPanel"/>
  <apex:outputPanel id="SuccessPanel">
  <apex:outputPanel id="Success" rendered="{!callwindow1}">
        <script>               
            alert("Reference material has been sent to Customer.");           
            window.top.close();
        </script>     
</apex:outputPanel>
</apex:outputPanel>  
  <br/><br/>   
      <apex:pageBlock title="Reference Materials" mode="maindetail" id="pb">        
              <apex:pageBlockTable value="{!accInnerObj}" var="inner" columnswidth="50px,50px" cellpadding="4" border="1">
                  <apex:column headerValue="Select">
                      <apex:inputCheckbox value="{!inner.isSelected}"/>
                  </apex:column> 
                  <apex:column headerValue="Customer stories"> 
                      <apex:outputText value="{!inner.acc.Name}" />
                  </apex:column>    
              </apex:pageBlockTable>             
      <br/>
      <apex:commandButton value="<<Previous" action="{!previous}" rendered="{!hasPrevious}"/>
      <apex:commandButton value="Next >>" action="{!next}" rendered="{!hasNext}"/>
       </apex:pageBlock>
       
       <apex:pageBlock title="Related Contacts" mode="maindetail" id="pb1">        
              <apex:pageBlockTable value="{!conInnerObj}" var="inner"  cellpadding="4" border="1">
                  <apex:column headerValue="Select">
                      <apex:inputCheckbox value="{!inner.isConSelected}"/>
                  </apex:column> 
                  <apex:column headerValue="Contact Name"> 
                      <apex:outputText value="{!inner.con.Name}"/>
                  </apex:column>
                   <apex:column headerValue="Title"> 
                      <apex:outputText value="{!inner.con.Job_Title__c}"/>
                  </apex:column>   
              </apex:pageBlockTable>             
      <br/>
      <apex:commandButton value="<<Previous" action="{!previous1}" rendered="{!hasPrevious1}"/>
      <apex:commandButton value="Next >>" action="{!next1}" rendered="{!hasNext1}"/>
       </apex:pageBlock>
             <!--   <b>&nbsp;&nbsp;Additional Emails:</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                 <input type="text" name="email" id="email"  onkeyup="email_validate(this.value);"/><span id="status"></span> -->                
       <apex:pageBlock title="Additional Emails" >
             <apex:pageBlockSection columns="2" >
             <apex:inputText label="Email" value="{!email1}" id="email1" style="width: 200px;" onkeyup="email_validate(this.value);"/>           
             <apex:inputText label="Name" value="{!name1}" id="name1" />                        
             </apex:pageBlockSection>                        
              <apex:pageBlockSection columns="2">            
                <apex:inputText value="{!email2}" label="Email"  id="email2" style="width: 200px;" onkeyup="email_validate(this.value);"/>
                <apex:inputText value="{!name2}" label="Name" id="name2" />
                 </apex:pageBlockSection>    
                 <apex:pageBlockSection columns="2">
                <apex:inputText label="Email" value="{!email3}" id="email3" style="width: 200px;" onkeyup="email_validate(this.value);"/>
                <apex:inputText label="Name" value="{!name3}" id="name3" />      
            </apex:pageBlockSection>
             <apex:outputPanel id="error1">
             <span id="status"></span>
             </apex:outputPanel>     
            </apex:pageBlock>
       <br/><br/>    
       <center>
         <apex:commandButton value="Submit" action="{!GetSelected}" rerender="Selected_PBS"   onclick="erroralert()" oncomplete="successMessage()"/>
         <apex:commandbutton value="Cancel" onclick="window.top.close();"/>
         </center>
  </apex:form>
</apex:page>
<apex:page controller="TSS_Community_CaseCreate_Cont" sidebar="false" showHeader="false" standardStylesheets="false" title="Cases" cache="false" docType="html-5.0" applyHtmlTag="false">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
    <title>Cases</title>

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0" />
    <meta name="apple-mobile-web-app-title" content="Cases" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />

    <!--    Bootstrap CSS -->
    <link href="{!URLFOR($Resource.TSSCommunityRes,'css/bootstrap.min.css')}" rel="stylesheet" media="screen"/>
    
    <!--    Nav CSS -->
    <link href="{!URLFOR($Resource.TSSCommunityRes,'css/nav.css')}" rel="stylesheet" media="screen"/>
    
    <!--    Bootstrap CSS - Switch    -->
    <link href="{!URLFOR($Resource.TSSCommunityRes,'css/switch/bootstrap-switch.min.css')}" rel="stylesheet" media="screen"/> 
    <!--    Bootstrap CSS - Slider    -->
    <link href="{!URLFOR($Resource.TSSCommunityRes,'css/slider/bootstrap-slider.css')}" rel="stylesheet" media="screen"/>
    <link href="{!URLFOR($Resource.TSSCommunityRes,'css/jquery-ui.css')}" rel="stylesheet" media="screen"/> 
    
    <!--    User defined CSS files    --> 
    <link href="{!URLFOR($Resource.TSSCommunityRes,'css/common.css')}" rel="stylesheet" media="screen"/>
    <link href="{!URLFOR($Resource.TSSCommunityRes,'css/tablet.css')}" rel="stylesheet" media="screen"/>
    <link href="{!URLFOR($Resource.TSSCommunityRes,'css/smartphone.css')}" rel="stylesheet" media="screen"/>
    
    
    
    <!--   Images for iOS   -->
      
    <!--[if IE 8 ]>    <html class="ie8"> <![endif]-->
    
    
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->



<style>

@-ms-viewport{
    width: device-width;
}

    /* Temp CSS */
    .casecreate-new{
        margin-top: 0px;
        margin-left: 10px;
    }
    
    .casecreate-cancel{
        width: 150px;
        margin-top: 0px;
    }
    
    .ui-menu .ui-menu-item a {
        text-decoration: none;
        display: block;
        padding: 2px .4em;
        line-height: 1.5;
        min-height: 0;
        font-weight: normal;
    }
    
    .casecreate-statement{
        padding: 10px 0px;
        border-bottom: 1px solid #CBCCCE;
        font-size:18px;
    }
    
    @media only screen and (max-width: 767px){
        .casecreate-cancel{
            width: 120px;
        }
    }
    /* Temp CSS */
    
     
    
    
    /*@media (min-width: 992px){
        .container {
            width: 988px;
        }
        .aog{
            width: 41px;
        }
        .nav > li > a {
        
            padding: 10px 10px;
        }
    }*/
    /* Nav */
</style>

    <!---Google Analytics script starts -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-12579259-5', {'name': 'rollup_myaero'});
      ga('rollup_myaero.require', 'displayfeatures');  
      ga('rollup_myaero.send', 'pageview');
        
      ga('create', 'UA-12579259-13', 'auto');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');

    </script>
    <!---Google Analytics script ends -->
</head>
<script>    // Windows Phone and IE8 support

if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
  var msViewportStyle = document.createElement("style");
  msViewportStyle.appendChild( document.createTextNode( "@-ms-viewport{width:auto!important}" ) );
  document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
}

if (navigator.userAgent.match(/IE\/8\.0/)) {
  var msViewportStyle = document.createElement("style");
  msViewportStyle.appendChild( document.createTextNode( "@-ms-viewport{width:auto!important}" ) );
  document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
}

/*
if (navigator.appName.match('Microsoft Internet Explorer')) {
  var msViewportStyle = document.createElement("style");
  msViewportStyle.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}" ) );
  document.getElementsByTagName("head")[0].appendChild(msViewportStyle);
}
*/    

</script>
<body>
<apex:form >
<!--  Loader Icon  -->
<div class="tss-loader">
    <div class="tss-loader-overlay"></div>
    <div class="tss-loader-icon"></div>
</div>

<div class="container">
    <!--  //  Honeywell Header Image    
    <div class="row tss-hdr-img">    
        <div class="col-xs-9 col-sm-9 col-md-9 col-lg-9 tss-hdr-imgcls"></div>
        <div class="col-xs-3 hidden-sm hidden-md hidden-lg right-menu-cls"></div>
        <div class="hidden-xs col-sm-3 col-md-3 col-lg-3">
            <div class="tss-logout"> 
                <div>Welcome Aboard, {!$User.Firstname}</div>
                <a href="/secur/logout.jsp"> Logout </a>
            </div>
        </div>
    </div>    -->
    
    <!--    Honeywell Header Image   
    <div class="row tss-hdr-img">    -->
    <div class="row">
        <div class="hidden-xs col-sm-7 col-md-8 col-lg-8 tss-hdr-imgcls"></div>
        
        <div class="col-xs-12 hidden-sm hidden-md hidden-lg" style="background-color: #000000; padding: 10px;">
           <div class="col-xs-1 right-menu-cls"></div>
           <div class="col-xs-11 tss-mobhdr-imgcls"></div>
           
       </div>
        
        <div class="col-xs-12 col-sm-5 col-md-4 col-lg-4">
            <div class="tss-logout"> 
                <div class="row">Welcome Aboard, {!$User.Firstname}</div>
                <div class="row hidden-xs"><a href="http://Ez.com/ATSSSNov2014YT" target="_blank">How To Videos</a> | <a href="#" onclick="OpenHelpPopup();">FAQ</a> | <a href="{!$Label.CTSSDocLinkHTTP}/servlet/servlet.FileDownload?file={!$Label.TSSCommunityHelpDocLabel}" target="_blank">Help </a> | <a href="/SSCommunity/secur/logout.jsp"> Logout </a></div>
            </div>
        </div>
    </div>

    <!--    Main Tabs - START    -->
    <apex:include pageName="TSSCommunityCustomHeader"/>
    <div class="row home-black-strip hidden">
        <div class="btn-group btn-group-justified">
            <a id="" href="/SSCommunity/apex/TSSCommunityCases" rel="external" class="btn-group btn btn-default active" target="_top">
                <!--<img src="{!URLFOR($Resource.TSSCommunityRes,'images/cases-indicator.png')}" alt=""></img>-->Cases
            </a>
            <a href="" id="" rel="external" class="btn-group btn btn-default">
                <img src="{!URLFOR($Resource.TSSCommunityRes,'images/knowledge-indicator.png')}" alt=""></img>Solutions
            </a>
           
        </div>
    </div>
    
    <!--    Home Image    -->
    <div class="row cases-hdr-align">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 cases-title">
            <span>Technical Support Self Service</span><span id="HomepagelinkId" class="hidden-xs" style="float:right; font-size: small;padding-top: 10px;"><a href="/SSCommunity/TSSCommunityCases" target="_top">Home Page</a></span>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 casecreate-statement">
            Submit a new Technical Issue, a Honeywell representative will contact you within 10hrs.
        </div>
    </div>
    
    <div class="row casecreate-body">
        <div class="col-xs-0 col-sm-3 col-md-3 col-lg-3 hidden">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 casecreate-48hour">
                <div class="">
                    <div>48 hrs</div>
                </div>  
                <div>
                    A Honeywell representative will contact you within 48hrs. 
                </div>    
            </div>
        </div>
        
        <div class="row casecreate-hdr hidden">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                Submit a new Technical Issue  
            </div> 
        </div>
        <div class="row casecreate-stack">
           
             <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                 Inquiry Type Detail
             </div>
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
                  <select id="Inquiry_Type_Details" class="casecreate-picklist-fld">
                    <!-- <option value="">Order Changes</option> -->                     
                 </select>
             </div>
             
             <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                 Aircraft Type
             </div>
             
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
                 <input type="text"  style="" class="casecreate-inp-fld lookup-fld" id="Aircraft_Type" autofocus="autofocus" onkeypress="getDataForAutoComplete('Aircraft_Type', 'AirId', 'Aircraft')" onclick="getDataForAutoComplete('Aircraft_Type', 'AirId', 'Aircraft')"/>
                 <input class="create-inp-flds" type="hidden" id="AirId"></input>
             </div>
             
             <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                 ATA Chapter
             </div>
             
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
                 <select id="ATA_Chapter" class="casecreate-picklist-fld">
                 </select>
             </div>
             
             <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                 Product Type
             </div>
             
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
                 <input type="text" style="" class="casecreate-inp-fld lookup-fld" id="Product_Type" onkeypress="getDataForAutoComplete('Product_Type', 'ProId', 'Product_Name')" onclick="getDataForAutoComplete('Product_Type', 'ProId', 'Product_Name')"/>
                 <input class="create-inp-flds" type="hidden" id="ProId"></input>
             </div>
             
             <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                 Part Number

             </div>
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
                 <input type="text" style="" id="Part_Number" class="casecreate-inp-fld"/>
             </div>
             
             <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                 Subject

             </div>
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
                 <input type="text" style="" id="Subject_Id" class="casecreate-inp-fld"/>
             </div>
             
             <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                 Description

             </div>
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
                 <textarea id="Description_Id" class="casecreate-txtarea-fld" rows="10"/>
             </div>
             
             <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                 Attachments (&lt; 10MB)
             </div>
             
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9" style="padding: 15px 0px;">
                 <!--<input type="file" name="fileToUpload" id="fileToUpload"></input>-->
                 <apex:inputFile id="addFile" styleclass="uploadFiletoSF"  value="{!Case_Attachment.body}" filename="{!Case_Attachment.Name}"></apex:inputFile>   
             </div>
             
             <div class="col-sm-3 col-md-3 col-lg-3 casecreate-response-time hidden">
                  A Honeywell representative will contact you within 10hrs.
             </div>
             
             <div class="col-xs-12 col-sm-9 col-sm-offset-3 col-md-9 col-md-offset-3 col-lg-9 col-lg-offset-3 ">
                <b style="color:red;font-size:16px">CAUTION: Export-Controlled Information is not permitted on this site.</b>
                <br/>
                This system is not authorized for the following types of controlled information:<br/><br/>
                <ul>
                    <li>ITAR/EAR <small>(International Traffic in Arms/Export Administration Regulation)</small></li>
                    <li>Unclassified Restricted</li>
                    <li>Classified Restricted</li>
                    <li>SM&amp;M contractual documents</li>
                </ul>
             </div>
              
             <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9 col-sm-offset-3 col-md-offset-3 col-lg-offset-3">
                 <a style="text-decoration: none;" href="#" onclick="PageNavigatefunction();"><span class="btn gray-btn casecreate-cancel"> Cancel </span></a>
                 <!--<button class="btn red-casecreate-btn casecreate-new" onclick="CreateCase()"> Submit </button>-->
                 <apex:actionFunction name="invokeCreateCase" /> <!-- reRender="resultPanel" -->
                 <!--<apex:commandButton styleClass="btn red-casecreate-btn casecreate-new" onclick="return setCaseDetails();" action="{!createCase}" value="Submit"></apex:commandButton>-->
                 <apex:commandLink styleClass="btn red-casecreate-btn casecreate-new" onclick="return setCaseDetails();" action="{!createCase}" value="Submit"></apex:commandLink>
                 <apex:outputPanel id="resultPanel" />
                 
                 <apex:inputHidden value="{!Inquiry_Type_Details_var}" id="InquiryTypeId"/> 
                 <apex:inputHidden value="{!Aircraft_TypeId_var}" id="AircraftTypeId"/>
                 <apex:inputHidden value="{!ATA_Chapter_var}" id="ATAChapterId"/>
                 <apex:inputHidden value="{!Product_TypeId_var}" id="ProductTypeId"/>
                 <apex:inputHidden value="{!Part_Number_var}" id="PartNumberId"/>
                 <apex:inputHidden value="{!Subject_Id_var}" id="SubjectId"/>
                 <apex:inputHidden value="{!Description_Id_var}" id="DescriptionId"/>
             </div>
        </div>
    </div>
    <apex:include pageName="TSSCommunityCustomFooter"/>
</div>
</apex:form>
<!-- Thank you popup begins -->
<div id="ThankYouPopup" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Notification
            </div>
            <div class="modal-body popup-body">
             Thank you for submitting the case. Our agent will contact you shortly.   
            </div>                    
            <div class="modal-footer popup-footer">
                <!--<div class="col-xs-6" style="">
                </div>-->
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%" id="RedirectOkButton" type="button" data-dismiss="modal">
                        Ok
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Thank you popup ends -->

<!-- Error Message popup begins -->
<div id="errorMessage" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Error 
            </div>
            <div class="modal-body popup-body">
                Sorry, your request was unsuccessful. Please contact Support Team.
            </div>                    
            <div class="modal-footer popup-footer">
                <!--<div class="col-xs-6" style="">
                </div>-->
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%" id="" type="button" data-dismiss="modal">
                        Ok
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Error Message popup ends -->

<!-- Error Message popup begins -->
<div id="LargeFileSize" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Error 
            </div>
            <div class="modal-body popup-body">
                File size too large. Please try with a smaller file.
            </div>                    
            <div class="modal-footer popup-footer">
                <!--<div class="col-xs-6" style="">
                </div>-->
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%" id="" type="button" data-dismiss="modal">
                        Ok
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Error Message popup ends -->

<!-- Validation Message popup begins -->
<div id="ValidationMessage" class="modal fade bs-example-modal-sm in" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header popup-header">
                Alert
            </div>
            <div class="modal-header popup-header">
                Please enter a value for:
            </div>
            <div class="modal-body popup-body" id="blankfields">
                
            </div>                    
            <div class="modal-footer popup-footer">
                <div class="col-xs-12" style="">
                    <a class="btn btn-default white-btn create-next-btn" style="width:100%" id="" type="button" data-dismiss="modal">
                        Ok
                    </a>
                </div>
            </div>
        </div>
    </div> 
</div>
<!-- Validation Message popup ends -->

<!--  Top Right Menu  -->
<div class="right-menu-overlay"></div>
<div class="right-menu">
    <ul class="list-group ">
        <li class="list-group-item menu-item"><a href="/SSCommunity/apex/TSSCommunityCases" target="_top">Cases</a></li>
        <li class="list-group-item menu-item"><a href="{!$Label.CTSSDocLinkHTTP}/servlet/servlet.FileDownload?file={!$Label.TSSCommunityHelpDocLabel}" target="_blank">Help</a></li>
        <li class="list-group-item menu-item"><a href="/SSCommunity/secur/logout.jsp">Logout</a></li>
      
    </ul>
</div>

</body>

<!--<script src="{!URLFOR($Resource.TSSCommunityRes,'js/jquery-2.1.1.min.js')}"></script>-->
<script src="{!URLFOR($Resource.TSSCommunityRes,'js/jquery-1.11.0.min.js')}"></script>
<script src="{!URLFOR($Resource.TSSCommunityRes,'js/bootstrap.min.js')}"></script>
<script src="{!URLFOR($Resource.TSSCommunityRes,'js/jquery-ui.js')}"></script>
<script src="{!URLFOR($Resource.TSSCommunityRes,'js/forcetk.js')}"></script>
<script src="{!URLFOR($Resource.TSSCommunityRes,'js/main.js')}"></script>
<script src="../../soap/ajax/30.0/connection.js" type="text/javascript"></script>
<script type="text/javascript">var __sfdcSessionId = '{!$Api.Session_ID}';</script>
<script type="text/javascript" src="/soap/ajax/30.0/apex.js" ></script>
<script src="{!URLFOR($Resource.TSSCommunityRes,'js/common.js' )}" type="text/javascript"></script> <!-- For Menu Slider in Mobile -->

<script>

    function setCaseDetails() {
        var validationtxt = '<ul><b>';
        var validationSuccess;
        
        var inquirytype = $('#Inquiry_Type_Details').val();
        $('[id$=InquiryTypeId]').val(inquirytype);
       // console.log('--->1' + inquirytype);
        
        var aircratftype = $('#AirId').val();
        $('[id$=AircraftTypeId]').val(aircratftype);
       // console.log('--->2' + aircratftype);
        
        var atachapter = $('#ATA_Chapter').val();
        $('[id$=ATAChapterId]').val(atachapter);
      //  console.log('--->3' + atachapter);
        
        var productid = $('#ProId').val();
        $('[id$=ProductTypeId]').val(productid);
      //  console.log('--->4' + productid);
        
        var partnumber = $('#Part_Number').val();
        $('[id$=PartNumberId]').val(partnumber);
      //  console.log('--->5' + partnumber);
        
        var subject = $('#Subject_Id').val();
        $('[id$=SubjectId]').val(subject);
      //  console.log('--->6' + subject);
        
        var description = $('#Description_Id').val();
        $('[id$=DescriptionId]').val(description);
      //  console.log('--->7' + description);
        /*
        if(productid == '') {
            validationtxt += '<li>Product type</li>';
            validationSuccess = false;
        }
        */
        if(aircratftype == '') {
            validationtxt += '<li>Aircraft type</li>';
            validationSuccess = false;
        }
        /*
        if(partnumber == '') {
            validationtxt += '<li>Part Number</li>';
            validationSuccess = false;
        }
        */
        if(subject == '') {
            validationtxt += '<li>Subject</li>';
            validationSuccess = false;
        }
        if(description == '') {
            validationtxt += '<li>Description</li>';
            validationSuccess = false;
        }
        validationtxt += '</b></ul>';
        
        if(validationSuccess == false) {
            $('#blankfields').html(validationtxt);
            $('#ValidationMessage').modal({
                show:true,
                closeOnEscape: true
            });
            return false;
        }
        invokeCreateCase();
        
    }
    
    
    //Get parameters
    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
        return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }
    
    $(document).ready(function(){
     //   GetInquiryType();   
        Get_ATA_Chapter();  
        GetInquiryTypeDetails();
        
        if(getParameterByName('error') == 1){
            $('#errorMessage').modal({
                show:true,
                closeOnEscape: true
           });
        }
        if(getParameterByName('error') == 2){
            $('#LargeFileSize').modal({
                show:true,
                closeOnEscape: true
           });
        }
    });
    
    // Page Navigate Starts
        function PageNavigatefunction (sParam) {
        var url = window.location.href;    
        if(url.indexOf("param") > -1) {  
            var sPageURL = window.location.search.substring(1);
            var sURLVariables = sPageURL.split('&');
            for (var i = 0; i < sURLVariables.length; i++) 
            {
                var sParameterName = sURLVariables[i].split('=');
                if (sParameterName[0] == sParam) 
                {
                    return sParameterName[1];
                }
            }
            getparameters();
        }
        else {
            window.location="/SSCommunity/TSSCommunityCases"; 
        }
    }
    function getparameters() {
        var SearchVar = PageNavigatefunction('search');
        var ParamVar     = PageNavigatefunction('param');
        if(ParamVar != '') {
            window.top.location="/SSCommunity/TSSCommunityCases?param="+1+"&search="+SearchVar;
        }
    }

    // Page Navigate ends
    
    
  /*  // Getting Inquiry Type Values 
    function GetInquiryType() {
        var inqType = '';
        TSS_Community_CaseCreate_Cont.GetInquiryTypeVal(function(result, event){
            if(event.type == 'exception') {
                alert(event.message);
            }
            else {
                $.each(result, function(index, value){
                
                inqType +='<option value="'+value+'">'+value+'</option>';
               // console.log(result);
                
            });
            $('#Inquiry_Type').html(inqType);
            }
        });
    }
    */
    // Getting Inquiry Type detail Values 
    function GetInquiryTypeDetails() { 
        var inqTypedetail = '';
        TSS_Community_CaseCreate_Cont.GetInquiryDetails(function(result, event){
            if(event.type == 'exception') {
                  alert(event.message);
            } else {
               // console.log('Hellos'+result);
                $.each(result, function(index, value){                    
                    inqTypedetail +='<option value="'+value+'">'+value+'</option>';                   
                });
                $('#Inquiry_Type_Details').html(inqTypedetail);   
            }
        });
    }
    
    // Get ATA Chapter
    function Get_ATA_Chapter() {
            ATAChapterVar = '';
            TSS_Community_CaseCreate_Cont.GetATA_Chapter(function(result, event){
                if(event.type == 'exception') {
                      alert(event.message);
                } 
                else {
                    $.each(result, function(index, value){
                        ATAChapterVar +='<option value="'+value+'">'+value+'</option>';    
                    });
                    $('#ATA_Chapter').html(ATAChapterVar);
                }
            });    
        }
    
    // Autopopulate feature for Contact Name, Aircraft type and Product Type
    function getDataForAutoComplete(inputFieldId, resultFieldId, objectName){   
            var Objects; 
            $('#'+ inputFieldId ).addClass('ui-autocomplete-loading');
            $('#'+ inputFieldId ).removeClass('lookup-fld');
            $('[id$='+inputFieldId+']').autocomplete({
            minLength: 2,
            source: function(request, response) {
                    queryTerm = request.term;     
                    if(objectName == 'Product_Name') {
                        TSS_Community_CaseCreate_Cont.SearchProduct(request.term, function(result, event){
                            if(event.type == 'exception') {
                                  alert(event.message);
                            } else {
                                 
                                 Objects= result;
                                 response(Objects);
                                 if(result[0] == '' || result[0] == undefined){
                                   //  console.log('Test'); 
                                     $('#'+ resultFieldId).val('');
                                 }
                            }
                        }); 
                    }  
                    
                     if(objectName == 'Aircraft') {
                        TSS_Community_CaseCreate_Cont.SearchAircraft(request.term, function(result, event){
                            if(event.type == 'exception') {
                                  alert(event.message);
                            } else {
                              //   console.log(result[0]); 
                                 Objects= result;
                                 response(Objects);
                                 if(result[0] == '' || result[0] == undefined){
                                     $('#'+ resultFieldId).val('');
                                 }
                            }
                        }); 
                    }                             
               },
        focus: function( event, ui ) {
                $('[id$='+inputFieldId+']').val( ui.item.Name );
                return false;
                },
        select: function( event, ui ) {
                    $('[id$='+inputFieldId+']').val(convertToHtml( ui.item.Name ));
                    $('[id$='+resultFieldId+']').val(convertToHtml( ui.item.Id ));
                    return false;
                },
         }).data( "ui-autocomplete" )._renderItem = function( ul, item ) {           
            var entry = "<a>" + item.Name;
            entry = entry + "</a>";
            entry = entry.replace(queryTerm, "<b>" + queryTerm + "</b>");
            return $( "<li></li>" )
                .data( "ui-autocomplete-item", item )
                .append( entry )
                .appendTo( ul );
        };
        $('#'+ inputFieldId ).removeClass('ui-autocomplete-loading');
        $('#'+ inputFieldId ).addClass('lookup-fld');
        }
        
        // Case Create method
        var CaseId = '';
        /*function CreateCase() {
            $('.tss-loader').modal({
                        show:true,
                        closeOnEscape: true
                   });
           // $(".tss-loader").show();
            var Inquiry_Type_Details_var = document.getElementById('Inquiry_Type_Details').value;                        
            var Product_TypeId_var = document.getElementById('ProId').value;
            var Part_Number_var = document.getElementById('Part_Number').value;
            var Subject_Id_var = document.getElementById('Subject_Id').value;
            var Description_Id_var = document.getElementById('Description_Id').value;
            var Aircraft_TypeId_var = document.getElementById('AirId').value;
            var ATA_Chapter_var = document.getElementById('ATA_Chapter').value;           
            TSS_Community_CaseCreate_Cont.CreateCase(Inquiry_Type_Details_var,
            Product_TypeId_var,Part_Number_var,Subject_Id_var,Description_Id_var,
            Aircraft_TypeId_var,ATA_Chapter_var,
            function(result, event){                
                if(event.type == 'exception') {
                      alert(event.message);
                } else {
                    $('.tss-loader').modal("hide");
                   // $(".tss-loader").hide();
                    $('#ThankYouPopup').modal({
                        show:true,
                        closeOnEscape: true
                   });
                    CaseId = result.Id;
                    //alert(CaseId);
                    uploadFile();
                }
            });
        }*/
        
        function uploadFile() {
            var file = document.getElementById('fileToUpload').files[0];
            //alert('here');
            if(file == undefined){
               // $('#fileSelection_popup').modal({
               //     show:true,
               //     closeOnEscape: true
               // });
               alert('Please Select a file');
                
            } else {   
                if (file.size > (25 * 1024 * 1024)) {
                    alert('File too large, greater than 25MB');
                   // $('#fileSize_popup').modal({
                   //     show:true,
                   //     closeOnEscape: true
                   // });
                    return;
                } 
           
                setTimeout(  function() {
                    var reader = new FileReader();
                    reader.onload = loaded;
                    //reader.onerror = errorHandler;
                    reader.readAsDataURL(file); 
                } , 1000 );
            }         
        }
        
        function loaded(evt) {
            var filename = document.getElementById('fileToUpload').files[0].name;
            var fileContent = String(evt.target.result);
            fileContent = fileContent.substr(fileContent.indexOf(',') + 1);
            //uploadContentVersion(filename, fileContent);
            uploadAttachment(filename, fileContent);
        }
        
        //var forcetkClient = new forcetk.Client();
        var fileUrl ='';
        var fileUploading = false;
        var fileBody;
        var fileNameText = '';
        //forcetkClient.setSessionToken('{!$Api.Session_ID}');
        
        function uploadAttachment(filename, filecontent) {
            if(CaseId != null && CaseId != ''){
                var attach = new sforce.SObject('Attachment');
                attach.Name= filename;
                
                attach.ParentId = CaseId; 
                attach.Body = filecontent;
                var results = sforce.connection.create([attach]);
                for (var i = 0; i < results.length; i++) {
                    if (results[i].getBoolean("success")) {
                        alert('New Attachment record created:' + results[i].id);
                    }
                    else {
                        alert('Failed:' + results[i]);
    
                    }
                }
            }
        }
        
        
        /*function uploadContentVersion(filename, filecontent) {
            fileBody = filecontent;
            fileNameText = filename;
            fileUploading = true;
            
            if(CaseId != null && CaseId != ''){       
                forcetkClient.create('Attachment', {
                    "ParentId": CaseId,
                    "Name": fileNameText,
                    "Body": fileBody
                }, function(data) {
                       
                    
                        
                },function(error) {
                       
                       if(error.statusText == "Created"){
                           
                           alert('Created');
                       }else{
                           alert(JSON.stringify(error));
                       }
                });
            }
    
        }*/
    $('#RedirectOkButton').click(function(){        
        //window.location.href = "/SSCommunity/TSSCommunityCases"; 
        //return true;   
    })
    
    
    // Convert to HTML Starts
    
    var convertToHtml = function(convert){
        return $("<span />", { html: convert }).text();
    };
    
    // Convert to HTML Ends
    
    function OpenHelpPopup() {
       window.showModalDialog("/SSCommunity/TSSCommunityFAQ");        
    }
    
</script>

</html>
</apex:page>
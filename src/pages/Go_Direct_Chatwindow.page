<apex:page showHeader="false" controller="liveagent_chatterclass"  pageStyle="overflow-y:auto;">
    <apex:pageMessages id="msgs"/>
    <apex:includeScript value="{!$Resource.Cookies}"/>
    <style type="text/css">
    #liveAgentChatLog { 
        border: 1px solid #000;
        width: 400px;
        height: 300px;
    }
    #j_id0:j_id33:j_id37:j_id38:j_id51:j_id52
    {
        float:right;clear:both;
    }
    body .bPageBlock, body #bodyCell .bResource .secondaryPalette, body .secondaryPalette.bPageBlock, body .individualPalette .secondaryPalette.bPageBlock, body .bodyDiv .genericTable, body .genericPageBlockTable, body .bodyDiv .bSubBlock, body .bComponentBlock .bPageBlock, body .bMyDashboard .bPageBlock, body.rlHoverFrame .bPageBlock, body.subjectSelectionPopup div.choicesBox, body.lookupTab .secondaryPalette.bPageBlock, body.popupTab .secondaryPalette.bPageBlock, body.UserTagStatsPage .secondaryPalette.bPageBlock {
        background-color: #FFFFFF;
        border-bottom: 1px solid #eaeaea;
        border-left: 1px solid #eaeaea;
        border-right: 1px solid #eaeaea;
        -moz-border-radius: 4px;
        -webkit-border-radius: 4px;
        border-radius: 0px;
    }
    #liveAgentChatLog {
        border: 1px solid #ccc !important;
        width: 100% !important;
        
    }
    span.client {
        background: #deeff9;
        width: 100%;
        font-family: 'Arial','Helvetica',sans-serif;
        margin-top: 10px;
    }
    span.operator {
        //background: #deeff9;
        width: 100%;
        font-family: 'Arial','Helvetica',sans-serif;
        margin-top: 10px;
    }
    button.liveAgentChatElement.liveAgentSendButton {
        float: right;
        font-size: .9em;
        height: 27px;
        margin-top: 8px;
        margin-right: 13px;
        margin-bottom: 10px;
        margin-left: 5px;
        padding-top: 0;
        padding-right: 10px;
        padding-bottom: 0;
        padding-left: 10px;
        -moz-border-radius: 3px;
        border-radius: 3px;
        background: #edeff1;
        border: 1px solid #e2e8ed;
    }
    span.liveAgentQueuePosition:empty::before { content: '1'; }
    </style>
    <apex:includeScript value="{!$Resource.jquery}"/>
    <script src="/soap/ajax/15.0/connection.js" type="text/javascript"></script>
    <script src="/soap/ajax/15.0/apex.js" type="text/javascript"></script>
    <apex:stylesheet value="{!URLFOR($Resource.GoDirectStatic, 'Godirect.css')}"/>
    <script>
        var varVal;
        var appname=navigator.appName;
        var clearvalue=null;
        var queuevalue=null;
        $(document).ready(function() 
        {
            setInterval(checkFetchHWProdIndxSearchResultProcess, (0.1 * 1000))
            clearvalue=setInterval(accept, (0.1 * 1000))      
            if($('button.liveAgentSendButton').length>0)
            {
            /*$("#liveAgentChatInput").css('display','none');*/
            $(".liveAgentSendButton").click(function(){
            document.getElementById("j_id0:j_id32:j_id36:j_id37:j_id57:txt1").value='';
            });
            }
            varVal = Get_Cookie('Reason'); 
            //var xyz = j$('id$=Queueposition]');
                 //alert('test'); 
        });
        function checkFetchHWProdIndxSearchResultProcess()
        {
            $(".operator").find('Strong').html('Godirect Specialist:');
        }           
        function accept()
        {           
            if($(".operator").find('Strong').length>0)
            {    
                $("#waitingMessage").css('display','none');
                document.getElementById("liveAgentChatInput").value='"'+varVal+'"';
                SfdcApp.LiveAgent.Chasitor.sendMessage();
                clearInterval(clearvalue);
            }
        }
        function savetext()
        {
            var url = 'https://c.la2c1cs.salesforceliveagent.com/content'+"/s/transcriptDownload";
            var textLog = "";
            var tex=document.getElementById("liveAgentChatLog");
            var textval;
            if (tex)
            {
                if ( tex.textContent )
                { 
                    textval=tex.textContent ;
                    textval=textval.replace(/Go Direct Flight Specialist:/g,"\n Go Direct Flight Specialist:");
                    textLog=textval.replace(/You:/g,"\n You:");
                }
                else
                {
                    textval=tex.innerText;  //alert ( divObj.innerHTML );
                    textval=textval.replace(/Go Direct Flight Specialist:/g,"\n Go Direct Flight Specialist:");
                    textval =textval.replace(/You:/g,"\n You:");
                    textLog=textval.replace("You've ended the chat.","");
                } 
            }  
            var curDate = new Date();
            var month;
            if ((curDate.getMonth() + 1 ) < 10 ) 
            {
                month = '0'+String(curDate.getMonth() + 1);
            } 
            else 
            {
                month = String(curDate.getMonth() + 1);
            }
            var date;
            if ( curDate.getDate() < 10 ) 
            {
                date = '0'+String(curDate.getDate());
            } 
            else 
            {
            date = String(curDate.getDate());
            }
            var year = String(curDate.getFullYear());
            var iframe = document.createElement("iframe");
            iframe.style.display = "none";
            iframe.name = (new Date().getTime())+'_'+Math.random();
            document.body.appendChild(iframe);
            Sfdc.Event.add(iframe, "load", function() {
            iframe.parentNode.removeChild(iframe);
            form.parentNode.removeChild(form);
            });
            var form = document.createElement('form');
            form.style.display = 'none';
            form.method = "POST";
            form.action = url;
            form.target = iframe.name;
            document.body.appendChild(form);
            var fields = {
            type: 'clientjs',
            text: textLog,
            name: month+date+year+'_transcript.txt'
            };
            for (var name in fields) {
            var input = document.createElement('input');
            input.type = 'hidden';
            input.name = name;
            input.value = fields[name];
            form.appendChild(input);
            }
            form.submit();
        }    
     function test()
     {
      var txtVal1 = document.getElementById("j_id0:j_id32:j_id36:j_id37:j_id57:txt1").value;
      document.getElementById("liveAgentChatInput").value=txtVal1 ;
     }
     
     function end()
     {
     SfdcApp.LiveAgent.Chasitor.endChat();
      document.getElementById("j_id0:j_id32:j_id36:j_id37:j_id57:txt1").style.display="none";
      document.getElementById("j_id0:j_id32:j_id36:j_id37:j_id50:end").style.display="none";
     }
     function checkenter(e) {
        if (e.keyCode == 13) {
            var txtVal1 = document.getElementById("j_id0:j_id32:j_id36:j_id37:j_id57:txt1").value;
            document.getElementById("liveAgentChatInput").value=txtVal1 ;
            document.getElementById("j_id0:j_id32:j_id36:j_id37:j_id57:txt1").value='';
            SfdcApp.LiveAgent.Chasitor.sendMessage();
            return false;
        }
    }
    </script>
    <style>
        #liveAgentClientChat.liveAgentStateWaiting {
            // The CSS class that is applied when the chat request is waiting to be accepted
            // See "Waiting State" screenshot below
        }
        #liveAgentClientChat {
            // The CSS class that is applied when the chat is currently engaged
            // See "Engaged State" screenshot below
        }
        #liveAgentClientChat.liveAgentStateEnded {
            // The CSS class that is applied when the chat has ended
            // See "Ended State" screenshot below
        }
        body { overflow: hidden; width: 100%; height: 100%; padding: 0; margin: 0 }
        #waitingMessage { height: 100%; width: 100%; vertical-align: middle; text-align: center;display: none; }
        #liveAgentClientChat.liveAgentStateWaiting #waitingMessage { display: table; }
        #liveAgentSaveButton, #liveAgentEndButton { z-index: 2; }
        .liveAgentChatInput {
        height: 25px;
        border-width: 1px;
        border-style: solid;
        border-color: #000;
        padding: 2px 0 2px 4px;
        background: #fff;
        display: block;
        width: 99%;
        }
        #liveAgentChatLog {
        width: auto;
        height: auto;
        top: 0px;
        position: absolute;
        overflow-y: auto;
        left: 0;
        right: 0;
        bottom: 0;
        }
        .liveAgentSaveButton {
            background-color: #6D7391;
            color: #fff;
            display: inline-block;
            float: left;
            margin: 5px 10px 5px 10px;
            border-radius: 3px;
            font-size: 1em;
            padding: 2px 8px;
        }
        .liveAgentEndButton {
            float: right;
            border-radius: 3px;
            background-color: #C14251;
            display: inline-block;
            color: #fff;
            margin: 5px 10px 5px 10px;
            font-size: 1em;
            padding: 2px 8px;
        }
        .liveAgentSendButton {
            background-color: #26AF3A !important;
            display: inline-block;
            padding: 0.3rem !important;
            width: 50px;
            font-size: 1em;
            font-family: Arial;
            border-radius: 3px;
            border-width: 0px;
            color: #fff;
            margin: 5px 10px 5px 0px;
            right: -67px;
            top: 0px;
            position: absolute;
        }
        .liveAgentCancelButton {
            top: 54%;
            display: none;
            background-color: #6D7391;
            color: #fff;
            border-radius: 3px;
            padding: 4px 8px;
            font-size: 1.3em;
        }
        body button, body .x-btn, body .btn, body .btnDisabled, body .btnCancel, body .menuButton .menuButtonButton {
            background: none !important;
        }
        button.liveAgentChatElement.liveAgentEndButton {
            background: none !important;
            background-color: #C14251 !important;
        }
        button.liveAgentChatElement.liveAgentEndButton {
            background: none !important;
            background-color: #C14251 !important;
        }
        button#liveAgentSaveButton {
            background: none !important;
            background-color: #6D7391 !important;
        }
    </style>
    <div style="top: 0; left: 0; right: 0; bottom: 0; position: absolute;">
        <!-- <div id="waitingMessage" class="modal">
            <center>
                <br/><br/>
                <h3>You are now being connected to an agent.</h3>
                <img alt="Progress Bar" src="https://1.la2c1cs.salesforceliveagent.com/content/images/html_progress_bar.gif"/>
            </center>
        </div> -->
        <center><apex:image value="{!$Resource.GoDirectlogo}" width="240" height="75" /><br/></center>
        <liveAgent:clientChat >
            <liveAgent:clientChatSaveButton />
            <liveAgent:clientChatEndButton />
            <div style="top:100px; left: 5px; right: 5px; bottom: 5px; position: absolute; z-index:0;">
                <liveAgent:clientChatAlertMessage />
                <liveAgent:clientChatStatusMessage />               
                <table id="waitingMessage" cellpadding="0" cellspacing="0">
                    <tr>
                        <td>
                            <div id="wait_text">
                            <!-- <strong>Please hold while we connect you to an agent.</strong> -->
                            <center>                                
                                <br/><br/>
                                <h3>You are now being connected to an agent.</h3>
                                <br/>
                                <img alt="Progress Bar" src="https://c.la2c1cs.salesforceliveagent.com/content/images/html_progress_bar.gif"/>
                                <br/>
                                 <h3>
                                    You are currently number<liveAgent:clientChatQueuePosition id="Queueposition" />in queue.
                                </h3> 
                            </center>
                            </div>                                 
                        </td>
                    </tr>
                </table>
                <div style="top: 0px; right: 0; bottom: 41px; left: 0; padding: 0; position: absolute;word-wrap: break-word; z-index: 0;">
                    <liveAgent:clientChatLog />
                </div>
                <div style="position: absolute; height: auto; right: 0; bottom: 0; left: 0; margin-right:67px;">
                    <liveagent:clientChatInput />
                    <liveAgent:clientChatSendButton />
                </div>
            </div>
        </liveAgent:clientChat>
    </div>
    <apex:insert name="footer">
        <c:honeywellFooter1 />
</apex:insert>

</apex:page>
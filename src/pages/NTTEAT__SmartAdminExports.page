<apex:page controller="NTTEAT.AccessSetup_ExportController" readOnly="true" setup="true" >
    <style>
        .container
        {
        //  margin:2%;  
        min-height:400px;
        border:1px solid #ccc;
        border-radius:4px;
        font-family:verdana !important;
        }
        .headerDiv
        {
        // padding:5px;        
        // height:50px;
        text-align:left;
        background:#31AFCD;   
        border:0px;
        padding:1.3%;
        }
        .headerDiv h3
        {
        color:White;
        font-size:1.5em;
        
        }
    </style>
    <apex:slds />
    
    <body class="slds-scope">
        <div class="container" >
            <div class="headerDiv" >
                <!--  <img src="{!URLFOR($Asset.SLDS, 'assets/icons/standard/account_60.png')}" alt="Account Standard Icon" />  -->
                <apex:image url="{!$Resource.NTTEAT__SmartAdminLogo}" style="border-radius:25px;" />
                <h3>A place where all admin works</h3>
                <span style="float:right;color:white;" title="Help">  </span> 
            </div>
            <div class="resultsCont" >
                
                <div class="slds-box" >
                    <h2 style="font-size:1.5em;">
                        Exporting Acceses
                    </h2>
                </div>
                 <apex:actionStatus id="actStatusId" >
                     <apex:facet name="start" >
                         <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.1; z-index: 1000; background-color: black;">
                             &nbsp;
                         </div>
                         <!--        <div style="position: fixed; left: 0; top: 0; bottom: 0; right: 0; z-index: 1001;opacity:1;  margin-left:45%; margin-top:10%;">
<img width="100" height="100" src="{!$Resource.AccessPOC_Loading}" />  
</div>   -->
                         <div class="demo-only" style="height: 6rem;margin-top:15%;position:fixed;margin-left:40%;">
                             <div role="status" class="slds-spinner slds-spinner_brand slds-spinner_medium">
                                 <span class="slds-assistive-text">Loading</span>
                                 <div class="slds-spinner__dot-a"></div>
                                 <div class="slds-spinner__dot-b"></div>
                             </div>
                         </div>
                     </apex:facet>                     
        
    </apex:actionStatus>
                <apex:form id="formid">
                    <div style="padding-left:10%;padding-right:10%;">
                        <label class="slds-form-element__label" style="color:blue;" for="select-01">Objects </label>
                        <apex:selectList styleClass="slds-select" value="{!objectName}" disabled="{!permissionSetName !='none' && permissionSetName !=null}"      multiselect="false" size="1" >
                            <apex:selectOption ItemLabel="--Select--" Itemvalue="none"></apex:selectOption>  
                             
                            <apex:selectOptions value="{!objOptionList}" ></apex:selectOptions>                                  
                               <apex:actionSupport status="actStatusId"   event="onchange"  reRender="formid"  />
                        </apex:selectList> 
                        <label class="slds-form-element__label"  style="color:blue;"  for="select-01">Profiles &amp; PermissionSets</label>
                        <apex:selectList styleClass="slds-select" value="{!permissionSetName}" disabled="{!objectName !='none' && objectName !=null}"    multiselect="false" size="1" >
                            <apex:selectOption ItemLabel="--Select--" Itemvalue="none"></apex:selectOption>                                    
                            <apex:selectOptions value="{!profOptionList}" ></apex:selectOptions>                                  
                             <apex:actionSupport status="actStatusId"  event="onchange"  reRender="formid"  />
                        </apex:selectList> 
                        
                        <label class="slds-form-element__label" for="select-01">Objects/Profiles Per Report</label>
                        <apex:inputText styleClass="slds-input" label="Objects Per Report" value="{!pageLimt}" ></apex:inputText>
                        <!--   <label class="slds-form-element__label" for="select-01">Reports Count</label>
<apex:selectList styleClass="slds-input" multiselect="false" size="1" >
<apex:selectOptions value="{!objectCountPerReport}"></apex:selectOptions>
</apex:selectList>  -->
                        <apex:commandButton status="actStatusId"  styleClass="slds-button slds-button_brand" value="Go" action="{!initialLoad}" reRender="formid,blokId" >
                            <apex:param value="true" name="splitter" />
                        </apex:commandButton>
                    </div>
                    
             <!--       <div class="slds-box" style="font-color:red !important;">
                        Selected Objects :{!SelectedobjOptionList}
                        
                    </div>
                    <div class="slds-box">
                        Selected Profiles &amp; PermissionSets :{!SelectedprofOptionList}
                        
                    </div>  -->
                    <br/>
                    
                    <apex:pageBlock id="blokId" >
                        
                        <apex:pageblockTable value="{!objectCountPerReport}" var="rec">
                            <apex:column headerValue="Object/profile Ranges" value="{!rec.label}" />
                            
                            <apex:column headerValue="File Link as PDF"  >
                                <apex:commandLink target="_blank" action="{!redirectToexport}" value="Download As PDF" >
                                    <apex:param value="{!rec.value}" name="SR" />
                                    <apex:param value="{!pageLimt}" name="perLimit" />
                                    <apex:param value="pdf" name="filetype" />
                                </apex:commandLink>
                            </apex:column>
                            <apex:column headerValue="File Link as Excel"  >                                                                
                                <apex:commandLink target="_blank" action="{!redirectToexport}" value="Download As Excel" >                                                                      
                                    <apex:param value="{!rec.value}" name="SR" />
                                    <apex:param value="{!pageLimt}" name="perLimit" />
                                    <apex:param value="excel" name="filetype" />
                                </apex:commandLink>
                            </apex:column>
                        </apex:pageblockTable>
                    </apex:pageBlock>
                </apex:form>
            </div>
        </div>
    </body>
</apex:page>
<apex:page standardController="Z_Task__c" extensions="NewZtaskPageCls" id="page">
    <apex:pagemessages />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script> 
    <script>
        $(document).ready(function(){                           
            var othersubtype='';
            othersubtype=document.getElementById("page:form:newsec:sec:subtype:OTHERshorttext1").value;
            //alert(othersubtype);
            var subtype='';
            subtype=document.getElementById("page:form:newsec:sec:subtype").value;
            

            //alert(subtype);
            if(
            //othersubtype != 'undefined' && othersubtype != '' &&  othersubtype != null && subtype != null && 
            subtype == 'Other')
            {
                //document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext1').style.display = 'block';
                document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext1').style.display = 'block';
                document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').style.display = 'none';
                document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').value = "";
            }
            else
            {
                if((subtype = '--None--') || (subtype = ''))
                {         
                    //alert('inside subtype');
                    var  othershorttext=document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').value;
                   // alert(othershorttext);                        
                    document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').value = "";
                    document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').style.display = 'none';
                    document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext1').style.display = 'none';
                    //CallApexMethod();
                }
                else
                {
                document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext1').style.display = 'none';
                }
            }
            var status=document.getElementById("page:form:newsec:sec:j_id34");
            //alert('status---'+status.length);
            status.remove(2);                   
        });
        function changeshorttext()
        {           
            console.log("inside changeshortttext");
            var subtype=document.getElementById("page:form:newsec:sec:subtype").value;          
            if(subtype != 'Other')       
            {   
                //alert('inside if');
                console.log("inside if");
                //alert('inside if subtype'+subtype);
                if((subtype = '--None--') || (subtype = ''))
                {         
                    //alert('inside subtype');
                    var  othershorttext=document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').value;
                   // alert(othershorttext);                        
                    document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').value = "";
                    document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').style.display = 'none';
                    document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext1').style.display = 'none';
                    CallApexMethod();
                }
                else
                {
                    CallApexMethod() ;
                    document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext1').style.display = 'none';
                    document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext1').value = ""; 
                }                
            }
            else
            {         
              //alert('inside else');  
              console.log("inside else");             
              document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').value = "";
              document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext2').style.display = 'none';
              document.getElementById('page:form:newsec:sec:subtype:OTHERshorttext1').style.display = 'block';
              CallApexMethod();
            }
        }
    </script>   
    <apex:form id="form">
        <apex:actionFunction name="CallApexMethod" action="{!changeshorttext}"  /> 
        <apex:sectionheader title="New Task" subtitle="{!ZTask.Type__c}"></apex:sectionheader>
        <apex:pageblock mode="edit" id="newsec"  >
            <apex:pageblockbuttons >   
                <apex:commandButton value="Save" action="{!CustomSave}" id="theButton"  /> 
                <apex:commandbutton action="{!cancel}" value="Cancel" ></apex:commandbutton>
            </apex:pageblockbuttons>
            <apex:pageblocksection title=" Information" id="sec" columns="1">
                <apex:inputfield value="{!ZTask.Type__c}"  /> 
                
                <apex:inputfield value="{!ZTask.Sub_Type__c}"  id="subtype" onchange="changeshorttext();return false;">
                    <!-- <apex:actionSupport event="onchange" onclick="changeshorttext();return false;" /> -->
                    <apex:actionSupport event="onchange" rerender="form"/> 
                   <br/><br/><apex:outputfield value="{!ZTask.Short_Text__c}" id="OTHERshorttext2"/>
                    <apex:inputfield value="{!ZTask.Other_Short_Text__c}"  id="OTHERshorttext1"/>
                </apex:inputfield>
                <apex:inputField rendered="{!IF(ZTask.Sub_Type__c='Request Re-quote' && ZTask.Type__c='Z141 Shop Action Required',true,false)}"
                 value="{!ZTask.Requote_Reason__c}"/>
                <apex:inputfield value="{!ZTask.Comments__c}"  style="width: 30%;" />  
                <apex:inputfield value="{!ZTask.Status__c}"  />              
            </apex:pageblocksection>  
        </apex:pageblock>     
    </apex:form>
</apex:page>
<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Send_response_to_customer_notifying_that_status_of_feedback_is_changed_to_closed</fullName>
        <ccEmails>Raeid.Ishoop@Honeywell.com</ccEmails>
        <description>Send response to customer notifying that status of feedback is changed to closed</description>
        <protected>false</protected>
        <recipients>
            <type>creator</type>
        </recipients>
        <senderAddress>yourresponse@honeywell.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>unfiled$public/MyAerospace_Article_when_Feedback_is_closed</template>
    </alerts>
    <alerts>
        <fullName>Send_response_to_customer_thanking_for_feedback_submission</fullName>
        <ccEmails>Raeid.Ishoop@Honeywell.com</ccEmails>
        <description>Send response to customer thanking for feedback submission</description>
        <protected>false</protected>
        <recipients>
            <field>Contact__c</field>
            <type>contactLookup</type>
        </recipients>
        <recipients>
            <field>Interviewer_Name__c</field>
            <type>userLookup</type>
        </recipients>
        <senderAddress>yourresponse@honeywell.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>unfiled$public/MyAerospace_Article_Feedback</template>
    </alerts>
    <fieldUpdates>
        <fullName>Clear_Locked_Field</fullName>
        <field>Locked__c</field>
        <literalValue>0</literalValue>
        <name>Clear Locked Field</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Recommend_Service_Center_value_update</fullName>
        <field>Recommend_Service_Center_value__c</field>
        <formula>CASE(Recommend_Service_Cent__c,
&quot;1&quot;, 1,
&quot;2&quot;, 2,
&quot;3&quot;, 3,
&quot;4&quot;, 4,
&quot;5&quot;, 5,
&quot;6&quot;, 6,
&quot;7&quot;, 7,
&quot;8&quot;, 8,
&quot;9&quot;, 9,
&quot;10&quot;, 10,
0)</formula>
        <name>Recommend Service Center value update</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Set_Lock_Field</fullName>
        <field>Locked__c</field>
        <literalValue>1</literalValue>
        <name>Set Lock Field</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Set_Lock_Field_False</fullName>
        <field>Locked__c</field>
        <literalValue>0</literalValue>
        <name>Set Lock Field False</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Set_Lock_Field_True</fullName>
        <field>Locked__c</field>
        <literalValue>1</literalValue>
        <name>Set Lock Field True</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Set_Record_Type_Read_Only</fullName>
        <field>RecordTypeId</field>
        <lookupValue>VOC</lookupValue>
        <lookupValueType>RecordType</lookupValueType>
        <name>Set Record Type Read Only</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Unlock_Record</fullName>
        <field>RecordTypeId</field>
        <lookupValue>VOC</lookupValue>
        <lookupValueType>RecordType</lookupValueType>
        <name>Unlock Record</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Lock_Field_False</fullName>
        <field>Locked__c</field>
        <literalValue>0</literalValue>
        <name>Update Lock Field False</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Locked</fullName>
        <field>Locked__c</field>
        <literalValue>1</literalValue>
        <name>Update Locked</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Locked_Flag</fullName>
        <field>Locked__c</field>
        <literalValue>1</literalValue>
        <name>Update Locked Flag</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_New_Overall_Score</fullName>
        <description>Update &apos;New Overall Score&apos;</description>
        <field>New_Overall_Score__c</field>
        <formula>if((Score__c==0||ISNULL(Score__c)) &amp;&amp; (Score1__c==0||ISNULL(Score1__c))&amp;&amp; (Score2__c==0||ISNULL(Score2__c)) &amp;&amp; (Score3__c==0||ISNULL(Score3__c)),0,
if(((Score__c==0||ISNULL(Score__c)) &amp;&amp; (Score1__c==0||ISNULL(Score1__c)) &amp;&amp; (Score2__c==0||ISNULL(Score2__c))),(Score3__c),
if(((Score__c==0||ISNULL(Score__c)) &amp;&amp; (Score2__c==0||ISNULL(Score2__c)) &amp;&amp; (Score3__c==0||ISNULL(Score3__c))),(Score1__c),
if(((Score__c==0||ISNULL(Score__c)) &amp;&amp; (Score1__c==0||ISNULL(Score1__c)) &amp;&amp; (Score3__c==0||ISNULL(Score3__c))),(Score2__c),
if(((Score1__c==0||ISNULL(Score1__c)) &amp;&amp; (Score2__c==0||ISNULL(Score2__c)) &amp;&amp; (Score3__c==0||ISNULL(Score3__c))),(Score__c),
if(((Score2__c==0||ISNULL(Score2__c)) &amp;&amp; (Score__c==0||ISNULL(Score__c))),((Score1__c+Score3__c)/2),
if(((Score2__c==0||ISNULL(Score2__c)) &amp;&amp; (Score1__c==0||ISNULL(Score1__c))),((Score__c+Score3__c)/2),
if(((Score2__c==0||ISNULL(Score2__c)) &amp;&amp; (Score3__c==0||ISNULL(Score3__c))),((Score__c+Score1__c)/2),
if(((Score__c==0||ISNULL(Score__c)) &amp;&amp; (Score1__c==0||ISNULL(Score1__c))),((Score2__c+Score3__c)/2),
if(((Score__c==0||ISNULL(Score__c)) &amp;&amp; (Score2__c==0||ISNULL(Score2__c))),((Score1__c+Score3__c)/2),
if(((Score__c==0||ISNULL(Score__c)) &amp;&amp; (Score3__c==0||ISNULL(Score3__c))),((Score2__c+Score1__c)/2),
if(((Score1__c==0||ISNULL(Score1__c)) &amp;&amp; (Score__c==0||ISNULL(Score__c))),((Score2__c+Score3__c)/2),
if(((Score1__c==0||ISNULL(Score1__c)) &amp;&amp; (Score2__c==0||ISNULL(Score2__c))),((Score__c+Score3__c)/2),
if(((Score1__c==0||ISNULL(Score1__c)) &amp;&amp; (Score3__c==0||ISNULL(Score3__c))),((Score__c+Score2__c)/2),
if((Score__c==0||ISNULL(Score__c)),((Score1__c+Score2__c+Score3__c)/3),
if((Score1__c==0||ISNULL(Score1__c)),((Score__c+Score2__c+Score3__c)/3),
if((Score2__c==0||ISNULL(Score2__c)),((Score__c+Score1__c+Score3__c)/3),
if((Score3__c==0||ISNULL(Score3__c)),((Score__c+Score2__c+Score1__c)/3),
((Score__c+Score1__c+Score2__c+Score3__c)/4)))))))))))))))))))</formula>
        <name>Update &apos;New Overall Score&apos;</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Overall_Satisfaction_val</fullName>
        <field>Overall_Satisfaction_VOCSurvey__c</field>
        <formula>if( Overall_Satisfaction_Value__c &gt;= 92,&quot;Blue - Best in Class&quot;,
if( Overall_Satisfaction_Value__c &gt;= 87 &amp;&amp; Overall_Satisfaction_Value__c&lt; 92,&quot;Green - Satisfied&quot;,
if( Overall_Satisfaction_Value__c &gt;= 82 &amp;&amp; Overall_Satisfaction_Value__c&lt; 87,&quot;Yellow - Somewhat Dissatisfied&quot;,
if( Overall_Satisfaction_Value__c &gt;=9 &amp;&amp; Overall_Satisfaction_Value__c&lt; 82,&quot;Red - Very Dissatisfied&quot;,null


     )
)

)
)</formula>
        <name>Update Overall Satisfaction val</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Read_Only</fullName>
        <field>RecordTypeId</field>
        <lookupValue>VOC_Read_Only</lookupValue>
        <lookupValueType>RecordType</lookupValueType>
        <name>Update Read Only</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Read_Only_Record</fullName>
        <field>RecordTypeId</field>
        <lookupValue>VOC_Read_Only</lookupValue>
        <lookupValueType>RecordType</lookupValueType>
        <name>Update Read Only Record</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Read_Only_Record_Type</fullName>
        <field>RecordTypeId</field>
        <lookupValue>VOC_Read_Only</lookupValue>
        <lookupValueType>RecordType</lookupValueType>
        <name>Update Read Only Record Type</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Record_Editable</fullName>
        <field>RecordTypeId</field>
        <lookupValue>VOC</lookupValue>
        <lookupValueType>RecordType</lookupValueType>
        <name>Update Record Editable</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Record_Read</fullName>
        <field>RecordTypeId</field>
        <lookupValue>VOC_Read_Only</lookupValue>
        <lookupValueType>RecordType</lookupValueType>
        <name>Update Record Read</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Record_Type_Read_Only</fullName>
        <field>RecordTypeId</field>
        <lookupValue>VOC_Read_Only</lookupValue>
        <lookupValueType>RecordType</lookupValueType>
        <name>Update Record Type Read Only</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>LookupValue</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_VOC_Card_Number</fullName>
        <description>Update VOC Card Number</description>
        <field>Duplicate_VOC_Card_Check__c</field>
        <formula>TEXT(Account__r.CBT__c) + &apos; &apos; + TEXT(Account__r.Strategic_Business_Unit__c) + &apos; &apos; + Account__c + &apos; &apos; + TEXT(Prod_LN_Prgm_Product_LIne__c) + &apos; &apos; + TEXT( Year__c) + &apos; &apos; +TEXT( Quarter__c)</formula>
        <name>Update VOC Card Number</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <rules>
        <fullName>Check Duplicate VOC Card Number</fullName>
        <actions>
            <name>Update_VOC_Card_Number</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <booleanFilter>1 OR 2</booleanFilter>
        <criteriaItems>
            <field>Feedback__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>VOC</value>
        </criteriaItems>
        <criteriaItems>
            <field>Feedback__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>VOC Read Only</value>
        </criteriaItems>
        <description>Check Duplicate VOC Card Number</description>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>New Overall Score</fullName>
        <actions>
            <name>Update_New_Overall_Score</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>New Overall Score</description>
        <formula>IF(ISNEW(), true,  OR( Score__c != PriorValue(Score__c ), Score1__c != PriorValue(Score1__c ), Score2__c != PriorValue(Score2__c ), Score3__c != PriorValue(Score3__c ), ISNULL(Score__c), ISNULL(Score1__c), ISNULL(Score2__c), ISNULL(Score3__c) ) )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Recommend Service Center value generation</fullName>
        <actions>
            <name>Recommend_Service_Center_value_update</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Feedback__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>CP Operator Survey</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Send response on submission of feedback of knowledgw article</fullName>
        <actions>
            <name>Send_response_to_customer_thanking_for_feedback_submission</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <formula>(ISNEW() || (ISCHANGED( Was_Article_Helpful__c ) )||(ISCHANGED(  Customer_Feedback__c) )) &amp;&amp; RecordType.Name = &apos;Article Feedback&apos;</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Send response when feedback of knowledgw article is closed</fullName>
        <actions>
            <name>Send_response_to_customer_notifying_that_status_of_feedback_is_changed_to_closed</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <description>When status of feedback will be changed from open, in progress to Closed, email will be fired</description>
        <formula>ISCHANGED( Status__c ) &amp;&amp; ISPICKVAL(Status__c, &apos;Closed&apos;) &amp;&amp; RecordType.Name = &apos;Article Feedback&apos;</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Update Lock Field for Admin Profiles</fullName>
        <actions>
            <name>Clear_Locked_Field</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Set_Record_Type_Read_Only</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Feedback__c.Locked__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <criteriaItems>
            <field>User.ProfileId</field>
            <operation>contains</operation>
            <value>admin</value>
        </criteriaItems>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>VOC Update Record Editable</fullName>
        <actions>
            <name>Set_Lock_Field_False</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Record_Editable</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Feedback__c.Report_Flag__c</field>
            <operation>equals</operation>
            <value>False</value>
        </criteriaItems>
        <criteriaItems>
            <field>Feedback__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>VOC Read Only</value>
        </criteriaItems>
        <criteriaItems>
            <field>Feedback__c.Locked__c</field>
            <operation>equals</operation>
            <value>False</value>
        </criteriaItems>
        <description>To Make the VOC editable when Report Flag is UnChecked</description>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>VOC Update Record Editable When Unlocked</fullName>
        <actions>
            <name>Unlock_Record</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Lock_Field_False</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Feedback__c.Locked__c</field>
            <operation>equals</operation>
            <value>False</value>
        </criteriaItems>
        <criteriaItems>
            <field>Feedback__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>VOC Read Only</value>
        </criteriaItems>
        <criteriaItems>
            <field>Feedback__c.Report_Flag__c</field>
            <operation>equals</operation>
            <value>False</value>
        </criteriaItems>
        <description>To Make the VOC Record Editable  when unlocked</description>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>VOC Update Record Read Only</fullName>
        <actions>
            <name>Update_Read_Only</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Feedback__c.Report_Flag__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <criteriaItems>
            <field>Feedback__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>VOC</value>
        </criteriaItems>
        <description>To Make the VOC Record Read Only when Report Flag is Checked</description>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>VOC Update Record Read Only after 45 days to the quarter</fullName>
        <active>true</active>
        <criteriaItems>
            <field>Feedback__c.Report_Flag__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <criteriaItems>
            <field>Feedback__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>VOC</value>
        </criteriaItems>
        <description>To Make the VOC Record Read Only 45 days to the quarter</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
        <workflowTimeTriggers>
            <actions>
                <name>Set_Lock_Field_True</name>
                <type>FieldUpdate</type>
            </actions>
            <actions>
                <name>Update_Record_Type_Read_Only</name>
                <type>FieldUpdate</type>
            </actions>
            <offsetFromField>Feedback__c.X45th_Day_from_Last_Quarter__c</offsetFromField>
            <timeLength>0</timeLength>
            <workflowTimeTriggerUnit>Days</workflowTimeTriggerUnit>
        </workflowTimeTriggers>
    </rules>
    <rules>
        <fullName>VOC_update overall Satisfaction</fullName>
        <actions>
            <name>Update_Overall_Satisfaction_val</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Feedback__c.CreatedDate</field>
            <operation>notEqual</operation>
        </criteriaItems>
        <description>To Update Overall satisfaction Values</description>
        <triggerType>onAllChanges</triggerType>
    </rules>
</Workflow>

<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Alert_7_days_prior_to_Expected_date</fullName>
        <description>Alert 7 days prior to Expected date</description>
        <protected>false</protected>
        <recipients>
            <field>CSPM__c</field>
            <type>userLookup</type>
        </recipients>
        <senderAddress>yourresponse@honeywell.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>unfiled$public/Alert_for_7_days_prior_to_Expected_date</template>
    </alerts>
    <alerts>
        <fullName>Notification_Email_to_the_planned_meeting_contact_plan_owner_after_3_days_of_the</fullName>
        <description>Notification Email to the planned meeting - contact plan owner after 3 days of the expected date</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderAddress>yourresponse@honeywell.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>unfiled$public/Notification_e_mail_to_the_pcontact_plan_owner_after_3_days_of_the_expected_date</template>
    </alerts>
    <alerts>
        <fullName>Notification_email_to_the_contact_plan_owner_1_week_in_advance_before_expected_d</fullName>
        <description>Notification e-mail to the contact plan owner 1 week in advance before expected date.</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderAddress>yourresponse@honeywell.com</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>unfiled$public/Notification_e_mail_to_the_contact_plan_owner_1_week_in_advance</template>
    </alerts>
    <alerts>
        <fullName>Planned_Meeting_Survey_email_to_Contact</fullName>
        <description>Planned Meeting  Survey email to Contact</description>
        <protected>false</protected>
        <recipients>
            <field>Contact_Name__c</field>
            <type>contactLookup</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>Voice_of_Customer/TCM_Survey_Email</template>
    </alerts>
    <alerts>
        <fullName>SendMail_Meetingstatus_Cancelled</fullName>
        <description>This is to send mail to the Planned Meeting Owner when the Planned Meeting Status changes to Cancelled</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>D_S_Email_Templates/Sendmail_CancelledPM</template>
    </alerts>
    <alerts>
        <fullName>This_is_to_send_mail_to_the_Planned_Meeting</fullName>
        <description>This is to send mail to the Planned Meeting Owner when the Planned Meeting Status changes to Scheduled</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>D_S_Email_Templates/SendMail_ScheduledPM</template>
    </alerts>
    <fieldUpdates>
        <fullName>Clear_Close_Date_Status_not_Done_or_Canc</fullName>
        <field>Date_Time_Closed__c</field>
        <name>Clear Close Date Status not Done or Canc</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Survey_link</fullName>
        <field>TCM_Survey_Link__c</field>
        <name>Survey link</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Campaign_Name</fullName>
        <description>Update Campaign Name</description>
        <field>Campaign_Name__c</field>
        <formula>Campaign__r.Name</formula>
        <name>Update Campaign Name</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Campaign_Number</fullName>
        <description>Update Campaign Number</description>
        <field>Campaign_Number__c</field>
        <formula>Campaign__r.Campaign_Number__c</formula>
        <name>Update Campaign Number</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Close_Date_for_Done_and_Cancelled</fullName>
        <field>Date_Time_Closed__c</field>
        <formula>Now()</formula>
        <name>Update Close Date for Done and Cancelled</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Is_Event_Attached</fullName>
        <field>Is_Event_Attached__c</field>
        <literalValue>1</literalValue>
        <name>Update Is Event Attached</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Is_Event_Attached_false</fullName>
        <field>Is_Event_Attached__c</field>
        <literalValue>0</literalValue>
        <name>Update Is Event Attached</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Name_field</fullName>
        <field>Name</field>
        <formula>LEFT(Case__r.Subject,80)</formula>
        <name>Update Name field</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Opportunity_Name</fullName>
        <description>Update Opportunity Name</description>
        <field>Opportunity_Name__c</field>
        <formula>Opportunity__r.Name</formula>
        <name>Update Opportunity Name</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Opportunity_Number</fullName>
        <description>Update Opportunity Number</description>
        <field>Opportunity_Number__c</field>
        <formula>Opportunity__r.Opportunity_Number__c</formula>
        <name>Update Opportunity Number</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <rules>
        <fullName>Clear Closed Date when Meeting Status is not Done or Cancelled</fullName>
        <actions>
            <name>Clear_Close_Date_Status_not_Done_or_Canc</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Planned_Meeting__c.Meeting_Status__c</field>
            <operation>notEqual</operation>
            <value>Cancelled</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.Meeting_Status__c</field>
            <operation>notEqual</operation>
            <value>Done</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>Contact Plan</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.Date_Time_Closed__c</field>
            <operation>notEqual</operation>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Clear Survey link</fullName>
        <actions>
            <name>Survey_link</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Planned_Meeting__c.TCM_Survey_Link__c</field>
            <operation>notEqual</operation>
        </criteriaItems>
        <triggerType>onCreateOnly</triggerType>
    </rules>
    <rules>
        <fullName>Email Reminder 7 days prior to Expected date</fullName>
        <active>true</active>
        <criteriaItems>
            <field>Planned_Meeting__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>HOS Customer Event</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.Expected_Date__c</field>
            <operation>notEqual</operation>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
        <workflowTimeTriggers>
            <actions>
                <name>Alert_7_days_prior_to_Expected_date</name>
                <type>Alert</type>
            </actions>
            <offsetFromField>Planned_Meeting__c.Expected_Date__c</offsetFromField>
            <timeLength>-7</timeLength>
            <workflowTimeTriggerUnit>Days</workflowTimeTriggerUnit>
        </workflowTimeTriggers>
    </rules>
    <rules>
        <fullName>Event Attached to Planned Meeting</fullName>
        <actions>
            <name>Update_Is_Event_Attached</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>Event__c != null</formula>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Event Attached to Planned Meeting%2E</fullName>
        <actions>
            <name>Update_Is_Event_Attached_false</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>Event__c == null</formula>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Planned meeting - Contact Plan schedule for Close - 3 day notification</fullName>
        <active>true</active>
        <criteriaItems>
            <field>Planned_Meeting__c.Meeting_Status__c</field>
            <operation>equals</operation>
            <value>Open</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.Expected_Date__c</field>
            <operation>notEqual</operation>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>Contact Plan</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
        <workflowTimeTriggers>
            <actions>
                <name>Notification_Email_to_the_planned_meeting_contact_plan_owner_after_3_days_of_the</name>
                <type>Alert</type>
            </actions>
            <offsetFromField>Planned_Meeting__c.Expected_Date__c</offsetFromField>
            <timeLength>3</timeLength>
            <workflowTimeTriggerUnit>Days</workflowTimeTriggerUnit>
        </workflowTimeTriggers>
    </rules>
    <rules>
        <fullName>Planned meeting - Contact Plan shedule for New</fullName>
        <active>true</active>
        <criteriaItems>
            <field>Planned_Meeting__c.Meeting_Status__c</field>
            <operation>equals</operation>
            <value>Open</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.Expected_Date__c</field>
            <operation>notEqual</operation>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>Contact Plan</value>
        </criteriaItems>
        <description>Workflow to send email notification to Contact Owner 1 Week on Expected Date</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
        <workflowTimeTriggers>
            <actions>
                <name>Notification_email_to_the_contact_plan_owner_1_week_in_advance_before_expected_d</name>
                <type>Alert</type>
            </actions>
            <offsetFromField>Planned_Meeting__c.Expected_Date__c</offsetFromField>
            <timeLength>-7</timeLength>
            <workflowTimeTriggerUnit>Days</workflowTimeTriggerUnit>
        </workflowTimeTriggers>
    </rules>
    <rules>
        <fullName>SendMail_PMStatus_Cancelled</fullName>
        <actions>
            <name>SendMail_Meetingstatus_Cancelled</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Planned_Meeting__c.Meeting_Status__c</field>
            <operation>equals</operation>
            <value>Cancelled</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.Send_Email_Notification__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>SendMail_PMStatus_Scheduled</fullName>
        <actions>
            <name>This_is_to_send_mail_to_the_Planned_Meeting</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Planned_Meeting__c.Meeting_Status__c</field>
            <operation>equals</operation>
            <value>Scheduled</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.Send_Email_Notification__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>TCM Survey Email</fullName>
        <actions>
            <name>Planned_Meeting_Survey_email_to_Contact</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <description>Tech Connect Survey Email Requirement</description>
        <formula>ischanged(TCM_Survey_Link__c) &amp;&amp;  TCM_Survey_Link__c != null &amp;&amp; RecordType.Name == &apos;Contact Plan&apos;</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Update Campaign Fields on Planned Meeting</fullName>
        <actions>
            <name>Update_Campaign_Name</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Campaign_Number</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Update Campaign Fields on Planned Meeting</description>
        <formula>Campaign__c != null</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Update Closed Date when Planned Meeting Status is Done</fullName>
        <actions>
            <name>Update_Close_Date_for_Done_and_Cancelled</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <booleanFilter>(1 OR 2) AND 3</booleanFilter>
        <criteriaItems>
            <field>Planned_Meeting__c.Meeting_Status__c</field>
            <operation>equals</operation>
            <value>Done</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.Meeting_Status__c</field>
            <operation>equals</operation>
            <value>Cancelled</value>
        </criteriaItems>
        <criteriaItems>
            <field>Planned_Meeting__c.RecordTypeId</field>
            <operation>equals</operation>
            <value>Contact Plan</value>
        </criteriaItems>
        <description>Update Closed Date when Status is Done or Cancelled</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Update Name field for Deployment Planned Meetings</fullName>
        <actions>
            <name>Update_Name_field</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <formula>RecordType.Name  = &apos;Deployment&apos;  &amp;&amp;    TEXT(Status__c ) = &apos;Deployed&apos; &amp;&amp;  Case__r.Subject != &apos;&apos;</formula>
        <triggerType>onCreateOnly</triggerType>
    </rules>
    <rules>
        <fullName>Update Opportunity Fields on Planned Meeting</fullName>
        <actions>
            <name>Update_Opportunity_Name</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Opportunity_Number</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Update Opportunity num, Opportunity name fields on Planned meeting</description>
        <formula>Opportunity__c != null</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
</Workflow>
